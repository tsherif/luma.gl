{"version":3,"sources":["webpack:///../examples/api/cubemap/app.js","webpack:///./templates/api/example-cubemap.jsx","webpack:///./node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js","webpack:///../modules/engine/src/geometry/geometry.js","webpack:///../modules/engine/src/geometries/cube-geometry.js","webpack:///../node_modules/@loaders.gl/images/dist/esm/utils/globals.js","webpack:///../node_modules/@loaders.gl/images/dist/esm/lib/image-parsers.js","webpack:///../node_modules/@loaders.gl/images/dist/esm/lib/get-image-metadata.js","webpack:///../node_modules/@loaders.gl/images/dist/esm/lib/parse-image.js"],"names":["RoomCube","Object","geometry","fs","vs","Model","Prism","AppAnimationLoop","getInfo","onInitialize","gl","canvas","setParameters","clearColor","clearDepth","depthTest","depthFunc","GL","LEQUAL","cubemap","data","loadImage","texture","mipmaps","parameters","cube","uniforms","uTextureCube","uModel","prism","uTexture","onRender","animationProps","aspect","tick","eyePosition","view","eye","projection","fov","radians","uView","uProjection","uEyePosition","AnimationLoop","window","animationLoop","Example","render","exampleConfig","this","props","pageContext","React","Component","asyncGeneratorStep","gen","resolve","reject","_next","_throw","key","arg","info","value","error","done","Promise","then","_asyncToGenerator","fn","self","args","arguments","apply","err","undefined","DRAW_MODE","POINTS","LINES","LINE_LOOP","LINE_STRIP","TRIANGLES","TRIANGLE_STRIP","TRIANGLE_FAN","Geometry","id","uid","drawMode","attributes","indices","vertexCount","userData","_setAttributes","_calculateVertexCount","getVertexCount","getAttributes","_print","ArrayBuffer","size","attribute","assert","attributeName","isIndexed","Math","Number","CUBE_INDICES","Uint16Array","CUBE_POSITIONS","Float32Array","CUBE_NORMALS","CUBE_TEX_COORDS","ATTRIBUTES","POSITION","NORMAL","TEXCOORD_0","CubeGeometry","globals","process","String","browser","global","global_","BIG_ENDIAN","LITTLE_ENDIAN","mimeTypeMap","Map","test","dataView","byteLength","getUint32","getSize","width","height","getUint16","getUint8","_getJpegMarkers","tableMarkers","Set","i","add","sofMarkers","getJpegMarkers","marker","has","ERR_INVALID_MIME_TYPE","concat","Array","from","keys","join","getImageMIMEType","arrayBuffer","toDataView","_iteratorNormalCompletion","_didIteratorError","_iteratorError","_step","_iterator","entries","Symbol","iterator","next","_step$value","mimeType","getImageMetadata","length","metadata","getImageTypeHandlers","Error","getImageSize","handlers","get","isView","DataView","buffer","_parseImageNode","parseImage","options","createImageBitmap","blob","Blob","Uint8Array","parseToImageBitmap","_x","_loadImage","mark","_callee","url","response","_args","wrap","_context","prev","Image","fetch","sent","abrupt","loadToHTMLImage","stop","_x2","_x3","_loadToHTMLImage","_callee2","src","xml","_context2","text","btoa","image","onload","onerror","crossOrigin"],"mappings":"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","file":"component---templates-api-example-cubemap-jsx-90eef1ab8718e7df231e.js","sourcesContent":["import GL from '@luma.gl/constants';\nimport {AnimationLoop, Model, CubeGeometry} from '@luma.gl/engine';\nimport {Texture2D, TextureCube} from '@luma.gl/webgl';\nimport {setParameters} from '@luma.gl/gltools';\nimport {Matrix4, radians} from 'math.gl';\nimport {loadImage} from '@loaders.gl/images';\n\nconst INFO_HTML = `\n<p>\nUses a luma.gl <code>TextureCube</code> to simulate a reflective\nsurface\n</p>\n`;\n\nclass RoomCube extends Model {\n  constructor(gl, props) {\n    const vs = `\\\nattribute vec3 positions;\n\nuniform mat4 uModel;\nuniform mat4 uView;\nuniform mat4 uProjection;\n\nvarying vec3 vPosition;\n\nvoid main(void) {\n  gl_Position = uProjection * uView * uModel * vec4(positions, 1.0);\n  vPosition = positions;\n}\n`;\n    const fs = `\\\nprecision highp float;\n\nuniform samplerCube uTextureCube;\nvarying vec3 vPosition;\n\nvoid main(void) {\n  // The outer cube just samples the texture cube directly\n  gl_FragColor = textureCube(uTextureCube, normalize(vPosition));\n}\n`;\n\n    super(gl, Object.assign({geometry: new CubeGeometry()}, props, {fs, vs}));\n  }\n}\n\nclass Prism extends Model {\n  constructor(gl, props) {\n    const vs = `\\\nattribute vec3 positions;\nattribute vec3 normals;\nattribute vec2 texCoords;\n\nuniform mat4 uModel;\nuniform mat4 uView;\nuniform mat4 uProjection;\n\nvarying vec3 vPosition;\nvarying vec3 vNormal;\nvarying vec2 vUV;\n\nvoid main(void) {\n  gl_Position = uProjection * uView * uModel * vec4(positions, 1.0);\n  vPosition = vec3(uModel * vec4(positions,1));\n  vNormal = vec3(uModel * vec4(normals, 0));\n  vUV = texCoords;\n}\n`;\n    const fs = `\\\nprecision highp float;\n\nuniform sampler2D uTexture;\nuniform samplerCube uTextureCube;\nuniform vec3 uEyePosition;\n\nvarying vec3 vPosition;\nvarying vec3 vNormal;\nvarying vec2 vUV;\n\nvoid main(void) {\n  vec4 color = texture2D(uTexture, vUV);\n  vec3 reflectedDir = reflect(normalize(vPosition - uEyePosition), vNormal);\n  vec4 reflectedColor = textureCube(uTextureCube, reflectedDir);\n\n  gl_FragColor = color * reflectedColor;\n}\n`;\n    super(gl, Object.assign({geometry: new CubeGeometry()}, props, {vs, fs}));\n  }\n}\n\nexport default class AppAnimationLoop extends AnimationLoop {\n  static getInfo() {\n    return INFO_HTML;\n  }\n\n  onInitialize({gl, canvas}) {\n    setParameters(gl, {\n      clearColor: [0, 0, 0, 1],\n      clearDepth: 1,\n      depthTest: true,\n      depthFunc: GL.LEQUAL\n    });\n\n    const cubemap = new TextureCube(gl, {\n      data: {\n        [gl.TEXTURE_CUBE_MAP_POSITIVE_X]: loadImage('sky-posx.png'),\n        [gl.TEXTURE_CUBE_MAP_NEGATIVE_X]: loadImage('sky-negx.png'),\n        [gl.TEXTURE_CUBE_MAP_POSITIVE_Y]: loadImage('sky-posy.png'),\n        [gl.TEXTURE_CUBE_MAP_NEGATIVE_Y]: loadImage('sky-negy.png'),\n        [gl.TEXTURE_CUBE_MAP_POSITIVE_Z]: loadImage('sky-posz.png'),\n        [gl.TEXTURE_CUBE_MAP_NEGATIVE_Z]: loadImage('sky-negz.png')\n      }\n    });\n\n    const texture = new Texture2D(gl, {\n      data: 'vis-logo.png',\n      mipmaps: true,\n      parameters: {\n        [gl.TEXTURE_MAG_FILTER]: gl.LINEAR,\n        [gl.TEXTURE_MIN_FILTER]: gl.LINEAR_MIPMAP_NEAREST\n      }\n    });\n\n    return {\n      cube: new RoomCube(gl, {\n        uniforms: {\n          uTextureCube: cubemap,\n          uModel: new Matrix4().scale([20, 20, 20])\n        }\n      }),\n      prism: new Prism(gl, {\n        uniforms: {\n          uTextureCube: cubemap,\n          uTexture: texture\n        }\n      })\n    };\n  }\n\n  onRender(animationProps) {\n    const {gl, aspect, cube, prism, tick} = animationProps;\n\n    const eyePosition = [5, -3, 5];\n    const view = new Matrix4().lookAt({eye: eyePosition});\n    const projection = new Matrix4().perspective({fov: radians(75), aspect});\n\n    gl.clear(GL.COLOR_BUFFER_BIT | GL.DEPTH_BUFFER_BIT);\n\n    cube.draw({\n      uniforms: {\n        uView: view,\n        uProjection: projection\n      }\n    });\n\n    prism.draw({\n      uniforms: {\n        uEyePosition: eyePosition,\n        uView: view,\n        uProjection: projection,\n        uModel: new Matrix4().rotateX(tick * 0.01).rotateY(tick * 0.013)\n      }\n    });\n  }\n}\n\n/* global window */\nif (typeof window !== 'undefined' && !window.website) {\n  const animationLoop = new AppAnimationLoop();\n  animationLoop.start();\n}\n","import React from 'react';\nimport AnimationLoopExamplePage from '../../src/components/animation-loop-example-page';\nimport AnimationLoop from '../../../examples/api/cubemap/app';\n\nexport default class Example extends React.Component {\n  render() {\n    return (\n      <AnimationLoopExamplePage AnimationLoop={AnimationLoop} exampleConfig={this.props.pageContext.exampleConfig} />\n    );\n  }\n}\n","function asyncGeneratorStep(gen, resolve, reject, _next, _throw, key, arg) {\n  try {\n    var info = gen[key](arg);\n    var value = info.value;\n  } catch (error) {\n    reject(error);\n    return;\n  }\n\n  if (info.done) {\n    resolve(value);\n  } else {\n    Promise.resolve(value).then(_next, _throw);\n  }\n}\n\nexport default function _asyncToGenerator(fn) {\n  return function () {\n    var self = this,\n        args = arguments;\n    return new Promise(function (resolve, reject) {\n      var gen = fn.apply(self, args);\n\n      function _next(value) {\n        asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"next\", value);\n      }\n\n      function _throw(err) {\n        asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"throw\", err);\n      }\n\n      _next(undefined);\n    });\n  };\n}","import {uid, assert} from '@luma.gl/webgl';\n\n// Rendering primitives - specify how to extract primitives from vertices.\n// NOTE: These are numerically identical to the corresponding WebGL/OpenGL constants\nexport const DRAW_MODE = {\n  POINTS: 0x0000, // draw single points.\n  LINES: 0x0001, // draw lines. Each vertex connects to the one after it.\n  LINE_LOOP: 0x0002, // draw lines. Each set of two vertices is treated as a separate line segment.\n  LINE_STRIP: 0x0003, // draw a connected group of line segments from the first vertex to the last\n  TRIANGLES: 0x0004, // draw triangles. Each set of three vertices creates a separate triangle.\n  TRIANGLE_STRIP: 0x0005, // draw a connected group of triangles.\n  TRIANGLE_FAN: 0x0006 // draw a connected group of triangles.\n  // Each vertex connects to the previous and the first vertex in the fan.\n};\n\nexport default class Geometry {\n  static get DRAW_MODE() {\n    return DRAW_MODE;\n  }\n\n  constructor(props = {}) {\n    const {\n      id = uid('geometry'),\n      drawMode = DRAW_MODE.TRIANGLES,\n      attributes = {},\n      indices = null,\n      vertexCount = null\n    } = props;\n\n    this.id = id;\n    this.drawMode = drawMode | 0;\n    this.attributes = {};\n    this.userData = {};\n\n    this._setAttributes(attributes, indices);\n\n    this.vertexCount = vertexCount || this._calculateVertexCount(this.attributes, this.indices);\n\n    // stubRemovedMethods(this, [\n    //   'setNeedsRedraw', 'needsRedraw', 'setAttributes'\n    // ], 'Immutable');\n\n    // stubRemovedMethods(this, [\n    //   'hasAttribute', 'getAttribute', 'getArray'\n    // ], 'Use geometry.attributes and geometry.indices');\n\n    // deprecateMethods(this, ['getAttributes'])\n  }\n\n  get mode() {\n    return this.drawMode;\n  }\n\n  getVertexCount() {\n    return this.vertexCount;\n  }\n\n  // Return an object with all attributes plus indices added as a field.\n  getAttributes() {\n    return this.indices ? {indices: this.indices, ...this.attributes} : this.attributes;\n  }\n\n  // PRIVATE\n\n  _print(attributeName) {\n    return `Geometry ${this.id} attribute ${attributeName}`;\n  }\n\n  // Attribute\n  // value: typed array\n  // type: indices, vertices, uvs\n  // size: elements per vertex\n  // target: WebGL buffer type (string or constant)\n  _setAttributes(attributes, indices) {\n    if (indices) {\n      this.indices = ArrayBuffer.isView(indices) ? {value: indices, size: 1} : indices;\n    }\n\n    for (const attributeName in attributes) {\n      let attribute = attributes[attributeName];\n\n      // Wrap \"unwrapped\" arrays and try to autodetect their type\n      attribute = ArrayBuffer.isView(attribute) ? {value: attribute} : attribute;\n\n      assert(\n        ArrayBuffer.isView(attribute.value),\n        `${this._print(attributeName)}: must be typed array or object with value as typed array`\n      );\n\n      if ((attributeName === 'POSITION' || attributeName === 'positions') && !attribute.size) {\n        attribute.size = 3;\n      }\n\n      // Move indices to separate field\n      if (attributeName === 'indices') {\n        assert(!this.indices);\n        this.indices = attribute;\n      } else {\n        this.attributes[attributeName] = attribute;\n      }\n    }\n\n    if (this.indices && this.indices.isIndexed !== undefined) {\n      this.indices = Object.assign({}, this.indices);\n      delete this.indices.isIndexed;\n    }\n\n    return this;\n  }\n\n  _calculateVertexCount(attributes, indices) {\n    if (indices) {\n      return indices.value.length;\n    }\n    let vertexCount = Infinity;\n    for (const attributeName in attributes) {\n      const attribute = attributes[attributeName];\n      const {value, size, constant} = attribute;\n      if (!constant && value && size >= 1) {\n        vertexCount = Math.min(vertexCount, value.length / size);\n      }\n    }\n\n    assert(Number.isFinite(vertexCount));\n    return vertexCount;\n  }\n}\n","import Geometry from '../geometry/geometry';\nimport {uid} from '@luma.gl/webgl';\n\n// prettier-ignore\nconst CUBE_INDICES = new Uint16Array([\n  0, 1, 2, 0, 2, 3, 4, 5, 6, 4, 6, 7, 8, 9, 10, 8, 10, 11, 12, 13,\n  14, 12, 14, 15, 16, 17, 18, 16, 18, 19, 20, 21, 22, 20, 22, 23\n]);\n\n// prettier-ignore\nconst CUBE_POSITIONS = new Float32Array([\n  -1,  -1,  1, 1,  -1,  1,  1,  1,  1,  -1,  1,  1,\n  -1,  -1,  -1,  -1,  1,  -1,  1,  1,  -1,  1,  -1,  -1,\n  -1,  1,  -1,  -1,  1,  1,  1,  1,  1,  1,  1,  -1,\n  -1,  -1,  -1,  1,  -1,  -1,  1,  -1,  1,  -1,  -1,  1,\n  1,  -1,  -1,  1,  1,  -1,  1,  1,  1,  1,  -1,  1,\n  -1,  -1,  -1,  -1,  -1,  1,  -1,  1,  1,  -1,  1,  -1\n]);\n\n// TODO - could be Uint8\n// prettier-ignore\nconst CUBE_NORMALS = new Float32Array([\n  // Front face\n  0,  0,  1,  0,  0,  1,  0,  0,  1,  0,  0,  1,\n  // Back face\n  0,  0,  -1,  0,  0,  -1,  0,  0,  -1,  0,  0,  -1,\n  // Top face\n  0,  1,  0,  0,  1,  0,  0,  1,  0,  0,  1,  0,\n  // Bottom face\n  0,  -1,  0,  0,  -1,  0,  0,  -1,  0,  0,  -1,  0,\n  // Right face\n  1,  0,  0,  1,  0,  0,  1,  0,  0,  1,  0,  0,\n  // Left face\n  -1,  0,  0,  -1,  0,  0,  -1,  0,  0,  -1,  0,  0\n]);\n\n// prettier-ignore\nconst CUBE_TEX_COORDS = new Float32Array([\n  // Front face\n  0,  0,  1,  0,  1,  1,  0,  1,\n  // Back face\n  1,  0,  1,  1,  0,  1,  0,  0,\n  // Top face\n  0,  1,  0,  0,  1,  0,  1,  1,\n  // Bottom face\n  1,  1,  0,  1,  0,  0,  1,  0,\n  // Right face\n  1,  0,  1,  1,  0,  1,  0,  0,\n  // Left face\n  0,  0,  1,  0,  1,  1,  0,  1\n]);\n\nconst ATTRIBUTES = {\n  POSITION: {size: 3, value: new Float32Array(CUBE_POSITIONS)},\n  NORMAL: {size: 3, value: new Float32Array(CUBE_NORMALS)},\n  TEXCOORD_0: {size: 2, value: new Float32Array(CUBE_TEX_COORDS)}\n};\n\nexport default class CubeGeometry extends Geometry {\n  constructor(props = {}) {\n    const {id = uid('cube-geometry')} = props;\n    super({\n      ...props,\n      id,\n      indices: {size: 1, value: new Uint16Array(CUBE_INDICES)},\n      attributes: {...ATTRIBUTES, ...props.attributes}\n    });\n  }\n}\n","import _typeof from \"@babel/runtime/helpers/esm/typeof\";\nvar isBrowser = (typeof process === \"undefined\" ? \"undefined\" : _typeof(process)) !== 'object' || String(process) !== '[object process]' || process.browser;\nvar globals = {\n  self: typeof self !== 'undefined' && self,\n  window: typeof window !== 'undefined' && window,\n  global: typeof global !== 'undefined' && global\n};\nvar global_ = globals.global || globals.self || globals.window;\nexport { isBrowser, global_ as global };","import \"core-js/modules/es6.set\";\nimport \"core-js/modules/web.dom.iterable\";\nimport \"core-js/modules/es6.array.iterator\";\nimport \"core-js/modules/es6.object.to-string\";\nimport \"core-js/modules/es6.string.iterator\";\nimport \"core-js/modules/es6.map\";\nvar BIG_ENDIAN = false;\nvar LITTLE_ENDIAN = true;\nexport var mimeTypeMap = new Map([['image/png', {\n  test: isPng,\n  getSize: getPngSize\n}], ['image/jpeg', {\n  test: isJpeg,\n  getSize: getJpegSize\n}], ['image/gif', {\n  test: isGif,\n  getSize: getGifSize\n}], ['image/bmp', {\n  test: isBmp,\n  getSize: getBmpSize\n}]]);\n\nfunction isPng(dataView) {\n  return dataView.byteLength >= 24 && dataView.getUint32(0, BIG_ENDIAN) === 0x89504e47;\n}\n\nfunction getPngSize(dataView) {\n  return {\n    width: dataView.getUint32(16, BIG_ENDIAN),\n    height: dataView.getUint32(20, BIG_ENDIAN)\n  };\n}\n\nfunction isGif(dataView) {\n  return dataView.byteLength >= 10 && dataView.getUint32(0, BIG_ENDIAN) === 0x47494638;\n}\n\nfunction getGifSize(dataView) {\n  return {\n    width: dataView.getUint16(6, LITTLE_ENDIAN),\n    height: dataView.getUint16(8, LITTLE_ENDIAN)\n  };\n}\n\nfunction isBmp(dataView) {\n  return dataView.byteLength >= 2 && dataView.getUint16(0, BIG_ENDIAN) === 0x424d;\n}\n\nfunction getBmpSize(dataView) {\n  return {\n    width: dataView.getUint32(18, LITTLE_ENDIAN),\n    height: dataView.getUint32(22, LITTLE_ENDIAN)\n  };\n}\n\nfunction isJpeg(dataView) {\n  return dataView.byteLength >= 3 && dataView.getUint16(0, BIG_ENDIAN) === 0xffd8 && dataView.getUint8(2, BIG_ENDIAN) === 0xff;\n}\n\nfunction getJpegSize(dataView) {\n  if (dataView.byteLength < 2 || dataView.getUint16(0, BIG_ENDIAN) !== 0xffd8) {\n    return null;\n  }\n\n  var _getJpegMarkers = getJpegMarkers(),\n      tableMarkers = _getJpegMarkers.tableMarkers,\n      sofMarkers = _getJpegMarkers.sofMarkers;\n\n  var i = 2;\n\n  while (i < dataView.byteLength) {\n    var marker = dataView.getUint16(i, BIG_ENDIAN);\n\n    if (sofMarkers.has(marker)) {\n      return {\n        height: dataView.getUint16(i + 5, BIG_ENDIAN),\n        width: dataView.getUint16(i + 7, BIG_ENDIAN)\n      };\n    }\n\n    if (!tableMarkers.has(marker)) {\n      return null;\n    }\n\n    i += 2;\n    i += dataView.getUint16(i, BIG_ENDIAN);\n  }\n\n  return null;\n}\n\nfunction getJpegMarkers() {\n  var tableMarkers = new Set([0xffdb, 0xffc4, 0xffcc, 0xffdd, 0xfffe]);\n\n  for (var i = 0xffe0; i < 0xfff0; ++i) {\n    tableMarkers.add(i);\n  }\n\n  var sofMarkers = new Set([0xffc0, 0xffc1, 0xffc2, 0xffc3, 0xffc5, 0xffc6, 0xffc7, 0xffc9, 0xffca, 0xffcb, 0xffcd, 0xffce, 0xffcf, 0xffde]);\n  return {\n    tableMarkers: tableMarkers,\n    sofMarkers: sofMarkers\n  };\n}","import \"core-js/modules/es6.typed.data-view\";\nimport \"core-js/modules/es7.symbol.async-iterator\";\nimport \"core-js/modules/es6.symbol\";\nimport \"core-js/modules/web.dom.iterable\";\nimport \"core-js/modules/es6.array.iterator\";\nimport \"core-js/modules/es6.object.to-string\";\nimport \"core-js/modules/es6.string.iterator\";\nimport \"core-js/modules/es6.array.from\";\nimport _slicedToArray from \"@babel/runtime/helpers/esm/slicedToArray\";\nimport { mimeTypeMap } from './image-parsers';\nvar ERR_INVALID_MIME_TYPE = \"Invalid MIME type. Supported MIME types are: \".concat(Array.from(mimeTypeMap.keys()).join(', '));\nexport function isImage(arrayBuffer, mimeType) {\n  if (mimeType) {\n    var _getImageTypeHandlers = getImageTypeHandlers(mimeType),\n        test = _getImageTypeHandlers.test;\n\n    var dataView = toDataView(arrayBuffer);\n    return test(dataView);\n  }\n\n  return Boolean(getImageMIMEType(arrayBuffer));\n}\nexport function getImageMIMEType(arrayBuffer) {\n  var dataView = toDataView(arrayBuffer);\n  var _iteratorNormalCompletion = true;\n  var _didIteratorError = false;\n  var _iteratorError = undefined;\n\n  try {\n    for (var _iterator = mimeTypeMap.entries()[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {\n      var _step$value = _slicedToArray(_step.value, 2),\n          mimeType = _step$value[0],\n          test = _step$value[1].test;\n\n      if (test(dataView)) {\n        return mimeType;\n      }\n    }\n  } catch (err) {\n    _didIteratorError = true;\n    _iteratorError = err;\n  } finally {\n    try {\n      if (!_iteratorNormalCompletion && _iterator[\"return\"] != null) {\n        _iterator[\"return\"]();\n      }\n    } finally {\n      if (_didIteratorError) {\n        throw _iteratorError;\n      }\n    }\n  }\n\n  return null;\n}\nexport function getImageSize(arrayBuffer) {\n  var mimeType = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : null;\n  mimeType = mimeType || getImageMIMEType(arrayBuffer);\n\n  var _getImageTypeHandlers2 = getImageTypeHandlers(mimeType),\n      getSize = _getImageTypeHandlers2.getSize;\n\n  var dataView = toDataView(arrayBuffer);\n  var size = getSize(dataView);\n\n  if (!size) {\n    throw new Error(\"invalid image data for type: \".concat(mimeType));\n  }\n\n  return size;\n}\nexport function getImageMetadata(arrayBuffer) {\n  var mimeType = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : null;\n  mimeType = mimeType || getImageMIMEType(arrayBuffer);\n  var metadata = getImageSize(arrayBuffer, mimeType);\n  metadata.mimeType = mimeType;\n  return metadata;\n}\n\nfunction getImageTypeHandlers(mimeType) {\n  var handlers = mimeTypeMap.get(mimeType);\n\n  if (!handlers) {\n    throw new Error(ERR_INVALID_MIME_TYPE);\n  }\n\n  return handlers;\n}\n\nfunction toDataView(data) {\n  if (data instanceof ArrayBuffer || ArrayBuffer.isView(data)) {\n    return new DataView(data.buffer || data);\n  }\n\n  throw new Error('toDataView');\n}","import \"core-js/modules/es6.promise\";\nimport \"core-js/modules/es6.object.to-string\";\nimport \"core-js/modules/es6.typed.uint8-array\";\nimport _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/esm/asyncToGenerator\";\nimport { global } from '../utils/globals';\nimport { getImageMetadata } from './get-image-metadata';\nexport var canParseImage = global._parseImageNode || typeof ImageBitmap !== 'undefined';\nexport function parseImage(arrayBuffer, options) {\n  if (global._parseImageNode) {\n    var _getImageMetadata = getImageMetadata(arrayBuffer),\n        mimeType = _getImageMetadata.mimeType;\n\n    return global._parseImageNode(arrayBuffer, mimeType, options);\n  }\n\n  return parseToImageBitmap(arrayBuffer, options);\n}\nexport function loadImage(_x) {\n  return _loadImage.apply(this, arguments);\n}\n\nfunction _loadImage() {\n  _loadImage = _asyncToGenerator(_regeneratorRuntime.mark(function _callee(url) {\n    var options,\n        response,\n        arrayBuffer,\n        _args = arguments;\n    return _regeneratorRuntime.wrap(function _callee$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            options = _args.length > 1 && _args[1] !== undefined ? _args[1] : {};\n\n            if (!(typeof Image === 'undefined')) {\n              _context.next = 9;\n              break;\n            }\n\n            _context.next = 4;\n            return fetch(url, options);\n\n          case 4:\n            response = _context.sent;\n            _context.next = 7;\n            return response.arrayBuffer();\n\n          case 7:\n            arrayBuffer = _context.sent;\n            return _context.abrupt(\"return\", parseImage(arrayBuffer, options));\n\n          case 9:\n            _context.next = 11;\n            return loadToHTMLImage(url, options);\n\n          case 11:\n            return _context.abrupt(\"return\", _context.sent);\n\n          case 12:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, _callee);\n  }));\n  return _loadImage.apply(this, arguments);\n}\n\nexport function parseToImageBitmap(arrayBuffer, options) {\n  if (typeof createImageBitmap === 'undefined') {\n    throw new Error('parseImage');\n  }\n\n  var blob = new Blob([new Uint8Array(arrayBuffer)]);\n  return createImageBitmap(blob);\n}\nexport function loadToHTMLImage(_x2, _x3) {\n  return _loadToHTMLImage.apply(this, arguments);\n}\n\nfunction _loadToHTMLImage() {\n  _loadToHTMLImage = _asyncToGenerator(_regeneratorRuntime.mark(function _callee2(url, options) {\n    var src, response, xml;\n    return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n      while (1) {\n        switch (_context2.prev = _context2.next) {\n          case 0:\n            if (!/\\.svg((\\?|#).*)?$/.test(url)) {\n              _context2.next = 10;\n              break;\n            }\n\n            _context2.next = 3;\n            return fetch(url, options);\n\n          case 3:\n            response = _context2.sent;\n            _context2.next = 6;\n            return response.text();\n\n          case 6:\n            xml = _context2.sent;\n            src = \"data:image/svg+xml;base64,\".concat(btoa(xml));\n            _context2.next = 13;\n            break;\n\n          case 10:\n            _context2.next = 12;\n            return url;\n\n          case 12:\n            src = _context2.sent;\n\n          case 13:\n            _context2.next = 15;\n            return new Promise(function (resolve, reject) {\n              try {\n                var image = new Image();\n\n                image.onload = function () {\n                  return resolve(image);\n                };\n\n                image.onerror = function (err) {\n                  return reject(new Error(\"Could not load image \".concat(url, \": \").concat(err)));\n                };\n\n                image.crossOrigin = options && options.crossOrigin || 'anonymous';\n                image.src = src;\n              } catch (error) {\n                reject(error);\n              }\n            });\n\n          case 15:\n            return _context2.abrupt(\"return\", _context2.sent);\n\n          case 16:\n          case \"end\":\n            return _context2.stop();\n        }\n      }\n    }, _callee2);\n  }));\n  return _loadToHTMLImage.apply(this, arguments);\n}"],"sourceRoot":""}