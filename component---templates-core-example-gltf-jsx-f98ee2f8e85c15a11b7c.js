(window.webpackJsonp=window.webpackJsonp||[]).push([[13,3],{289:function(e,t,n){"use strict";n.r(t);var i=n(0),r=n.n(i),a=n(335),o=(n(56),n(78),n(20),n(28),n(3),n(39),n(4),n(333)),s=n.n(o),u=(n(380),n(390)),l=n(589),f=(n(572),n(318)),c=n.n(f),d=n(385),h=n(448),p=n(446),m=n(435),g=n(570),v=(n(5),n(6),n(140),n(429)),_=n(583),b=(n(9),n(586)),E=(n(32),n(10),n(8),n(343));function A(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var y=function(e){var t,n;function i(t){var n;void 0===t&&(t={});var i=(t=Array.isArray(t)?{children:t}:t).children,r=void 0===i?[]:i;return d.a.assert(r.every(function(e){return e instanceof E.a}),"every child must an instance of ScenegraphNode"),(n=e.call(this,t)||this).children=r,n}n=e,(t=i).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n;var r=i.prototype;return r.add=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];for(var i=0,r=t;i<r.length;i++){var a=r[i];Array.isArray(a)?this.add.apply(this,A(a)):this.children.push(a)}return this},r.remove=function(e){var t=this.children,n=t.indexOf(e);return n>-1&&t.splice(n,1),this},r.removeAll=function(){return this.children=[],this},r.delete=function(){this.children.forEach(function(e){return e.delete()}),this.removeAll(),e.prototype.delete.call(this)},r.traverse=function(e,t){var n=(void 0===t?{}:t).worldMatrix,r=void 0===n?new b.a:n,a=new b.a(r).multiplyRight(this.matrix),o=this.children,s=Array.isArray(o),u=0;for(o=s?o:o[Symbol.iterator]();;){var l;if(s){if(u>=o.length)break;l=o[u++]}else{if((u=o.next()).done)break;l=u.value}var f=l;f instanceof i?f.traverse(e,{worldMatrix:a}):e(f,{worldMatrix:a})}},r.traverseReverse=function(e,t){return d.a.warn("traverseReverse is not reverse")(),this.traverse(e,t)},i}(E.a),S=n(347),L=n(387),T=(n(189),n(317),n(330),n(321),n(367),n(329),n(368),n(587)),M={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},O={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array};function R(e){if(!e._animation){var t=O[e.componentType],n=M[e.type],i=n*e.count,r=e.bufferView.data,a=new t(r.buffer,r.byteOffset+(e.byteOffset||0),i);if(1===n)e._animation=Array.from(a);else{for(var o=[],s=0;s<a.length;s+=n)o.push(Array.from(a.slice(s,s+n)));e._animation=o}}return e._animation}var I=new b.a;var x=new T.a;function C(e,t,n,i){var r=t.input,a=t.interpolation,o=t.output,s=e%r[r.length-1],u=r.findIndex(function(e){return e>=s}),l=Math.max(0,u-1);if(!Array.isArray(n[i]))switch(i){case"translation":n[i]=[0,0,0];break;case"rotation":n[i]=[0,0,0,1];break;case"scale":n[i]=[1,1,1];break;default:d.a.warn("Bad animation path "+i)()}Object(v.a)(n[i].length===o[l].length);var f=r[l],c=r[u];switch(a){case"STEP":!function(e,t,n){for(var i=0;i<n.length;i++)e[t][i]=n[i]}(n,i,o[l]);break;case"LINEAR":if(c>f){var h=(s-f)/(c-f);!function(e,t,n,i,r){if("rotation"===t){x.slerp({start:n,target:i,ratio:r});for(var a=0;a<x.length;a++)e[t][a]=x[a]}else for(var o=0;o<n.length;o++)e[t][o]=r*i[o]+(1-r)*n[o]}(n,i,o[l],o[u],h)}break;case"CUBICSPLINE":if(c>f){var p=(s-f)/(c-f),m=c-f;!function(e,t,n){for(var i=n.p0,r=n.outTangent0,a=n.inTangent1,o=n.p1,s=n.tDiff,u=n.ratio,l=0;l<e[t].length;l++){var f=r[l]*s,c=a[l]*s;e[t][l]=(2*Math.pow(u,3)-3*Math.pow(u,2)+1)*i[l]+(Math.pow(u,3)-2*Math.pow(u,2)+u)*f+(-2*Math.pow(u,3)+3*Math.pow(u,2))*o[l]+(Math.pow(u,3)-Math.pow(u,2))*c}}(n,i,{p0:o[3*l+1],outTangent0:o[3*l+2],inTangent1:o[3*u+0],p1:o[3*u+1],tDiff:m,ratio:p})}break;default:d.a.warn("Interpolation "+a+" not supported")()}}var P=function(){function e(e){this.startTime=0,this.playing=!0,this.speed=1,Object.assign(this,e)}return e.prototype.animate=function(e){if(this.playing){var t=(e/1e3-this.startTime)*this.speed;this.channels.forEach(function(e){var n=e.sampler,i=e.target,r=e.path;C(t,n,i,r),function(e,t){if(t.matrix.identity(),e.translation&&t.matrix.translate(e.translation),e.rotation){var n=I.fromQuaternion(e.rotation);t.matrix.multiplyRight(n)}e.scale&&t.matrix.scale(e.scale)}(i,i._node)})}},e}(),D=function(){function e(e){this.animations=e.animations.map(function(t,n){var i=t.name||"Animation-"+n,r=t.samplers.map(function(t){var n=t.input,i=t.interpolation,r=void 0===i?"LINEAR":i,a=t.output;return{input:R(e.accessors[n]),interpolation:r,output:R(e.accessors[a])}}),a=t.channels.map(function(t){var n=t.sampler,i=t.target;return{sampler:r[n],target:e.nodes[i.node],path:i.path}});return new P({name:i,channels:a})})}var t=e.prototype;return t.animate=function(e){this.setTime(e)},t.setTime=function(e){this.animations.forEach(function(t){return t.animate(e)})},t.getAnimations=function(){return this.animations},e}(),N=n(510),w=n(364),F="uniform mat4 u_MVPMatrix;\nuniform mat4 u_ModelMatrix;\nuniform mat4 u_NormalMatrix;\n",U="#if (defined(SHADER_TYPE_FRAGMENT) && defined(LIGHTING_FRAGMENT)) || (defined(SHADER_TYPE_VERTEX) && defined(LIGHTING_VERTEX))\n\nstruct AmbientLight {\n vec3 color;\n};\n\nstruct PointLight {\n vec3 color;\n vec3 position;\n\n // Constant-Linear-Exponential\n vec3 attenuation;\n};\n\nstruct DirectionalLight {\n  vec3 color;\n  vec3 direction;\n};\n\nuniform AmbientLight lighting_uAmbientLight;\nuniform PointLight lighting_uPointLight[MAX_LIGHTS];\nuniform DirectionalLight lighting_uDirectionalLight[MAX_LIGHTS];\nuniform int lighting_uPointLightCount;\nuniform int lighting_uDirectionalLightCount;\n\nuniform bool lighting_uEnabled;\n\nfloat getPointLightAttenuation(PointLight pointLight, float distance) {\n  return pointLight.attenuation.x\n       + pointLight.attenuation.y * distance\n       + pointLight.attenuation.z * distance * distance;\n}\n\n#endif\n",B={name:"lights",vs:U,fs:U,getUniforms:function e(t){void 0===t&&(t=G);if("lightSources"in t){var n=t.lightSources||{},i=n.ambientLight,r=n.pointLights,a=n.directionalLights,o=i||r&&r.length>0||a&&a.length>0;return o?Object.assign({},function(e){var t=e.ambientLight,n=e.pointLights,i=void 0===n?[]:n,r=e.directionalLights,a=void 0===r?[]:r,o={};o["lighting_uAmbientLight.color"]=t?j(t):[0,0,0];return i.forEach(function(e,t){o["lighting_uPointLight["+t+"].color"]=j(e),o["lighting_uPointLight["+t+"].position"]=e.position,o["lighting_uPointLight["+t+"].attenuation"]=e.attenuation}),o.lighting_uPointLightCount=i.length,a.forEach(function(e,t){o["lighting_uDirectionalLight["+t+"].color"]=j(e),o["lighting_uDirectionalLight["+t+"].direction"]=e.direction}),o.lighting_uDirectionalLightCount=a.length,o}({ambientLight:i,pointLights:r,directionalLights:a}),{lighting_uEnabled:!0}):{lighting_uEnabled:!1}}if("lights"in t){for(var s={pointLights:[],directionalLights:[]},u=t.lights||[],l=Array.isArray(u),f=0,u=l?u:u[Symbol.iterator]();;){var c;if(l){if(f>=u.length)break;c=u[f++]}else{if((f=u.next()).done)break;c=f.value}var d=c;switch(d.type){case"ambient":s.ambientLight=d;break;case"directional":s.directionalLights.push(d);break;case"point":s.pointLights.push(d)}}return e({lightSources:s})}return{}},defines:{MAX_LIGHTS:3}},G={};function j(e){var t=void 0===e?{}:e,n=t.color,i=void 0===n?[0,0,0]:n,r=t.intensity,a=void 0===r?1:r;return i.map(function(e){return e*a/255})}var k={name:"pbr",vs:"varying vec3 pbr_vPosition;\nvarying vec2 pbr_vUV;\n\n#ifdef HAS_NORMALS\n# ifdef HAS_TANGENTS\nvarying mat3 pbr_vTBN;\n# else\nvarying vec3 pbr_vNormal;\n# endif\n#endif\n\nvoid pbr_setPositionNormalTangentUV(vec4 position, vec4 normal, vec4 tangent, vec2 uv)\n{\n  vec4 pos = u_ModelMatrix * position;\n  pbr_vPosition = vec3(pos.xyz) / pos.w;\n\n#ifdef HAS_NORMALS\n#ifdef HAS_TANGENTS\n  vec3 normalW = normalize(vec3(u_NormalMatrix * vec4(normal.xyz, 0.0)));\n  vec3 tangentW = normalize(vec3(u_ModelMatrix * vec4(tangent.xyz, 0.0)));\n  vec3 bitangentW = cross(normalW, tangentW) * tangent.w;\n  pbr_vTBN = mat3(tangentW, bitangentW, normalW);\n#else // HAS_TANGENTS != 1\n  pbr_vNormal = normalize(vec3(u_ModelMatrix * vec4(normal.xyz, 0.0)));\n#endif\n#endif\n\n#ifdef HAS_UV\n  pbr_vUV = uv;\n#else\n  pbr_vUV = vec2(0.,0.);\n#endif\n}\n",fs:"#if (__VERSION__ < 300)\n#extension GL_EXT_shader_texture_lod: enable\n#extension GL_OES_standard_derivatives : enable\n#endif\n\n// WebGL 1.0 does not support non-constant in for loops\n// This provides an easy way to handle these cases\n// and still take advantage of WebGL 2.0\n#if (__VERSION__ < 300)\n  #define SMART_FOR(INIT, WEBGL1COND, WEBGL2COND, INCR) for (INIT; WEBGL1COND; INCR)\n#else\n  #define SMART_FOR(INIT, WEBGL1COND, WEBGL2COND, INCR) for (INIT; WEBGL2COND; INCR)\n#endif\n\nprecision highp float;\n\n#ifdef USE_IBL\nuniform samplerCube u_DiffuseEnvSampler;\nuniform samplerCube u_SpecularEnvSampler;\nuniform sampler2D u_brdfLUT;\nuniform vec2 u_ScaleIBLAmbient;\n#endif\n\n#ifdef HAS_BASECOLORMAP\nuniform sampler2D u_BaseColorSampler;\n#endif\n#ifdef HAS_NORMALMAP\nuniform sampler2D u_NormalSampler;\nuniform float u_NormalScale;\n#endif\n#ifdef HAS_EMISSIVEMAP\nuniform sampler2D u_EmissiveSampler;\nuniform vec3 u_EmissiveFactor;\n#endif\n#ifdef HAS_METALROUGHNESSMAP\nuniform sampler2D u_MetallicRoughnessSampler;\n#endif\n#ifdef HAS_OCCLUSIONMAP\nuniform sampler2D u_OcclusionSampler;\nuniform float u_OcclusionStrength;\n#endif\n\n#ifdef ALPHA_CUTOFF\nuniform float u_AlphaCutoff;\n#endif\n\nuniform vec2 u_MetallicRoughnessValues;\nuniform vec4 u_BaseColorFactor;\n\nuniform vec3 u_Camera;\n\n// debugging flags used for shader output of intermediate PBR variables\n#ifdef PBR_DEBUG\nuniform vec4 u_ScaleDiffBaseMR;\nuniform vec4 u_ScaleFGDSpec;\n#endif\n\nvarying vec3 pbr_vPosition;\n\nvarying vec2 pbr_vUV;\n\n#ifdef HAS_NORMALS\n#ifdef HAS_TANGENTS\nvarying mat3 pbr_vTBN;\n#else\nvarying vec3 pbr_vNormal;\n#endif\n#endif\n\n// Encapsulate the various inputs used by the various functions in the shading equation\n// We store values in this struct to simplify the integration of alternative implementations\n// of the shading terms, outlined in the Readme.MD Appendix.\nstruct PBRInfo\n{\n  float NdotL;                  // cos angle between normal and light direction\n  float NdotV;                  // cos angle between normal and view direction\n  float NdotH;                  // cos angle between normal and half vector\n  float LdotH;                  // cos angle between light direction and half vector\n  float VdotH;                  // cos angle between view direction and half vector\n  float perceptualRoughness;    // roughness value, as authored by the model creator (input to shader)\n  float metalness;              // metallic value at the surface\n  vec3 reflectance0;            // full reflectance color (normal incidence angle)\n  vec3 reflectance90;           // reflectance color at grazing angle\n  float alphaRoughness;         // roughness mapped to a more linear change in the roughness (proposed by [2])\n  vec3 diffuseColor;            // color contribution from diffuse lighting\n  vec3 specularColor;           // color contribution from specular lighting\n  vec3 n;                       // normal at surface point\n  vec3 v;                       // vector from surface point to camera\n};\n\nconst float M_PI = 3.141592653589793;\nconst float c_MinRoughness = 0.04;\n\nvec4 SRGBtoLINEAR(vec4 srgbIn)\n{\n#ifdef MANUAL_SRGB\n#ifdef SRGB_FAST_APPROXIMATION\n  vec3 linOut = pow(srgbIn.xyz,vec3(2.2));\n#else //SRGB_FAST_APPROXIMATION\n  vec3 bLess = step(vec3(0.04045),srgbIn.xyz);\n  vec3 linOut = mix( srgbIn.xyz/vec3(12.92), pow((srgbIn.xyz+vec3(0.055))/vec3(1.055),vec3(2.4)), bLess );\n#endif //SRGB_FAST_APPROXIMATION\n  return vec4(linOut,srgbIn.w);;\n#else //MANUAL_SRGB\n  return srgbIn;\n#endif //MANUAL_SRGB\n}\n\n// Find the normal for this fragment, pulling either from a predefined normal map\n// or from the interpolated mesh normal and tangent attributes.\nvec3 getNormal()\n{\n  // Retrieve the tangent space matrix\n#ifndef HAS_TANGENTS\n  vec3 pos_dx = dFdx(pbr_vPosition);\n  vec3 pos_dy = dFdy(pbr_vPosition);\n  vec3 tex_dx = dFdx(vec3(pbr_vUV, 0.0));\n  vec3 tex_dy = dFdy(vec3(pbr_vUV, 0.0));\n  vec3 t = (tex_dy.t * pos_dx - tex_dx.t * pos_dy) / (tex_dx.s * tex_dy.t - tex_dy.s * tex_dx.t);\n\n#ifdef HAS_NORMALS\n  vec3 ng = normalize(pbr_vNormal);\n#else\n  vec3 ng = cross(pos_dx, pos_dy);\n#endif\n\n  t = normalize(t - ng * dot(ng, t));\n  vec3 b = normalize(cross(ng, t));\n  mat3 tbn = mat3(t, b, ng);\n#else // HAS_TANGENTS\n  mat3 tbn = pbr_vTBN;\n#endif\n\n#ifdef HAS_NORMALMAP\n  vec3 n = texture2D(u_NormalSampler, pbr_vUV).rgb;\n  n = normalize(tbn * ((2.0 * n - 1.0) * vec3(u_NormalScale, u_NormalScale, 1.0)));\n#else\n  // The tbn matrix is linearly interpolated, so we need to re-normalize\n  vec3 n = normalize(tbn[2].xyz);\n#endif\n\n  return n;\n}\n\n// Calculation of the lighting contribution from an optional Image Based Light source.\n// Precomputed Environment Maps are required uniform inputs and are computed as outlined in [1].\n// See our README.md on Environment Maps [3] for additional discussion.\n#ifdef USE_IBL\nvec3 getIBLContribution(PBRInfo pbrInputs, vec3 n, vec3 reflection)\n{\n  float mipCount = 9.0; // resolution of 512x512\n  float lod = (pbrInputs.perceptualRoughness * mipCount);\n  // retrieve a scale and bias to F0. See [1], Figure 3\n  vec3 brdf = SRGBtoLINEAR(texture2D(u_brdfLUT,\n    vec2(pbrInputs.NdotV, 1.0 - pbrInputs.perceptualRoughness))).rgb;\n  vec3 diffuseLight = SRGBtoLINEAR(textureCube(u_DiffuseEnvSampler, n)).rgb;\n\n#ifdef USE_TEX_LOD\n  vec3 specularLight = SRGBtoLINEAR(textureCubeLodEXT(u_SpecularEnvSampler, reflection, lod)).rgb;\n#else\n  vec3 specularLight = SRGBtoLINEAR(textureCube(u_SpecularEnvSampler, reflection)).rgb;\n#endif\n\n  vec3 diffuse = diffuseLight * pbrInputs.diffuseColor;\n  vec3 specular = specularLight * (pbrInputs.specularColor * brdf.x + brdf.y);\n\n  // For presentation, this allows us to disable IBL terms\n  diffuse *= u_ScaleIBLAmbient.x;\n  specular *= u_ScaleIBLAmbient.y;\n\n  return diffuse + specular;\n}\n#endif\n\n// Basic Lambertian diffuse\n// Implementation from Lambert's Photometria https://archive.org/details/lambertsphotome00lambgoog\n// See also [1], Equation 1\nvec3 diffuse(PBRInfo pbrInputs)\n{\n  return pbrInputs.diffuseColor / M_PI;\n}\n\n// The following equation models the Fresnel reflectance term of the spec equation (aka F())\n// Implementation of fresnel from [4], Equation 15\nvec3 specularReflection(PBRInfo pbrInputs)\n{\n  return pbrInputs.reflectance0 +\n    (pbrInputs.reflectance90 - pbrInputs.reflectance0) *\n    pow(clamp(1.0 - pbrInputs.VdotH, 0.0, 1.0), 5.0);\n}\n\n// This calculates the specular geometric attenuation (aka G()),\n// where rougher material will reflect less light back to the viewer.\n// This implementation is based on [1] Equation 4, and we adopt their modifications to\n// alphaRoughness as input as originally proposed in [2].\nfloat geometricOcclusion(PBRInfo pbrInputs)\n{\n  float NdotL = pbrInputs.NdotL;\n  float NdotV = pbrInputs.NdotV;\n  float r = pbrInputs.alphaRoughness;\n\n  float attenuationL = 2.0 * NdotL / (NdotL + sqrt(r * r + (1.0 - r * r) * (NdotL * NdotL)));\n  float attenuationV = 2.0 * NdotV / (NdotV + sqrt(r * r + (1.0 - r * r) * (NdotV * NdotV)));\n  return attenuationL * attenuationV;\n}\n\n// The following equation(s) model the distribution of microfacet normals across\n// the area being drawn (aka D())\n// Implementation from \"Average Irregularity Representation of a Roughened Surface\n// for Ray Reflection\" by T. S. Trowbridge, and K. P. Reitz\n// Follows the distribution function recommended in the SIGGRAPH 2013 course notes\n// from EPIC Games [1], Equation 3.\nfloat microfacetDistribution(PBRInfo pbrInputs)\n{\n  float roughnessSq = pbrInputs.alphaRoughness * pbrInputs.alphaRoughness;\n  float f = (pbrInputs.NdotH * roughnessSq - pbrInputs.NdotH) * pbrInputs.NdotH + 1.0;\n  return roughnessSq / (M_PI * f * f);\n}\n\nvoid PBRInfo_setAmbientLight(inout PBRInfo pbrInputs) {\n  pbrInputs.NdotL = 1.0;\n  pbrInputs.NdotH = 0.0;\n  pbrInputs.LdotH = 0.0;\n  pbrInputs.VdotH = 1.0;\n}\n\nvoid PBRInfo_setDirectionalLight(inout PBRInfo pbrInputs, vec3 lightDirection) {\n  vec3 n = pbrInputs.n;\n  vec3 v = pbrInputs.v;\n  vec3 l = normalize(lightDirection);             // Vector from surface point to light\n  vec3 h = normalize(l+v);                        // Half vector between both l and v\n\n  pbrInputs.NdotL = clamp(dot(n, l), 0.001, 1.0);\n  pbrInputs.NdotH = clamp(dot(n, h), 0.0, 1.0);\n  pbrInputs.LdotH = clamp(dot(l, h), 0.0, 1.0);\n  pbrInputs.VdotH = clamp(dot(v, h), 0.0, 1.0);\n}\n\nvoid PBRInfo_setPointLight(inout PBRInfo pbrInputs, PointLight pointLight) {\n  vec3 light_direction = normalize(pointLight.position - pbr_vPosition);\n  PBRInfo_setDirectionalLight(pbrInputs, light_direction);\n}\n\nvec3 calculateFinalColor(PBRInfo pbrInputs, vec3 lightColor) {\n  // Calculate the shading terms for the microfacet specular shading model\n  vec3 F = specularReflection(pbrInputs);\n  float G = geometricOcclusion(pbrInputs);\n  float D = microfacetDistribution(pbrInputs);\n\n  // Calculation of analytical lighting contribution\n  vec3 diffuseContrib = (1.0 - F) * diffuse(pbrInputs);\n  vec3 specContrib = F * G * D / (4.0 * pbrInputs.NdotL * pbrInputs.NdotV);\n  // Obtain final intensity as reflectance (BRDF) scaled by the energy of the light (cosine law)\n  return pbrInputs.NdotL * lightColor * (diffuseContrib + specContrib);\n}\n\nvec4 pbr_filterColor(vec4 colorUnused)\n{\n  // Metallic and Roughness material properties are packed together\n  // In glTF, these factors can be specified by fixed scalar values\n  // or from a metallic-roughness map\n  float perceptualRoughness = u_MetallicRoughnessValues.y;\n  float metallic = u_MetallicRoughnessValues.x;\n#ifdef HAS_METALROUGHNESSMAP\n  // Roughness is stored in the 'g' channel, metallic is stored in the 'b' channel.\n  // This layout intentionally reserves the 'r' channel for (optional) occlusion map data\n  vec4 mrSample = texture2D(u_MetallicRoughnessSampler, pbr_vUV);\n  perceptualRoughness = mrSample.g * perceptualRoughness;\n  metallic = mrSample.b * metallic;\n#endif\n  perceptualRoughness = clamp(perceptualRoughness, c_MinRoughness, 1.0);\n  metallic = clamp(metallic, 0.0, 1.0);\n  // Roughness is authored as perceptual roughness; as is convention,\n  // convert to material roughness by squaring the perceptual roughness [2].\n  float alphaRoughness = perceptualRoughness * perceptualRoughness;\n\n  // The albedo may be defined from a base texture or a flat color\n#ifdef HAS_BASECOLORMAP\n  vec4 baseColor = SRGBtoLINEAR(texture2D(u_BaseColorSampler, pbr_vUV)) * u_BaseColorFactor;\n#else\n  vec4 baseColor = u_BaseColorFactor;\n#endif\n\n#ifdef ALPHA_CUTOFF\n  if (baseColor.a < u_AlphaCutoff) {\n    discard;\n  }\n#endif\n\n  vec3 f0 = vec3(0.04);\n  vec3 diffuseColor = baseColor.rgb * (vec3(1.0) - f0);\n  diffuseColor *= 1.0 - metallic;\n  vec3 specularColor = mix(f0, baseColor.rgb, metallic);\n\n  // Compute reflectance.\n  float reflectance = max(max(specularColor.r, specularColor.g), specularColor.b);\n\n  // For typical incident reflectance range (between 4% to 100%) set the grazing\n  // reflectance to 100% for typical fresnel effect.\n  // For very low reflectance range on highly diffuse objects (below 4%),\n  // incrementally reduce grazing reflecance to 0%.\n  float reflectance90 = clamp(reflectance * 25.0, 0.0, 1.0);\n  vec3 specularEnvironmentR0 = specularColor.rgb;\n  vec3 specularEnvironmentR90 = vec3(1.0, 1.0, 1.0) * reflectance90;\n\n  vec3 n = getNormal();                          // normal at surface point\n  vec3 v = normalize(u_Camera - pbr_vPosition);  // Vector from surface point to camera\n\n  float NdotV = clamp(abs(dot(n, v)), 0.001, 1.0);\n  vec3 reflection = -normalize(reflect(v, n));\n\n  PBRInfo pbrInputs = PBRInfo(\n    0.0, // NdotL\n    NdotV,\n    0.0, // NdotH\n    0.0, // LdotH\n    0.0, // VdotH\n    perceptualRoughness,\n    metallic,\n    specularEnvironmentR0,\n    specularEnvironmentR90,\n    alphaRoughness,\n    diffuseColor,\n    specularColor,\n    n,\n    v\n  );\n\n  vec3 color = vec3(0, 0, 0);\n\n#ifdef USE_LIGHTS\n  // Apply ambient light\n  PBRInfo_setAmbientLight(pbrInputs);\n  color += calculateFinalColor(pbrInputs, lighting_uAmbientLight.color);\n\n  // Apply directional light\n  SMART_FOR(int i = 0, i < MAX_LIGHTS, i < lighting_uDirectionalLightCount, i++) {\n    if (i < lighting_uDirectionalLightCount) {\n      PBRInfo_setDirectionalLight(pbrInputs, lighting_uDirectionalLight[i].direction);\n      color += calculateFinalColor(pbrInputs, lighting_uDirectionalLight[i].color);\n    }\n  }\n\n  // Apply point light\n  SMART_FOR(int i = 0, i < MAX_LIGHTS, i < lighting_uPointLightCount, i++) {\n    if (i < lighting_uPointLightCount) {\n      PBRInfo_setPointLight(pbrInputs, lighting_uPointLight[i]);\n      float attenuation = getPointLightAttenuation(lighting_uPointLight[i], distance(lighting_uPointLight[i].position, pbr_vPosition));\n      color += calculateFinalColor(pbrInputs, lighting_uPointLight[i].color / attenuation);\n    }\n  }\n#endif\n\n  // Calculate lighting contribution from image based lighting source (IBL)\n#ifdef USE_IBL\n  color += getIBLContribution(pbrInputs, n, reflection);\n#endif\n\n  // Apply optional PBR terms for additional (optional) shading\n#ifdef HAS_OCCLUSIONMAP\n  float ao = texture2D(u_OcclusionSampler, pbr_vUV).r;\n  color = mix(color, color * ao, u_OcclusionStrength);\n#endif\n\n#ifdef HAS_EMISSIVEMAP\n  vec3 emissive = SRGBtoLINEAR(texture2D(u_EmissiveSampler, pbr_vUV)).rgb * u_EmissiveFactor;\n  color += emissive;\n#endif\n\n  // This section uses mix to override final color for reference app visualization\n  // of various parameters in the lighting equation.\n#ifdef PBR_DEBUG\n  // TODO: Figure out how to debug multiple lights\n\n  // color = mix(color, F, u_ScaleFGDSpec.x);\n  // color = mix(color, vec3(G), u_ScaleFGDSpec.y);\n  // color = mix(color, vec3(D), u_ScaleFGDSpec.z);\n  // color = mix(color, specContrib, u_ScaleFGDSpec.w);\n\n  // color = mix(color, diffuseContrib, u_ScaleDiffBaseMR.x);\n  color = mix(color, baseColor.rgb, u_ScaleDiffBaseMR.y);\n  color = mix(color, vec3(metallic), u_ScaleDiffBaseMR.z);\n  color = mix(color, vec3(perceptualRoughness), u_ScaleDiffBaseMR.w);\n#endif\n\n  return vec4(pow(color,vec3(1.0/2.2)), baseColor.a);\n}\n",defines:{LIGHTING_FRAGMENT:1},dependencies:[{name:"project2",vs:F,fs:F},B]},H=n(405),V=function(){function e(e,t){var n=t.attributes,i=t.material,r=t.pbrDebug,a=t.imageBasedLightingEnvironment,o=t.lights,s=t.useTangents;this.gl=e,this.defines={USE_TEX_LOD:1,MANUAL_SRGB:1,SRGB_FAST_APPROXIMATION:1},this.uniforms={u_Camera:[0,0,0],u_MetallicRoughnessValues:[1,1]},this.parameters={},this.generatedTextures=[],a&&(this.uniforms.u_DiffuseEnvSampler=a.getDiffuseEnvSampler(),this.uniforms.u_SpecularEnvSampler=a.getSpecularEnvSampler(),this.uniforms.u_brdfLUT=a.getBrdfTexture(),this.uniforms.u_ScaleIBLAmbient=[1,1]),r&&(this.uniforms.u_ScaleDiffBaseMR=[0,0,0,0],this.uniforms.u_ScaleFGDSpec=[0,0,0,0]),this.defineIfPresent(n.NORMAL,"HAS_NORMALS"),this.defineIfPresent(n.TANGENT&&s,"HAS_TANGENTS"),this.defineIfPresent(n.TEXCOORD_0,"HAS_UV"),this.defineIfPresent(a,"USE_IBL"),this.defineIfPresent(o,"USE_LIGHTS"),this.defineIfPresent(r,"PBR_DEBUG"),i&&this.parseMaterial(i)}var t=e.prototype;return t.defineIfPresent=function(e,t){e&&(this.defines[t]=1)},t.parseTexture=function(e,t,n){var i;void 0===n&&(n=null);var r=e.texture&&e.texture.sampler&&e.texture.sampler.parameters||{},a=new H.a(this.gl,{id:e.name||e.id,parameters:r,pixelStore:(i={},i[this.gl.UNPACK_FLIP_Y_WEBGL]=!1,i),data:e.texture.source.getImageAsync()});this.uniforms[t]=a,this.defineIfPresent(n,n),this.generatedTextures.push(a)},t.parsePbrMetallicRoughness=function(e){e.baseColorTexture&&this.parseTexture(e.baseColorTexture,"u_BaseColorSampler","HAS_BASECOLORMAP"),this.uniforms.u_BaseColorFactor=e.baseColorFactor||[1,1,1,1],e.metallicRoughnessTexture&&this.parseTexture(e.metallicRoughnessTexture,"u_MetallicRoughnessSampler","HAS_METALROUGHNESSMAP");var t=e.metallicFactor,n=void 0===t?1:t,i=e.roughnessFactor,r=void 0===i?1:i;this.uniforms.u_MetallicRoughnessValues=[n,r]},t.parseMaterial=function(e){if(e.pbrMetallicRoughness&&this.parsePbrMetallicRoughness(e.pbrMetallicRoughness),e.normalTexture){this.parseTexture(e.normalTexture,"u_NormalSampler","HAS_NORMALMAP");var t=e.normalTexture.scale,n=void 0===t?1:t;this.uniforms.u_NormalScale=n}if(e.occlusionTexture){this.parseTexture(e.occlusionTexture,"u_OcclusionSampler","HAS_OCCLUSIONMAP");var i=e.occlusionTexture.strength,r=void 0===i?1:i;this.uniforms.u_OcclusionStrength=r}if(e.emissiveTexture&&(this.parseTexture(e.emissiveTexture,"u_EmissiveSampler","HAS_EMISSIVEMAP"),this.uniforms.u_EmissiveFactor=e.emissiveFactor||[0,0,0]),"MASK"===e.alphaMode){var a=e.alphaCutoff,o=void 0===a?.5:a;this.defines.ALPHA_CUTOFF=1,this.uniforms.u_AlphaCutoff=o}else"BLEND"===e.alphaMode&&(d.a.warn("BLEND alphaMode might not work well because it requires mesh sorting")(),Object.assign(this.parameters,{blend:!0,blendEquation:this.gl.FUNC_ADD,blendFunc:[this.gl.SRC_ALPHA,this.gl.ONE_MINUS_SRC_ALPHA,this.gl.ONE,this.gl.ONE_MINUS_SRC_ALPHA]}))},e}();function X(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var z="\n#if (__VERSION__ < 300)\n  #define _attr attribute\n#else\n  #define _attr in\n#endif\n\n  _attr vec4 POSITION;\n\n  #ifdef HAS_NORMALS\n    _attr vec4 NORMAL;\n  #endif\n\n  #ifdef HAS_TANGENTS\n    _attr vec4 TANGENT;\n  #endif\n\n  #ifdef HAS_UV\n    _attr vec2 TEXCOORD_0;\n  #endif\n\n  void main(void) {\n    vec4 _NORMAL = vec4(0.);\n    vec4 _TANGENT = vec4(0.);\n    vec2 _TEXCOORD_0 = vec2(0.);\n\n    #ifdef HAS_NORMALS\n      _NORMAL = NORMAL;\n    #endif\n\n    #ifdef HAS_TANGENTS\n      _TANGENT = TANGENT;\n    #endif\n\n    #ifdef HAS_UV\n      _TEXCOORD_0 = TEXCOORD_0;\n    #endif\n\n    pbr_setPositionNormalTangentUV(POSITION, _NORMAL, _TANGENT, _TEXCOORD_0);\n    gl_Position = u_MVPMatrix * POSITION;\n  }\n",W="\n#if (__VERSION__ < 300)\n  #define fragmentColor gl_FragColor\n#else\n  out vec4 fragmentColor;\n#endif\n\n  void main(void) {\n    fragmentColor = pbr_filterColor(vec4(0));\n  }\n";function Q(e,t){return Object(N.d)(e)?"#version 300 es\n"+t:t}var Y={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},q={modelOptions:{},pbrDebug:!1,imageBasedLightingEnvironment:null,lights:!0,useTangents:!1},K=function(){function e(e,t){void 0===t&&(t={}),this.gl=e,this.options=Object.assign({},q,t)}var t=e.prototype;return t.instantiate=function(e){var t=this;return this.gltf=e,(e.scenes||[]).map(function(e){return t.createScene(e)})},t.createAnimator=function(){return Array.isArray(this.gltf.animations)?new D(this.gltf):null},t.createScene=function(e){var t=this,n=(e.nodes||[]).map(function(e){return t.createNode(e)});return new y({id:e.name||e.id,children:n})},t.createNode=function(e){var t=this;if(!e._node){var n=(e.children||[]).map(function(e){return t.createNode(e)});e.mesh&&n.push(this.createMesh(e.mesh));var i=new y({id:e.name||e.id,children:n});if(e.matrix)i.setMatrix(e.matrix);else{if(i.matrix.identity(),e.translation&&i.matrix.translate(e.translation),e.rotation){var r=(new b.a).fromQuaternion(e.rotation);i.matrix.multiplyRight(r)}e.scale&&i.matrix.scale(e.scale)}e._node=i}return e._node},t.createMesh=function(e){var t=this;if(!e._mesh){var n=(e.primitives||[]).map(function(n,i){return t.createPrimitive(n,i,e)}),i=new y({id:e.name||e.id,children:n});e._mesh=i}return e._mesh},t.getVertexCount=function(e){d.a.warn("getVertexCount() not found")()},t.createPrimitive=function(e,t,n){return function(e,t){var n=t.id,i=t.drawMode,r=t.vertexCount,a=t.attributes,o=t.modelOptions,s=new V(e,t);d.a.info(4,"createGLTFModel defines: ",s.defines)();var u=[];u.push.apply(u,X(s.generatedTextures)),u.push.apply(u,X(Object.values(a).map(function(e){return e.buffer})));var l=new w.a(e,Object.assign({id:n,drawMode:i,vertexCount:r,modules:[k],defines:s.defines,parameters:s.parameters,vs:Q(e,z),fs:Q(e,W),managedResources:u},o));return l.setProps({attributes:a}),l.setUniforms(s.uniforms),l}(this.gl,Object.assign({id:e.name||(n.name||n.id)+"-primitive-"+t,drawMode:e.mode||4,vertexCount:e.indices?e.indices.count:this.getVertexCount(e.attributes),attributes:this.createAttributes(e.attributes,e.indices),material:e.material},this.options))},t.createAttributes=function(e,t){var n=this,i={};return Object.keys(e).forEach(function(t){i[t]=n.createAccessor(e[t],n.createBuffer(e[t],n.gl.ARRAY_BUFFER))}),t&&(i.indices=this.createAccessor(t,this.createBuffer(t,this.gl.ELEMENT_ARRAY_BUFFER))),d.a.info(4,"glTF Attributes",{attributes:e,indices:t,generated:i})(),i},t.createBuffer=function(e,t){e.bufferView||(e.bufferView={});var n=e.bufferView;return n.lumaBuffers||(n.lumaBuffers={}),n.lumaBuffers[t]||(n.lumaBuffers[t]=new S.a(this.gl,{id:"from-"+n.id,data:n.data||e.value,target:t})),n.lumaBuffers[t]},t.createAccessor=function(e,t){return new L.a({buffer:t,offset:e.byteOffset||0,stride:e.bufferView.byteStride||0,type:e.componentType,size:Y[e.type]})},t.createSampler=function(e){return e},t.needsPOT=function(){return!1},e}();function Z(e,t,n){var i=new K(e,n);return{scenes:i.instantiate(t),animator:i.createAnimator()}}function J(e,t,n,i,r,a,o){try{var s=e[a](o),u=s.value}catch(l){return void n(l)}s.done?t(u):Promise.resolve(u).then(i,r)}function $(e){return function(){var t=this,n=arguments;return new Promise(function(i,r){var a=e.apply(t,n);function o(e){J(a,i,r,o,s,"next",e)}function s(e){J(a,i,r,o,s,"throw",e)}o(void 0)})}}function ee(){return(ee=$(s.a.mark(function e(t,n,i,r){var a,o;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return Object(v.a)(n.gl),e.next=3,_.a.parse(t,Object.assign({},n,{uri:i,decompress:!0}));case 3:if(a=e.sent,o=Z(n.gl,a,n),!n.waitForFullLoad){e.next=8;break}return e.next=8,te(o);case 8:return e.abrupt("return",Object.assign({gltf:a},o));case 9:case"end":return e.stop()}},e)}))).apply(this,arguments)}function te(e){return ne.apply(this,arguments)}function ne(){return(ne=$(s.a.mark(function e(t){var n;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=[],t.scenes.forEach(function(e){e.traverse(function(e){Object.values(e.model.program.uniforms).forEach(function(e){!1===e.loaded&&n.push(e)})})}),e.next=4,ie(function(){return n.some(function(e){return!e.loaded})});case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}},e)}))).apply(this,arguments)}function ie(e){return re.apply(this,arguments)}function re(){return(re=$(s.a.mark(function e(t){return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!t()){e.next=5;break}return e.next=3,new Promise(function(e){return window.requestAnimationFrame(e)});case 3:e.next=0;break;case 5:case"end":return e.stop()}},e)}))).apply(this,arguments)}var ae,oe={name:"GLTF Scenegraph Loader",extensions:["gltf","glb"],parse:function(e,t,n,i){return ee.apply(this,arguments)}},se=n(440),ue=n(573),le=n(437),fe=n(582),ce=function(){function e(e,t){var n=t.brdfLutUrl,i=t.getTexUrl,r=t.specularMipLevels,a=void 0===r?10:r;this.gl=e,this.brdfLutUrl=n,this.getTexUrl=i,this.specularMipLevels=a}var t=e.prototype;return t.makeCube=function(e){var t=e.id,n=e.getTextureForFace,i=e.parameters,r={};return le.a.FACES.forEach(function(e){r[e]=n(e)}),new le.a(this.gl,{id:t,mipmaps:!1,parameters:i,pixels:r})},t.getDiffuseEnvSampler=function(){var e,t=this;this._DiffuseEnvSampler||(this._DiffuseEnvSampler=this.makeCube({id:"DiffuseEnvSampler",getTextureForFace:function(e){return Object(fe.a)(t.getTexUrl("diffuse",e,0))},parameters:(e={},e[c.a.TEXTURE_WRAP_S]=c.a.CLAMP_TO_EDGE,e[c.a.TEXTURE_WRAP_T]=c.a.CLAMP_TO_EDGE,e[c.a.TEXTURE_MIN_FILTER]=c.a.LINEAR,e[c.a.TEXTURE_MAG_FILTER]=c.a.LINEAR,e)}));return this._DiffuseEnvSampler},t.getSpecularEnvSampler=function(){var e,t=this;this._SpecularEnvSampler||(this._SpecularEnvSampler=this.makeCube({id:"SpecularEnvSampler",getTextureForFace:function(e){for(var n=[],i=0;i<=t.specularMipLevels-1;i++)n.push(Object(fe.a)(t.getTexUrl("specular",e,i)));return n},parameters:(e={},e[c.a.TEXTURE_WRAP_S]=c.a.CLAMP_TO_EDGE,e[c.a.TEXTURE_WRAP_T]=c.a.CLAMP_TO_EDGE,e[c.a.TEXTURE_MIN_FILTER]=c.a.LINEAR_MIPMAP_LINEAR,e[c.a.TEXTURE_MAG_FILTER]=c.a.LINEAR,e)}));return this._SpecularEnvSampler},t.getBrdfTexture=function(){var e,t;this._BrdfTexture||(this._BrdfTexture=new H.a(this.gl,{id:"brdfLUT",parameters:(e={},e[c.a.TEXTURE_WRAP_S]=c.a.CLAMP_TO_EDGE,e[c.a.TEXTURE_WRAP_T]=c.a.CLAMP_TO_EDGE,e[c.a.TEXTURE_MIN_FILTER]=c.a.LINEAR,e[c.a.TEXTURE_MAG_FILTER]=c.a.LINEAR,e),pixelStore:(t={},t[this.gl.UNPACK_FLIP_Y_WEBGL]=!1,t),data:Object(fe.a)(this.brdfLutUrl)}));return this._BrdfTexture},t.delete=function(){this._DiffuseEnvSampler&&(this._DiffuseEnvSampler.delete(),this._DiffuseEnvSampler=null),this._SpecularEnvSampler&&(this._SpecularEnvSampler.delete(),this._SpecularEnvSampler=null),this._BrdfTexture&&(this._BrdfTexture.delete(),this._BrdfTexture=null)},e}(),de=n(354);function he(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function pe(e,t,n,i,r,a,o){try{var s=e[a](o),u=s.value}catch(l){return void n(l)}s.done?t(u):Promise.resolve(u).then(i,r)}var me=((ae={})[c.a.TEXTURE_CUBE_MAP_POSITIVE_X]="right",ae[c.a.TEXTURE_CUBE_MAP_NEGATIVE_X]="left",ae[c.a.TEXTURE_CUBE_MAP_POSITIVE_Y]="top",ae[c.a.TEXTURE_CUBE_MAP_NEGATIVE_Y]="bottom",ae[c.a.TEXTURE_CUBE_MAP_POSITIVE_Z]="front",ae[c.a.TEXTURE_CUBE_MAP_NEGATIVE_Z]="back",ae),ge="https://raw.githubusercontent.com/uber-common/deck.gl-data/master/luma.gl/examples/gltf/",ve={default:{directionalLights:[{color:[255,255,255],direction:[0,.5,.5],intensity:1}]},ambient:{ambientLight:{color:[255,255,255],intensity:1}},directional1:{directionalLights:[{color:[255,0,0],direction:[1,0,0],intensity:1}],ambientLight:{color:[255,255,255],intensity:1}},directional3:{directionalLights:[{color:[255,0,0],direction:[1,0,0],intensity:1},{color:[0,0,255],direction:[0,0,1],intensity:1},{color:[0,255,0],direction:[0,1,0],intensity:1}]},point1far:{pointLights:[{color:[255,0,0],position:[200,0,0],attenuation:[0,0,.01],intensity:1}],ambientLight:{color:[255,255,255],intensity:1}},point1near:{pointLights:[{color:[255,0,0],position:[10,0,0],attenuation:[0,0,.01],intensity:1}],ambientLight:{color:[255,255,255],intensity:1}}},_e={pbrDebug:!0,imageBasedLightingEnvironment:null,lights:!1};function be(e,t,n){return Ee.apply(this,arguments)}function Ee(){var e;return e=s.a.mark(function e(t,n,i){var r,a,o,f,c;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r="string"==typeof t?window.fetch(t):t,e.next=3,Object(u.a)(r,oe,Object.assign({},i,{gl:n,DracoLoader:l.a}));case 3:return a=e.sent,o=a.gltf,f=a.scenes,c=a.animator,f[0].traverse(function(e,t){t.worldMatrix;return d.a.info(4,"Using model: ",e)()}),e.abrupt("return",{scenes:f,animator:c,gltf:o});case 9:case"end":return e.stop()}},e)}),(Ee=function(){var t=this,n=arguments;return new Promise(function(i,r){var a=e.apply(t,n);function o(e){pe(a,i,r,o,s,"next",e)}function s(e){pe(a,i,r,o,s,"throw",e)}o(void 0)})}).apply(this,arguments)}var Ae=function(e){var t,n;function i(t){var n;void 0===t&&(t={}),n=e.call(this,Object.assign({},t,{glOptions:{webgl1:!0,webgl2:!0,alpha:!1}}))||this;var i=t,r=i.modelFile,a=void 0===r?null:r,o=i.initialZoom,s=void 0===o?2:o;return n.scenes=[],n.animator=null,n.gl=null,n.modelFile=a,n.mouse={lastX:0,lastY:0},n.translate=s,n.rotation=[0,0],n.rotationStart=[0,0],n.u_ScaleDiffBaseMR=[0,0,0,0],n.u_ScaleFGDSpec=[0,0,0,0],n.attachTimeline(new se.a),n.timeline.play(),n.timelineChannel=n.timeline.addChannel({rate:.5}),n.animationHandle=null,n.onInitialize=n.onInitialize.bind(he(n)),n.onRender=n.onRender.bind(he(n)),n._setDisplay(new ue.a),n}n=e,(t=i).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n,i.getInfo=function(){return'\n<p><b>glTF Loader</b>.</p>\n<p>Rendered using luma.gl.</p>\n<div>\n  Show\n  <select id="showSelector">\n    <option value="0 0 0 0 0 0 0 0">Final Result</option>\n\n    <option value="0 1 0 0 0 0 0 0">Base Color</option>\n    <option value="0 0 1 0 0 0 0 0">Metallic</option>\n    <option value="0 0 0 1 0 0 0 0">Roughness</option>\n    <option value="1 0 0 0 0 0 0 0">Diffuse</option>\n\n    <option value="0 0 0 0 1 0 0 0">Specular Reflection</option>\n    <option value="0 0 0 0 0 1 0 0">Geometric Occlusion</option>\n    <option value="0 0 0 0 0 0 1 0">Microfacet Distribution</option>\n    <option value="0 0 0 0 0 0 0 1">Specular</option>\n  </select>\n  <br>\n</div>\n<div>\n  Regular Lights\n  <select id="lightSelector">\n    <option value="default">Default</option>\n    <option value="ambient">Ambient Only</option>\n    <option value="directional1">1x Directional (Red) + Ambient</option>\n    <option value="directional3">3x Directional (RGB)</option>\n    <option value="point1far">1x Point Light Far (Red) + Ambient</option>\n    <option value="point1near">1x Point Light Near (Red) + Ambient</option>\n  </select>\n  <br>\n</div>\n<div>\n  Image-Based Light\n  <select id="iblSelector">\n    <option value="exclusive">On (Exclusive)</option>\n    <option value="addition">On (Addition to Regular)</option>\n    <option value="off">Off (Only Regular)</option>\n  </select>\n  <br>\n</div>\n<p><img src="https://img.shields.io/badge/WebVR-Supported-orange.svg" /></p>\n'};var r=i.prototype;return r.initalizeEventHandling=function(e){var t=this,n=!1,i=function(e,i){t.mouse.lastX=e,t.mouse.lastY=i,t.rotationStart[0]=t.rotation[0],t.rotationStart[1]=t.rotation[1],n=!0},r=function(e,i){if(n){var r=e-t.mouse.lastX,a=i-t.mouse.lastY;t.rotation[0]=t.rotationStart[0]+a/100,t.rotation[1]=t.rotationStart[1]+r/100}};e.addEventListener("wheel",function(e){t.translate+=e.deltaY/10,t.translate<.5&&(t.translate=.5),e.preventDefault()}),e.addEventListener("mousedown",function(e){i(e.clientX,e.clientY),e.preventDefault()}),e.addEventListener("mouseup",function(e){n=!1}),e.addEventListener("mousemove",function(e){r(e.clientX,e.clientY)}),e.addEventListener("touchstart",function(e){i(e.touches[0].clientX,e.touches[0].clientY),e.preventDefault()}),e.addEventListener("touchmove",function(e){r(e.touches[0].clientX,e.touches[0].clientY)}),e.addEventListener("touchend",function(e){0===e.touches.length&&(n=!1)}),e.addEventListener("dragover",function(e){e.dataTransfer.dropEffect="link",e.preventDefault()}),e.addEventListener("drop",function(e){(e.preventDefault(),e.dataTransfer.files&&1===e.dataTransfer.files.length)&&(t._deleteScenes(),be(new Promise(function(t){var n=new window.FileReader;n.onload=function(e){return t(e.target.result)},n.readAsArrayBuffer(e.dataTransfer.files[0])}),t.gl,t.loadOptions).then(function(e){return t._fileLoaded(e)}))})},r._fileLoaded=function(e){null!==this.animationHandle&&(this.timeline.detachAnimation(this.animationHandle),this.animationHandle=null),this.animator=null,Object.assign(this,e),this.animator&&(this.animationHandle=this.timeline.attachAnimation(this.animator,this.timelineChannel))},r.onInitialize=function(e){var t=this,n=e.gl,i=e.canvas;if(Object(h.a)(n,{depthTest:!0,blend:!1}),this.loadOptions=_e,this.environment=new ce(n,{brdfLutUrl:ge+"/brdfLUT.png",getTexUrl:function(e,t,n){return ge+"/papermill/"+e+"/"+e+"_"+me[t]+"_"+n+".jpg"}}),this.loadOptions.imageBasedLightingEnvironment=this.environment,this.gl=n,this.modelFile){be(this.modelFile,this.gl,{pbrDebug:!1,imageBasedLightingEnvironment:null,lights:!0}).then(function(e){return t._fileLoaded(e)})}else{be(ge+"DamagedHelmet.glb",this.gl,this.loadOptions).then(function(e){return t._fileLoaded(e)})}var r=document.getElementById("showSelector");r&&(r.onchange=function(e){var n=r.value.split(" ").map(function(e){return parseFloat(e)});t.u_ScaleDiffBaseMR=n.slice(0,4),t.u_ScaleFGDSpec=n.slice(4)});var a=document.getElementById("lightSelector");a&&(a.onchange=function(e){t.light=a.value});var o=document.getElementById("iblSelector");o&&(o.onchange=function(e){t._updateLightSettings(o.value),t._rebuildModel()}),this.initalizeEventHandling(i)},r._updateLightSettings=function(e){switch(e){case"exclusive":Object.assign(this.loadOptions,{imageBasedLightingEnvironment:this.environment,lights:!1});break;case"addition":Object.assign(this.loadOptions,{imageBasedLightingEnvironment:this.environment,lights:!0});break;case"off":Object.assign(this.loadOptions,{imageBasedLightingEnvironment:null,lights:!0})}},r._rebuildModel=function(){(this.gltf.meshes||[]).forEach(function(e){return delete e._mesh}),(this.gltf.nodes||[]).forEach(function(e){return delete e._node}),(this.gltf.bufferViews||[]).forEach(function(e){return delete e.lumaBuffers}),this._deleteScenes(),Object.assign(this,Z(this.gl,this.gltf,this.loadOptions))},r._deleteScenes=function(){this.scenes.forEach(function(e){return e.delete()}),this.scenes=[],p.a.get("Resource Counts").forEach(function(e){var t=e.name,n=e.count;d.a.info(3,t+": "+n)()})},r.applyLight=function(e){e.updateModuleSettings({lightSources:ve[this.light||"default"]})},r.onRender=function(e){var t=this,n=e.gl,i=(e.time,e.aspect),r=e.viewMatrix,a=e.projectionMatrix;Object(m.a)(n,{color:[.2,.2,.2,1],depth:!0});var o=this.rotation,s=o[0],u=o[1],l=[-this.translate*Math.sin(u)*Math.cos(-s),-this.translate*Math.sin(-s),this.translate*Math.cos(u)*Math.cos(-s)],f=new b.a(r?Array.from(r):null).translate([0,0,-this.translate]).rotateX(s).rotateY(u),c=a?new b.a(Array.from(a)):(new b.a).perspective({fov:Object(de.e)(40),aspect:i,near:.1,far:9e3});if(!this.scenes.length)return!1;var d=!0;return this.scenes[0].traverse(function(e,n){var i=n.worldMatrix,r=new b.a(c).multiplyRight(f).multiplyRight(i);t.applyLight(e),d=d&&e.draw({uniforms:{u_Camera:l,u_MVPMatrix:r,u_ModelMatrix:i,u_NormalMatrix:new b.a(i).invert().transpose(),u_ScaleDiffBaseMR:t.u_ScaleDiffBaseMR,u_ScaleFGDSpec:t.u_ScaleFGDSpec},parameters:e.props.parameters})}),d},i}(g.a);if("undefined"!=typeof window&&!window.website){(new Ae).start();var ye=document.createElement("div");ye.innerHTML=Ae.getInfo(),document.body.appendChild(ye)}n.d(t,"default",function(){return Se});var Se=function(e){var t,n;function i(){return e.apply(this,arguments)||this}return n=e,(t=i).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n,i.prototype.render=function(){return r.a.createElement(a.a,{AnimationLoop:Ae,exampleConfig:this.props.pageContext.exampleConfig})},i}(r.a.Component)},341:function(e,t,n){"use strict";n(76),n(135),n(316),n(10),n(8),n(5),n(63),n(3),n(20),n(12),n(28);var i=n(359),r=n(342);n(6),n(4),n(9);var a=n(377),o=7936,s=7937,u=7938,l=35724,f={GLSL_FRAG_DATA:["WEBGL_draw_buffers",!0],GLSL_FRAG_DEPTH:["EXT_frag_depth",!0],GLSL_DERIVATIVES:["OES_standard_derivatives",!0],GLSL_TEXTURE_LOD:["EXT_shader_texture_lod",!0]},c={};Object.keys(f).forEach(function(e){c[e]=e});var d={};function h(e,t,n){void 0===n&&(n={});var i=f[t];if(Object(a.a)(i,t),!function(e){void 0===e&&(e={});var t="undefined"!=typeof window&&window.navigator||{},n=e.userAgent||t.userAgent||"",i=-1!==n.indexOf("MSIE "),r=-1!==n.indexOf("Trident/");return i||r}(n))return!0;if(t in d)return d[t];var r="#extension GL_"+i[0]+" : "+(n.behavior||"enable")+"\nvoid main(void) {}",o=e.createShader(e.VERTEX_SHADER);e.shaderSource(o,r),e.compileShader(o);var s=e.getShaderParameter(o,e.COMPILE_STATUS);return e.deleteShader(o),d[t]=s,s}function p(e,t){var n=f[t];Object(a.a)(n,t);var i=function(e){return Boolean(e&&2===e._version)}(e)&&n[1]||n[0],r="string"==typeof i?Boolean(e.getExtension(i)):i;return Object(a.a)(!1===r||!0===r),r}function m(e,t){return(t=Array.isArray(t)?t:[t]).every(function(t){return p(e,t)})}function g(e){switch(function(e){var t=e.getExtension("WEBGL_debug_renderer_info"),n=e.getParameter(t&&t.UNMASKED_VENDOR_WEBGL||o),i=e.getParameter(t&&t.UNMASKED_RENDERER_WEBGL||s);return{gpuVendor:function(e,t){return e.match(/NVIDIA/i)||t.match(/NVIDIA/i)?"NVIDIA":e.match(/INTEL/i)||t.match(/INTEL/i)?"INTEL":e.match(/AMD/i)||t.match(/AMD/i)||e.match(/ATI/i)||t.match(/ATI/i)?"AMD":"UNKNOWN GPU"}(n,i),vendor:n,renderer:i,version:e.getParameter(u),shadingLanguageVersion:e.getParameter(l)}}(e).gpuVendor.toLowerCase()){case"nvidia":return"#define NVIDIA_GPU\n// Nvidia optimizes away the calculation necessary for emulated fp64\n#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1\n";case"intel":return"#define INTEL_GPU\n// Intel optimizes away the calculation necessary for emulated fp64\n#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1\n// Intel's built-in 'tan' function doesn't have acceptable precision\n#define LUMA_FP32_TAN_PRECISION_WORKAROUND 1\n// Intel GPU doesn't have full 32 bits precision in same cases, causes overflow\n#define LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND 1\n";case"amd":return"#define AMD_GPU\n";default:return"#define DEFAULT_GPU\n// Prevent driver from optimizing away the calculation necessary for emulated fp64\n#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1\n// Intel's built-in 'tan' function doesn't have acceptable precision\n#define LUMA_FP32_TAN_PRECISION_WORKAROUND 1\n// Intel GPU doesn't have full 32 bits precision in same cases, causes overflow\n#define LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND 1\n"}}var v,_,b,E=n(351);n.d(t,"c",function(){return M}),n.d(t,"b",function(){return O}),n.d(t,"a",function(){return R});var A="\n\n"+E.a+"\n\n",y=((v={})[i.b]="vertex",v[i.a]="fragment",v),S=((_={})[i.b]={},_[i.a]={},_),L=((b={})[i.b]={},b[i.a]={},b),T="precision highp float;\n\n";function M(e,t){void 0===t&&(t={});var n=(e=e.trim()).split(":"),i=n[0],r=n[1],a=e.replace(/\(.+/,"");S[i][a]=Object.assign(t,{signature:r})}function O(e,t){var n=t.hook,i=t.injection,r=t.order,o=void 0===r?0:r,s=n.slice(0,2),u=L[s];u[e]=u[e]||{},Object(a.a)(!u[e][n],"Module injection already created"),u[e][n]={injection:i,order:o}}function R(e,t){var n=t.vs,a=t.fs,o=Object(r.b)(t.modules||[]);return{gl:e,vs:I(e,Object.assign({},t,{source:n,type:i.b,modules:o})),fs:I(e,Object.assign({},t,{source:a,type:i.a,modules:o})),getUniforms:x(o),modules:C(o)}}function I(e,t){var n,r,o=t.id,s=t.source,u=t.type,l=t.modules,f=t.defines,d=void 0===f?{}:f,p=t.hookFunctions,v=void 0===p?S:p,_=t.moduleInjections,b=void 0===_?L:_,M=t.inject,O=void 0===M?{}:M,R=t.prologue,I=void 0===R||R,x=t.log;(Object(a.a)("string"==typeof s,"shader source must be a string"),v!==S)&&((n={})[i.b]=Object.assign({},S[i.b],v[i.b]),n[i.a]=Object.assign({},S[i.a],v[i.a]),v=n);b!==L&&((r={})[i.b]=Object.assign({},L[i.b],b[i.b]),r[i.a]=Object.assign({},L[i.a],b[i.a]),b=r);var C=u===i.b,P=s.split("\n"),D=100,N="",w=s;0===P[0].indexOf("#version ")?(D=300,N=P[0],w=P.slice(1).join("\n")):N="#version "+D;var F={};l.forEach(function(e){Object.assign(F,e.getDefines())}),Object.assign(F,d);var U=I?N+"\n"+function(e){var t=e.id,n=e.source,i=e.type;return t&&"string"==typeof t&&-1===n.indexOf("SHADER_NAME")?"\n#define SHADER_NAME "+t+"_"+y[i]+"\n\n":""}({id:o,source:s,type:u})+"\n"+function(e){var t=e.type;return"\n#define SHADER_TYPE_"+y[t].toUpperCase()+"\n"}({type:u})+"\n"+g(e)+"\n"+function(e,t,n){var i="#if (__VERSION__ > 120)\n\n# define FRAG_DEPTH\n# define DERIVATIVES\n# define DRAW_BUFFERS\n# define TEXTURE_LOD\n\n#endif // __VERSION\n";return m(e,c.GLSL_FRAG_DEPTH)&&(i+="// FRAG_DEPTH => gl_FragDepth is available\n#ifdef GL_EXT_frag_depth\n#extension GL_EXT_frag_depth : enable\n# define FRAG_DEPTH\n# define gl_FragDepth gl_FragDepthEXT\n#endif\n"),m(e,c.GLSL_DERIVATIVES)&&h(e,c.GLSL_DERIVATIVES)&&(i+="// DERIVATIVES => dxdF, dxdY and fwidth are available\n#ifdef GL_OES_standard_derivatives\n#extension GL_OES_standard_derivatives : enable\n# define DERIVATIVES\n#endif\n"),m(e,c.GLSL_FRAG_DATA)&&h(e,c.GLSL_FRAG_DATA,{behavior:"require"})&&(i+="// DRAW_BUFFERS => gl_FragData[] is available\n#ifdef GL_EXT_draw_buffers\n#extension GL_EXT_draw_buffers : require\n#define DRAW_BUFFERS\n#endif\n"),m(e,c.GLSL_TEXTURE_LOD)&&(i+="// TEXTURE_LOD => texture2DLod etc are available\n#ifdef GL_EXT_shader_texture_lod\n#extension GL_EXT_shader_texture_lod : enable\n# define TEXTURE_LOD\n#define texture2DLod texture2DLodEXT\n#define texture2DProjLod texture2DProjLodEXT\n#define texture2DProjLod texture2DProjLodEXT\n#define textureCubeLod textureCubeLodEXT\n#define texture2DGrad texture2DGradEXT\n#define texture2DProjGrad texture2DProjGradEXT\n#define texture2DProjGrad texture2DProjGradEXT\n#define textureCubeGrad textureCubeGradEXT\n#endif\n"),i}(e)+"\n"+function(e){void 0===e&&(e={});var t=0,n="";for(var i in e){0===t&&(n+="\n// APPLICATION DEFINES\n"),t++;var r=e[i];(r||Number.isFinite(r))&&(n+="#define "+i.toUpperCase()+" "+e[i]+"\n")}0===t&&(n+="\n");return n}(F)+"\n"+(C?"":T)+"\n":N+"\n",B=!1,G={},j={};for(var k in O){var H="string"==typeof O[k]?{injection:O[k],order:0}:O[k];k.match(/^(v|f)s:/)?"#"===k[3]?j[k]=[H]:G[k]=[H]:j[k]=[H]}var V=l,X=Array.isArray(V),z=0;for(V=X?V:V[Symbol.iterator]();;){var W;if(X){if(z>=V.length)break;W=V[z++]}else{if((z=V.next()).done)break;W=z.value}var Q=W;switch(Q.name){case"inject":B=!0;break;default:if(x&&Q.checkDeprecations(w,x),U+=Q.getModuleSource(u,D),b[u][Q.name]){var Y=b[u][Q.name];for(var q in Y)q.match(/^(v|f)s:#/)?(j[q]=j[q]||[],j[q].push(Y[q])):(G[q]=G[q]||[],G[q].push(Y[q]))}}}return U+=A,U+=function(e,t){var n="";for(var i in e){var r=e[i];if(n+="void "+r.signature+" {\n",r.header&&(n+="  "+r.header),t[i]){var a=t[i];a.sort(function(e,t){return e.order-t.order});for(var o=a,s=Array.isArray(o),u=0,o=s?o:o[Symbol.iterator]();;){var l;if(s){if(u>=o.length)break;l=o[u++]}else{if((u=o.next()).done)break;l=u.value}var f=l;n+="  "+f.injection+"\n"}}r.footer&&(n+="  "+r.footer),n+="}\n"}return n}(v[u],G),U+=w,U=Object(E.c)(U,u,j,B)}function x(e){return function(t){var n={},i=e,r=Array.isArray(i),a=0;for(i=r?i:i[Symbol.iterator]();;){var o;if(r){if(a>=i.length)break;o=i[a++]}else{if((a=i.next()).done)break;o=a.value}var s=o.getUniforms(t,n);Object.assign(n,s)}return n}}function C(e){var t={},n=e,i=Array.isArray(n),a=0;for(n=i?n:n[Symbol.iterator]();;){var o;if(i){if(a>=n.length)break;o=n[a++]}else{if((a=n.next()).done)break;o=a.value}var s=o,u=Object(r.a)(s);t[s]=u}return t}},342:function(e,t,n){"use strict";n(20),n(10),n(8),n(5),n(6),n(4),n(9),n(76);var i=n(350),r=n(377),a=function(){function e(){this.shaderModules={},this.defaultShaderModules=[]}var t=e.prototype;return t.setDefaultShaderModules=function(e){this.defaultShaderModules=this.resolveModules(e)},t.getDefaultShaderModules=function(){return this.defaultShaderModules},t.registerShaderModules=function(e,t){var n=(void 0===t?{}:t).ignoreMultipleRegistrations,i=void 0!==n&&n,r=e,a=Array.isArray(r),o=0;for(r=a?r:r[Symbol.iterator]();;){var s;if(a){if(o>=r.length)break;s=r[o++]}else{if((o=r.next()).done)break;s=o.value}var u=s;this._registerShaderModule(u,i)}},t.getShaderModule=function(e){if(e instanceof i.a)return e;if("string"!=typeof e)return this._registerShaderModule(e,!0);var t=this.shaderModules[e];return t||Object(r.a)(!1,"Unknown shader module "+e),t},t.resolveModules=function(e){var t=this;return e.map(function(e){return t.getShaderModule(e)})},t._registerShaderModule=function(e,t){if(void 0===t&&(t=!1),e instanceof i.a)return e;if(Object(r.a)(e.name,"shader module has no name"),this.shaderModules[e.name]&&!t)throw new Error("shader module "+e.name+" already registered");return(e=new i.a(e)).dependencies=this.resolveModules(e.dependencies),this.shaderModules[e.name]=e,this.shaderModules[e.name]},e}();n.d(t,"b",function(){return s}),n.d(t,"a",function(){return u});var o=new a;function s(e){return e=e.concat(o.defaultShaderModules),l(e=o.resolveModules(e))}function u(e){return o.getShaderModule(e)}function l(e){var t={},n={};return f({modules:e,level:0,moduleMap:t,moduleDepth:n}),Object.keys(n).sort(function(e,t){return n[t]-n[e]}).map(function(e){return t[e]})}function f(e){var t=e.modules,n=e.level,i=e.moduleMap,r=e.moduleDepth;if(n>=5)throw new Error("Possible loop in shader dependency graph");var a=t,o=Array.isArray(a),s=0;for(a=o?a:a[Symbol.iterator]();;){var u;if(o){if(s>=a.length)break;u=a[s++]}else{if((s=a.next()).done)break;u=s.value}var l=u;i[l.name]=l,(void 0===r[l.name]||r[l.name]<n)&&(r[l.name]=n)}var c=t,d=Array.isArray(c),h=0;for(c=d?c:c[Symbol.iterator]();;){var p;if(d){if(h>=c.length)break;p=c[h++]}else{if((h=c.next()).done)break;p=h.value}var m=p;m.dependencies&&f({modules:m.dependencies,level:n+1,moduleMap:i,moduleDepth:r})}}},343:function(e,t,n){"use strict";n.d(t,"a",function(){return s});n(3),n(32),n(4),n(20);var i=n(363),r=n(586),a=n(511),o=n(429),s=function(){function e(e){void 0===e&&(e={});var t=e.id;this.id=t||Object(a.c)(this.constructor.name),this.display=!0,this.position=new i.a,this.rotation=new i.a,this.scale=new i.a(1,1,1),this.matrix=new r.a,this.userData={},this.props={},this._setScenegraphNodeProps(e)}var t=e.prototype;return t.delete=function(){},t.setProps=function(e){return this._setScenegraphNodeProps(e),this},t.toString=function(){return"{type: ScenegraphNode, id: "+this.id+")}"},t.setPosition=function(e){return Object(o.a)(3===e.length,"setPosition requires vector argument"),this.position=e,this},t.setRotation=function(e){return Object(o.a)(3===e.length,"setRotation requires vector argument"),this.rotation=e,this},t.setScale=function(e){return Object(o.a)(3===e.length,"setScale requires vector argument"),this.scale=e,this},t.setMatrix=function(e,t){void 0===t&&(t=!0),t?this.matrix.copy(e):this.matrix=e},t.setMatrixComponents=function(e){var t=e.position,n=e.rotation,i=e.scale,r=e.update,a=void 0===r||r;return t&&this.setPosition(t),n&&this.setRotation(n),i&&this.setScale(i),a&&this.updateMatrix(),this},t.updateMatrix=function(){var e=this.position,t=this.rotation,n=this.scale;return this.matrix.identity(),this.matrix.translate(e),this.matrix.rotateXYZ(t),this.matrix.scale(n),this},t.update=function(e){var t=void 0===e?{}:e,n=t.position,i=t.rotation,r=t.scale;return n&&this.setPosition(n),i&&this.setRotation(i),r&&this.setScale(r),this.updateMatrix(),this},t.getCoordinateUniforms=function(e,t){Object(o.a)(e),t=t||this.matrix;var n=new r.a(e).multiplyRight(t),i=n.invert(),a=i.transpose();return{viewMatrix:e,modelMatrix:t,objectMatrix:t,worldMatrix:n,worldInverseMatrix:i,worldInverseTransposeMatrix:a}},t._setScenegraphNodeProps=function(e){"display"in e&&(this.display=e.display),"position"in e&&this.setPosition(e.position),"rotation"in e&&this.setRotation(e.rotation),"scale"in e&&this.setScale(e.scale),"matrix"in e&&this.setMatrix(e.matrix),Object.assign(this.props,e)},e}()},349:function(e,t,n){"use strict";n(20),n(135),n(316),n(3);var i=n(318),r=n.n(i),a=n(347),o=n(409),s=(n(330),n(321),n(429)),u={POSITION:"positions",NORMAL:"normals",COLOR_0:"colors",TEXCOORD_0:"texCoords",TEXCOORD_1:"texCoords1",TEXCOORD_2:"texCoords2"};function l(e,t){var n=(t||{}).attributeMap,i=void 0===n?u:n;return i&&i[e]||e}function f(e,t){var n;switch(e){case"texCoords":case"texCoord1":case"texCoord2":case"texCoord3":n="uvs";break;case"vertices":case"positions":case"normals":case"pickingColors":n="vectors"}switch(n){case"vectors":t.size=t.size||3;break;case"uvs":t.size=t.size||2}Object(s.a)(Number.isFinite(t.size),"attribute "+e+" needs size")}n(5),n(6),n(4),n(9),n(10),n(8),n(76),n(12),n(28),n(186);var c=n(341),d=n(569),h=function(){function e(e){this.gl=e,this._programCache={},this._getUniforms={},this._registeredModules={},this._moduleInjections={vs:{},fs:{}},this._hookFunctions={vs:{},fs:{}},this._defaultModules=[],this._hashes={},this._hashCounter=0,this.stateHash=0,this._useCounts={}}e.getDefaultProgramManager=function(t){return t.luma=t.luma||{},t.luma.defaultProgramManager=t.luma.defaultProgramManager||new e(t),t.luma.defaultProgramManager};var t=e.prototype;return t.addDefaultModule=function(e){this._defaultModules.find(function(t){return t.name===e.name})||this._defaultModules.push(e),this.stateHash++},t.removeDefaultModule=function(e){var t="string"==typeof e?e:e.name;this._defaultModules=this._defaultModules.filter(function(e){return e.name!==t}),this.stateHash++},t.addModuleInjection=function(e,t){var n="string"==typeof e?e:e.name,i=t.hook,r=t.injection,a=t.order,o=void 0===a?0:a,s=i.slice(0,2),u=this._moduleInjections[s];u[n]=u[n]||{},u[n][i]={injection:r,order:o},this.stateHash++},t.addShaderHook=function(e,t){void 0===t&&(t={});var n=(e=e.trim()).split(":"),i=n[0],r=n[1],a=e.replace(/\(.+/,"");this._hookFunctions[i][a]=Object.assign(t,{signature:r}),this.stateHash++},t.get=function(e){var t=this;void 0===e&&(e={});var n=e,i=n.vs,r=void 0===i?"":i,a=n.fs,o=void 0===a?"":a,s=n.defines,u=void 0===s?{}:s,l=n.inject,f=void 0===l?{}:l,h=n.varyings,p=void 0===h?[]:h,m=n.bufferMode,g=void 0===m?35981:m,v=this._getModuleList(e.modules),_=this._getHash(r),b=this._getHash(o),E=v.map(function(e){return t._getHash("string"==typeof e?e:e.name)}).sort(),A=p.map(function(e){return t._getHash(e)}),y=Object.keys(u).sort(),S=Object.keys(f).sort(),L=[],T=y,M=Array.isArray(T),O=0;for(T=M?T:T[Symbol.iterator]();;){var R;if(M){if(O>=T.length)break;R=T[O++]}else{if((O=T.next()).done)break;R=O.value}var I=R;L.push(this._getHash(I)),L.push(this._getHash(u[I]))}var x=S,C=Array.isArray(x),P=0;for(x=C?x:x[Symbol.iterator]();;){var D;if(C){if(P>=x.length)break;D=x[P++]}else{if((P=x.next()).done)break;D=P.value}var N=D;L.push(this._getHash(N)),L.push(this._getHash(f[N]))}var w=_+"/"+b+"D"+L.join("/")+"M"+E.join("/")+"I"+[].join("/")+"V"+A.join("/")+"H"+this.stateHash+"B"+g;if(!this._programCache[w]){var F=Object(c.a)(this.gl,{vs:r,fs:o,modules:v,inject:f,defines:u,hookFunctions:this._hookFunctions,moduleInjections:this._moduleInjections});this._programCache[w]=new d.a(this.gl,{hash:w,vs:F.vs,fs:F.fs,varyings:p,bufferMode:g}),this._getUniforms[w]=F.getUniforms||function(e){},this._useCounts[w]=0}return this._useCounts[w]++,this._programCache[w]},t.getUniforms=function(e){return this._getUniforms[e.hash]||null},t.release=function(e){var t=e.hash;this._useCounts[t]--,0===this._useCounts[t]&&(this._programCache[t].delete(),delete this._programCache[t],delete this._getUniforms[t],delete this._useCounts[t])},t._getHash=function(e){return void 0===this._hashes[e]&&(this._hashes[e]=this._hashCounter++),this._hashes[e]},t._getModuleList=function(e){void 0===e&&(e=[]);for(var t=new Array(this._defaultModules.length+e.length),n={},i=0,r=0,a=this._defaultModules.length;r<a;++r){var o=this._defaultModules[r],s="string"==typeof o?o:o.name;t[i++]=o,n[s]=!0}for(var u=0,l=e.length;u<l;++u){var f=e[u],c="string"==typeof f?f:f.name;n[c]||(t[i++]=f,n[c]=!0)}return t.length=i,t},e}(),p=n(510),m=n(435),g=n(515),v=n(574),_=n(353),b=n(512),E=n(355);function A(e,t){void 0===t&&(t={});var n=t.isInteger,i=void 0!==n&&n;if(Array.isArray(e)||ArrayBuffer.isView(e))return function(e,t){for(var n=t.maxElts,i=void 0===n?16:n,r=t.size,a=void 0===r?1:r,o="[",s=0;s<e.length&&s<i;++s)s>0&&(o+=","+(s%a==0?" ":"")),o+=A(e[s],t);return o+(e.length>i?"...":"]")}(e,t);if(!Number.isFinite(e))return String(e);if(Math.abs(e)<1e-16)return i?"0":"0.";if(i)return e.toFixed(0);if(Math.abs(e)>100&&Math.abs(e)<1e4)return e.toFixed(0);var r=e.toPrecision(2);return r.indexOf(".0")===r.length-2?r.slice(0,-1):r}function y(e,t,n,i){var r,o,s=e.gl;if(!t)return(o={})[i]="null",o["Format "]="N/A",o;var u,l,f,c="NOT PROVIDED",d="N/A",h="N/A",p="N/A";if(n&&(c=n.type,d=n.size,u=-1!==(c=String(c).replace("Array","")).indexOf("nt")),t instanceof a.a){var m,g,v=t,_=v.getDebugData(),E=_.data;if(l=_.modified?"*":"",f=E,h=(p=v.byteLength)/E.BYTES_PER_ELEMENT/d,n)g=(n.divisor>0?"I ":"P ")+" "+h+" (x"+d+"="+p+" bytes "+Object(b.a)(s,c)+")";else u=!0,g=p+" bytes";return(m={})[i]=""+l+A(f,{size:d,isInteger:u}),m["Format "]=g,m}return f=t,d=t.length,u=-1!==(c=String(t.constructor.name).replace("Array","")).indexOf("nt"),(r={})[i]=A(f,{size:d,isInteger:u})+" (constant)",r["Format "]=d+"x"+c+" (constant)",r}function S(e,t){var n=t.type,i=t.size,r=Object(E.b)(n,i);return r?e+" ("+r.name+")":e}n(63);function L(e){var t=void 0===e?{}:e,n=t.header,i=void 0===n?"Uniforms":n,r=t.program,a=t.uniforms,o=t.undefinedOnly,u=void 0!==o&&o;Object(s.a)(r);var l=r._uniformSetters,f={},c=Object.keys(l).sort(),d=0,h=c,p=Array.isArray(h),m=0;for(h=p?h:h[Symbol.iterator]();;){var g;if(p){if(m>=h.length)break;g=h[m++]}else{if((m=h.next()).done)break;g=m.value}var v=g;v.match(".*_.*")||v.match(".*Matrix")||T({table:f,header:i,uniforms:a,uniformName:v,undefinedOnly:u})&&d++}var _=c,b=Array.isArray(_),E=0;for(_=b?_:_[Symbol.iterator]();;){var y;if(b){if(E>=_.length)break;y=_[E++]}else{if((E=_.next()).done)break;y=E.value}var S=y;S.match(".*Matrix")&&T({table:f,header:i,uniforms:a,uniformName:S,undefinedOnly:u})&&d++}var L=c,M=Array.isArray(L),O=0;for(L=M?L:L[Symbol.iterator]();;){var R;if(M){if(O>=L.length)break;R=L[O++]}else{if((O=L.next()).done)break;R=O.value}f[R]||T({table:f,header:i,uniforms:a,uniformName:R,undefinedOnly:u})&&d++}var I=0,x={};if(!u)for(var C in a){var P,D=a[C];if(!f[C])I++,x[C]=((P={Type:"NOT USED: "+D})[i]=A(D),P)}return{table:f,count:d,unusedTable:x,unusedCount:I}}function T(e){var t,n=e.table,i=e.header,r=e.uniforms,a=e.uniformName,o=e.undefinedOnly,s=r[a],u=function(e){return null!=e}(s);return(!o||!u)&&(n[a]=((t={})[i]=u?A(s):"N/A",t["Uniform Type"]=u?s:"NOT PROVIDED",t),!0)}function M(e){var t=e.accessor,n=t.type,i=t.size,r=Object(E.b)(n,i);return r?r.name+" "+e.name:e.name}n(56),n(101);var O=n(337),R=n.n(O),I=n(376),x={},C=function e(t,n,i){t&&(n.length>1?e(t[n[0]],n.slice(1),i):t[n[0]]=i)},P=new Map;R.a.listenFor("luma.gl",function(e){var t=x[e.itemKey];if(t&&"edit"===e.type&&"uniforms"===e.valuePath[0]){var n=e.valuePath.slice(1);!function(e,t,n){I.b.__SEER_INITIALIZED__&&(P.has(e)||P.set(e,new Map),P.get(e).set(t,n))}(e.itemKey,n,e.value);var i=t.getUniforms();C(i,n,e.value),t.setUniforms(i)}});var D=n(511),N=n(385),w=function(){function e(e,t){void 0===t&&(t={}),Object(s.a)(Object(p.c)(e));var n=t.id,i=void 0===n?Object(D.c)("base-model"):n;this.id=i,this.gl=e,this.id=t.id||Object(D.c)("Model"),this.lastLogTime=0,this.initialize(t)}var t=e.prototype;return t.initialize=function(e){this.props={},e.shaderCache&&N.a.warn("ShaderCache property is deprecated")(),this.programManager=e.programManager||h.getDefaultProgramManager(this.gl),this._programManagerState=-1,this._managedProgram=!1;var t=e.program,n=void 0===t?null:t,i=e.vs,r=e.fs,a=e.modules,o=e.defines,s=e.inject,u=e.varyings,l=e.bufferMode;this.programProps={program:n,vs:i,fs:r,modules:a,defines:o,inject:s,varyings:u,bufferMode:l},this.program=null,this.vertexArray=null,this._programDirty=!0,this.userData={},this.needsRedraw=!0,this._attributes={},this.attributes={},this.uniforms={},this.animatedUniforms={},this.animated=!1,this.animationLoop=null,this.timerQueryEnabled=!1,this.timeElapsedQuery=void 0,this.lastQueryReturned=!0,this.stats={accumulatedFrameTime:0,averageFrameTime:0,profileFrameCount:0},this.pickable=!0,this._checkProgram(),this._setBaseModelProps(e),this.setUniforms(Object.assign({},this.getModuleUniforms(e.moduleSettings)))},t.setProps=function(e){this._setBaseModelProps(e)},t.delete=function(){for(var e in this._attributes)this._attributes[e]!==this.attributes[e]&&this._attributes[e].delete();var t;this._managedProgram&&this.programManager.release(this.program),this.vertexArray.delete(),t=this.id,delete x[t],R.a.deleteItem("luma.gl",t)},t.isAnimated=function(){return this.animated},t.getProgram=function(){return this.program},t.setProgram=function(e){this.programProps=Object.assign({},e),this._programDirty=!0},t.getUniforms=function(){return this.uniforms},t.setUniforms=function(e){return void 0===e&&(e={}),e=Object.assign({},e),function(e,t){if(I.b.__SEER_INITIALIZED__&&e){var n=P.get(e);n&&n.forEach(function(e,n){C(t,n,e)})}}(this.id,e),e=this._extractAnimatedUniforms(e),Object.assign(this.uniforms,e),this},t.getModuleUniforms=function(e){this._checkProgram();var t=this.programManager.getUniforms(this.program);return t?t(e):{}},t.updateModuleSettings=function(e){var t=this.getModuleUniforms(e||{});return this.setUniforms(t)},t.clear=function(e){return Object(m.a)(this.program.gl,e),this},t.drawGeometry=function(e){void 0===e&&(e={}),this._checkProgram();var t,n=e,i=n.moduleSettings,r=void 0===i?null:i,a=n.framebuffer,o=n.uniforms,s=void 0===o?{}:o,u=n.attributes,l=void 0===u?{}:u,f=n.transformFeedback,c=void 0===f?this.transformFeedback:f,d=n.parameters,h=void 0===d?{}:d,p=n.vertexArray,m=void 0===p?this.vertexArray:p,g=n.animationProps;x[(t=this).id]||(x[t.id]=t,R.a.listItem("luma.gl",t.id)),this.setAttributes(l),this.updateModuleSettings(r),this.setUniforms(s),this._refreshAnimationProps(g);var v=this._logDrawCallStart(2),_=this.vertexArray.getDrawParams(this.props);_.isInstanced&&!this.isInstanced&&N.a.warn("Found instanced attributes on non-instanced model",this.id)();var b=_.isIndexed,E=_.indexType,A=_.indexOffset,y=this.isInstanced,S=this.instanceCount,L=function(){},T=this.props,M=T.onBeforeRender,O=void 0===M?L:M,I=T.onAfterRender,C=void 0===I?L:I;O(),this._timerQueryStart(),this.program.setUniforms(this.uniforms);var P=this.program.draw(Object.assign({},e,{logPriority:v,uniforms:null,framebuffer:a,parameters:h,drawMode:this.getDrawMode(),vertexCount:this.getVertexCount(),vertexArray:m,transformFeedback:c,isIndexed:b,indexType:E,isInstanced:y,instanceCount:S,offset:b?A:0}));return this._timerQueryEnd(),C(),this._logDrawCallEnd(v,m,a),P},t._setBaseModelProps=function(e){Object.assign(this.props,e),"uniforms"in e&&this.setUniforms(e.uniforms),"pickable"in e&&(this.pickable=e.pickable),"timerQueryEnabled"in e&&(this.timerQueryEnabled=e.timerQueryEnabled&&g.a.isSupported(this.gl,["timers"]),e.timerQueryEnabled&&!this.timerQueryEnabled&&N.a.warn("GPU timer not supported")()),"_animationProps"in e&&this._setAnimationProps(e._animationProps),"_animationLoop"in e&&(this.animationLoop=e._animationLoop)},t._checkProgram=function(e){if(void 0===e&&(e=null),this._programDirty||this.programManager.stateHash!==this._programManagerState){var t=this.programProps.program;if(t)this._managedProgram=!1;else{var n=this.programProps,i=n.vs,r=void 0===i?_.a.vs:i,a=n.fs,o=void 0===a?_.a.fs:a,u=n.modules,l=n.inject,f=n.defines,c=n.varyings,h=n.bufferMode;t=this.programManager.get({vs:r,fs:o,modules:u,inject:l,defines:f,varyings:c,bufferMode:h}),this.program&&this._managedProgram&&this.programManager.release(this.program),this._programManagerState=this.programManager.stateHash,this._managedProgram=!0}Object(s.a)(t instanceof d.a,"Model needs a program"),this._programDirty=!1,t!==this.program&&(this.program=t,this.vertexArray?this.vertexArray.setProps({program:this.program,attributes:this.vertexArray.attributes}):this.vertexArray=new v.a(this.gl,{program:this.program}),this.setUniforms(Object.assign({},this.getModuleUniforms())))}},t._refreshAnimationProps=function(e){(e=e||this.animationLoop&&this.animationLoop.animationProps)&&this._setAnimationProps(e)},t._evaluateAnimateUniforms=function(e){if(!this.animated)return{};var t={};for(var n in this.animatedUniforms){var i=this.animatedUniforms[n];t[n]=i(e)}return t},t._extractAnimatedUniforms=function(e){var t=!1;for(var n in e){var i=e[n];"function"==typeof i?(this.animatedUniforms[n]=i,t=!0):delete this.animatedUniforms[n]}if(this.animated=!Object(D.a)(this.animatedUniforms),!t)return e;var r={};for(var a in e)this.animatedUniforms[a]||(r[a]=e[a]);return r},t._timerQueryStart=function(){!0===this.timerQueryEnabled&&(this.timeElapsedQuery||(this.timeElapsedQuery=new g.a(this.gl)),this.lastQueryReturned&&(this.lastQueryReturned=!1,this.timeElapsedQuery.beginTimeElapsedQuery()))},t._timerQueryEnd=function(){if(!0===this.timerQueryEnabled&&(this.timeElapsedQuery.end(),this.timeElapsedQuery.isResultAvailable())){this.lastQueryReturned=!0;var e=this.timeElapsedQuery.getTimerMilliseconds();this.stats.lastFrameTime=e,this.stats.accumulatedFrameTime+=e,this.stats.profileFrameCount++,this.stats.averageFrameTime=this.stats.accumulatedFrameTime/this.stats.profileFrameCount,N.a.log(2,"GPU time "+this.program.id+": "+this.stats.lastFrameTime+"ms average "+this.stats.averageFrameTime+"ms accumulated: "+this.stats.accumulatedFrameTime+"ms count: "+this.stats.profileFrameCount)()}},t._logDrawCallStart=function(e){var t=e>3?0:1e4;if(!(N.a.priority<e||Date.now()-this.lastLogTime<t))return this.lastLogTime=Date.now(),N.a.group(2,">>> DRAWING MODEL "+this.id,{collapsed:N.a.priority<=2})(),e},t._logDrawCallEnd=function(e,t,n,i){if(void 0!==e){var r=function(e){var t=void 0===e?{}:e,n=t.vertexArray,i=t.header,r=void 0===i?"Attributes":i;if(!n.configuration)return{};var a={};n.elements&&(a.ELEMENT_ARRAY_BUFFER=y(n,n.elements,null,r));var o=n.values;for(var s in o){var u=n._getAttributeInfo(s);if(u){var l=s+": "+u.name,f=n.accessors[u.location];f&&(l=s+": "+S(u.name,f)),a[l]=y(n,o[s],f,r)}}return a}({vertexArray:t,header:this.id+" attributes",attributes:this._attributes}),a=L({header:this.id+" uniforms",program:this.program,uniforms:Object.assign({},this.program.uniforms,n)}),o=a.table,s=a.unusedTable,u=a.unusedCount,l=L({header:this.id+" uniforms",program:this.program,uniforms:Object.assign({},this.program.uniforms,n),undefinedOnly:!0}),f=l.table;l.count>0&&N.a.log("MISSING UNIFORMS",Object.keys(f))(),u>0&&N.a.log("UNUSED UNIFORMS",Object.keys(s))();var c=function(e){var t={},n="Accessors for "+e.id,i=e.attributeInfos,r=Array.isArray(i),a=0;for(i=r?i:i[Symbol.iterator]();;){var o;if(r){if(a>=i.length)break;o=i[a++]}else{if((a=i.next()).done)break;o=a.value}var s,u=o;u&&(t["in "+M(u)]=((s={})[n]=JSON.stringify(u.accessor),s))}var l=e.varyingInfos,f=Array.isArray(l),c=0;for(l=f?l:l[Symbol.iterator]();;){var d;if(f){if(c>=l.length)break;d=l[c++]}else{if((c=l.next()).done)break;d=c.value}var h,p=d;p&&(t["out "+M(p)]=((h={})[n]=JSON.stringify(p.accessor),h))}return t}(this.vertexArray.configuration);N.a.table(e,r)(),N.a.table(e,o)(),N.a.table(e+1,c)(),function(e,t){if(R.a.isReady()&&!R.a.throttle("luma.gl:"+e.id,1e3)){var n=e.geometry?Object.assign({},e.geometry.attributes,e.attributes):e.attributes,i=Object.assign({},e.uniforms,t);R.a.multiUpdate("luma.gl",e.id,[{path:"objects.uniforms",data:i},{path:"objects.attributes",data:n}])}}(this,n),i&&i.log({priority:2,message:"Rendered to "+i.id}),N.a.groupEnd(2,">>> DRAWING MODEL "+this.id)()}},e}();n.d(t,"a",function(){return F});var F=function(e){var t,n;function i(t,n){void 0===n&&(n={});var i=n.id,r=void 0===i?Object(D.c)("model"):i;return e.call(this,t,Object.assign({},n,{id:r}))||this}n=e,(t=i).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n;var u=i.prototype;return u.initialize=function(t){e.prototype.initialize.call(this,t),this.drawMode=void 0!==t.drawMode?t.drawMode:r.a.TRIANGLES,this.vertexCount=t.vertexCount||0,this.geometryBuffers={},this.isInstanced=t.isInstanced||t.instanced,this._setModelProps(t),this.geometry={},Object(s.a)(void 0!==this.drawMode&&Number.isFinite(this.vertexCount),"Model needs drawMode and vertexCount")},u.setProps=function(t){e.prototype.setProps.call(this,t),this._setModelProps(t)},u.delete=function(){e.prototype.delete.call(this),this._deleteGeometryBuffers()},u.getDrawMode=function(){return this.drawMode},u.getVertexCount=function(){return this.vertexCount},u.getInstanceCount=function(){return this.instanceCount},u.getAttributes=function(){return this.attributes},u.setDrawMode=function(e){return this.drawMode=e,this},u.setVertexCount=function(e){return Object(s.a)(Number.isFinite(e)),this.vertexCount=e,this},u.setInstanceCount=function(e){return Object(s.a)(Number.isFinite(e)),this.instanceCount=e,this},u.setGeometry=function(e){return this.drawMode=e.drawMode,this.vertexCount=e.getVertexCount(),this._deleteGeometryBuffers(),this.geometryBuffers=function(e,t,n){var i={},o=t.indices;for(var u in t.attributes){var c=t.attributes[u],d=l(u,n);if("indices"===u)o=c;else if(c.constant)i[d]=c.value;else{var h=c.value,p=Object.assign({},c);delete p.value,i[d]=[new a.a(e,h),p],f(u,p)}}if(o){var m=o.value||o;Object(s.a)(m instanceof Uint16Array||m instanceof Uint32Array,'attribute array for "indices" must be of integer type');var g={size:1,isIndexed:void 0===o.isIndexed||o.isIndexed};i.indices=[new a.a(e,{data:m,target:r.a.ELEMENT_ARRAY_BUFFER}),g]}return i}(this.gl,e),this.vertexArray.setAttributes(this.geometryBuffers),this},u.setAttributes=function(e){if(void 0===e&&(e={}),Object(D.a)(e))return this;var t={};for(var n in e){var i=e[n];t[n]=i.getValue?i.getValue():i}return this.vertexArray.setAttributes(t),this},u.draw=function(e){return void 0===e&&(e={}),this.drawGeometry(e)},u.transform=function(e){void 0===e&&(e={});var t,n=e,i=n.discard,a=void 0===i||i,o=n.feedbackBuffers,s=n.unbindModels,u=void 0===s?[]:s,l=e.parameters;(o&&this._setFeedbackBuffers(o),a)&&(l=Object.assign({},l,((t={})[r.a.RASTERIZER_DISCARD]=a,t)));u.forEach(function(e){return e.vertexArray.unbindBuffers()});try{this.draw(Object.assign({},e,{parameters:l}))}finally{u.forEach(function(e){return e.vertexArray.bindBuffers()})}return this},u.render=function(e){return void 0===e&&(e={}),N.a.warn("Model.render() is deprecated. Use Model.setUniforms() and Model.draw()")(),this.setUniforms(e).draw()},u._setModelProps=function(e){"instanceCount"in e&&(this.instanceCount=e.instanceCount),"geometry"in e&&this.setGeometry(e.geometry),"attributes"in e&&this.setAttributes(e.attributes),"_feedbackBuffers"in e&&this._setFeedbackBuffers(e._feedbackBuffers)},u._deleteGeometryBuffers=function(){for(var e in this.geometryBuffers){var t=this.geometryBuffers[e][0]||this.geometryBuffers[e];t instanceof a.a&&t.delete()}},u._setAnimationProps=function(e){if(this.animated){Object(s.a)(e,"Model.draw(): animated uniforms but no animationProps");var t=this._evaluateAnimateUniforms(e);Object.assign(this.uniforms,t)}},u._setFeedbackBuffers=function(e){if(void 0===e&&(e={}),Object(D.a)(e))return this;var t=this.program.gl;return this.transformFeedback=this.transformFeedback||new o.a(t,{program:this.program}),this.transformFeedback.setBuffers(e),this},i}(w)},350:function(e,t,n){"use strict";n(139),n(20),n(12);function i(e,t,n){switch(t){case 300:return n?function(e){return e.replace(/attribute\s+/g,"in ").replace(/varying\s+/g,"out ").replace(/texture2D\(/g,"texture(").replace(/textureCube\(+/g,"texture(").replace(/texture2DLodEXT\(/g,"textureLod(").replace(/textureCubeLodEXT\(/g,"textureLod(")}(e):function(e){return e.replace(/varying\s+/g,"in ").replace(/texture2D\(/g,"texture(").replace(/textureCube\(/g,"texture(").replace(/texture2DLodEXT\(/g,"textureLod(").replace(/textureCubeLodEXT\(/g,"textureLod(")}(e);case 100:return n?function(e){return e.replace(/^in\s+/gm,"attribute ").replace(/^out\s+/gm,"varying ").replace(/texture\(/g,"texture2D(")}(e):function(e){return e.replace(/^in\s+/gm,"varying ").replace(/texture\(/g,"texture2D(")}(e);default:throw new Error("unknown GLSL version "+t)}}var r=n(377),a=(n(3),n(135),n(316),{number:{validate:function(e,t){return Number.isFinite(e)&&(!("max"in t)||e<=t.max)&&(!("min"in t)||e>=t.min)}},array:{validate:function(e,t){return Array.isArray(e)||ArrayBuffer.isView(e)}}});function o(e){var t=s(e);return"object"===t?e?"type"in e?Object.assign({},e,a[e.type]):"value"in e?(t=s(e.value),Object.assign({type:t},e,a[t])):{type:"object",value:e}:{type:"object",value:null}:Object.assign({type:t,value:e},a[t])}function s(e){return Array.isArray(e)||ArrayBuffer.isView(e)?"array":typeof e}n.d(t,"a",function(){return u});var u=function(){function e(e){var t=e.name,n=e.vs,i=e.fs,a=e.dependencies,s=void 0===a?[]:a,u=e.uniforms,l=e.getUniforms,f=e.deprecations,c=void 0===f?[]:f,d=e.defines,h=void 0===d?{}:d,p=e.vertexShader,m=e.fragmentShader;Object(r.a)("string"==typeof t),this.name=t,this.vs=n||p,this.fs=i||m,this.getModuleUniforms=l,this.dependencies=s,this.deprecations=this._parseDeprecationDefinitions(c),this.defines=h,u&&(this.uniforms=function(e){var t={};for(var n in e){var i=o(e[n]);t[n]=i}return t}(u))}var t=e.prototype;return t.getModuleSource=function(e,t){var n;switch(e){case"vs":n=i(this.vs||"",t,!0);break;case"fs":n=i(this.fs||"",t,!1);break;default:Object(r.a)(!1)}return"#define MODULE_"+this.name.toUpperCase()+"\n"+n+"// END MODULE_"+this.name+"\n\n"},t.getUniforms=function(e,t){return this.getModuleUniforms?this.getModuleUniforms(e,t):this.uniforms?this._defaultGetUniforms(e):{}},t.getDefines=function(){return this.defines},t.checkDeprecations=function(e,t){this.deprecations.forEach(function(n){n.regex.test(e)&&(n.deprecated?t.deprecated(n.old,n.new)():t.removed(n.old,n.new)())})},t._parseDeprecationDefinitions=function(e){return e.forEach(function(e){switch(e.type){case"function":e.regex=new RegExp("\\b"+e.old+"\\(");break;default:e.regex=new RegExp(e.type+" "+e.old+";")}}),e},t._defaultGetUniforms=function(e){void 0===e&&(e={});var t={},n=this.uniforms;for(var i in n){var a=n[i];i in e&&!a.private?(a.validate&&Object(r.a)(a.validate(e[i],a),this.name+": invalid "+i),t[i]=e[i]):t[i]=a.value}return t},e}()},351:function(e,t,n){"use strict";n(12),n(76);var i,r=n(359),a=n(377);n.d(t,"a",function(){return s}),n.d(t,"c",function(){return c}),n.d(t,"b",function(){return d});var o=((i={})[r.b]="#ifdef MODULE_LOGDEPTH\n  logdepth_adjustPosition(gl_Position);\n#endif\n",i[r.a]="#ifdef MODULE_MATERIAL\n  gl_FragColor = material_filterColor(gl_FragColor);\n#endif\n\n#ifdef MODULE_LIGHTING\n  gl_FragColor = lighting_filterColor(gl_FragColor);\n#endif\n\n#ifdef MODULE_FOG\n  gl_FragColor = fog_filterColor(gl_FragColor);\n#endif\n\n#ifdef MODULE_PICKING\n  gl_FragColor = picking_filterHighlightColor(gl_FragColor);\n  gl_FragColor = picking_filterPickingColor(gl_FragColor);\n#endif\n\n#ifdef MODULE_LOGDEPTH\n  logdepth_setFragDepth();\n#endif\n",i),s="__LUMA_INJECT_DECLARATIONS__",u=/void main\s*\([^)]*\)\s*\{\n?/,l=/}\n?[^{}]*$/,f=[];function c(e,t,n,i){var a=t===r.b,c=function(t){var i=n[t];i.sort(function(e,t){return e.order-t.order}),f.length=i.length;for(var r=0,o=i.length;r<o;++r)f[r]=i[r].injection;var c=f.join("\n")+"\n";switch(t){case"vs:#decl":a&&(e=e.replace(s,c));break;case"vs:#main-start":a&&(e=e.replace(u,function(e){return e+c}));break;case"vs:#main-end":a&&(e=e.replace(l,function(e){return c+e}));break;case"fs:#decl":a||(e=e.replace(s,c));break;case"fs:#main-start":a||(e=e.replace(u,function(e){return e+c}));break;case"fs:#main-end":a||(e=e.replace(l,function(e){return c+e}));break;default:e=e.replace(t,function(e){return e+c})}};for(var d in n)c(d);return e=e.replace(s,""),i&&(e=e.replace(/\}\s*$/,function(e){return e+o[t]})),e}function d(e){var t={};return Object(a.a)(Array.isArray(e)&&e.length>1),e.forEach(function(e){for(var n in e)t[n]=t[n]?t[n]+"\n"+e[n]:e[n]}),t}},353:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var i={vs:"#define SHADER_NAME luma_modular_vertex\n\n// object attributes\nattribute vec3 positions;\nattribute vec3 normals;\nattribute vec4 colors;\nattribute vec2 texCoords;\nattribute vec3 pickingColors;\n\nvoid main(void) {\n\n  // Set up position\n#ifdef MODULE_GEOMETRY\n  geometry_setPosition(positions);\n  geometry_setNormal(normals);\n#endif\n\n#ifdef MODULE_PROJECT\n  project_setPositionAndNormal_Model(positions, normals);\n  gl_Position = project_model_to_clipspace(positions);\n#endif\n\n  // Set up depth\n#ifdef MODULE_LOGDEPTH\n  logdepth_adjustPosition(gl_Position);\n#endif\n\n#ifdef MODULE_DIFFUSE\n  diffuse_setTextureCoordinate(texCoords);\n#endif\n\n  // Set up color calculations\n#ifdef MODULE_MATERIAL\n  material_setDiffuseColor(colors);\n  material_setDiffuseTextureCoordinates(texCoords);\n#endif\n\n#ifdef MODULE_LIGHTING\n  lighting_setPositionAndNormal(positions, normals);\n  lighting_apply_light(positions);\n  lighting_apply_reflection(positions);\n#endif\n\n#ifdef MODULE_PICKING\n  picking_setPickingColor(pickingColors);\n#endif\n\n}\n",fs:"#define SHADER_NAME luma-modular-fragment\n\nprecision highp float;\n\n// varyings\nvarying vec4 vColor;\n\nvoid main(){\n  gl_FragColor = vec4(1., 0., 1., 1.);\n\n#ifdef MODULE_DIFFUSE\n  gl_FragColor = diffuse_filterColor(gl_FragColor);\n#endif\n\n#ifdef MODULE_MATERIAL\n  gl_FragColor = material_filterColor(gl_FragColor);\n#endif\n\n#ifdef MODULE_LIGHTING\n  gl_FragColor = lighting_filterColor(gl_FragColor);\n#endif\n\n#ifdef MODULE_FOG\n  gl_FragColor = fog_filterColor(gl_FragColor);\n#endif\n\n#ifdef MODULE_PICKING\n  gl_FragColor = picking_filterHighlightColor(gl_FragColor);\n  gl_FragColor = picking_filterPickingColor(gl_FragColor);\n#endif\n\n#ifdef MODULE_LOGDEPTH\n  logdepth_setFragDepth(gl_Position);\n#endif\n}\n",uniforms:{}}},359:function(e,t,n){"use strict";n.d(t,"b",function(){return i}),n.d(t,"a",function(){return r});var i="vs",r="fs"},364:function(e,t,n){"use strict";n.d(t,"a",function(){return r});var i=n(349);var r=function(e){var t,n;function r(t,n){var r;return void 0===n&&(n={}),(r=e.call(this,n)||this).onBeforeRender=null,r.AfterRender=null,t instanceof i.a?(r.model=t,r._setModelNodeProps(n)):r.model=new i.a(t,n),r.managedResources=n.managedResources||[],r}n=e,(t=r).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n;var a=r.prototype;return a.setProps=function(t){return e.prototype.setProps.call(this,t),this._setModelNodeProps(t),this},a.delete=function(){this.model&&(this.model.delete(),this.model=null),this.managedResources.forEach(function(e){return e.delete()}),this.managedResources=[]},a.draw=function(){var e;return(e=this.model).draw.apply(e,arguments)},a.setUniforms=function(){var e;return(e=this.model).setUniforms.apply(e,arguments),this},a.setAttributes=function(){var e;return(e=this.model).setAttributes.apply(e,arguments),this},a.updateModuleSettings=function(){var e;return(e=this.model).updateModuleSettings.apply(e,arguments),this},a._setModelNodeProps=function(e){this.model.setProps(e)},r}(n(343).a)},377:function(e,t,n){"use strict";function i(e,t){if(!e)throw new Error(t||"shadertools: assertion failed.")}n.d(t,"a",function(){return i})},409:function(e,t,n){"use strict";n.d(t,"a",function(){return f});n(316),n(135),n(320);var i=n(318),r=n.n(i),a=n(344),o=n(347),s=n(510),u=n(511),l=n(385);var f=function(e){var t,n;function i(t,n){var i;return void 0===n&&(n={}),Object(s.a)(t),(i=e.call(this,t,n)||this).initialize(n),i.stubRemovedMethods("TransformFeedback","v6.0",["pause","resume"]),Object.seal(function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(i)),i}n=e,(t=i).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n,i.isSupported=function(e){return Object(s.d)(e)};var a=i.prototype;return a.initialize=function(e){var t=this;return void 0===e&&(e={}),this.buffers={},this.unused={},this.configuration=null,this.bindOnUse=!0,Object(u.a)(this.buffers)||this.bind(function(){return t._unbindBuffers()}),this.setProps(e),this},a.setProps=function(e){"program"in e&&(this.configuration=e.program&&e.program.configuration),"configuration"in e&&(this.configuration=e.configuration),"bindOnUse"in e&&(e=e.bindOnUse),"buffers"in e&&this.setBuffers(e.buffers)},a.setBuffers=function(e){var t=this;return void 0===e&&(e={}),this.bind(function(){for(var n in e)t.setBuffer(n,e[n])}),this},a.setBuffer=function(e,t){var n=this,i=this._getVaryingIndex(e),r=this._getBufferParams(t),a=r.buffer,o=r.byteSize,s=r.byteOffset;return i<0?(this.unused[e]=a,l.a.warn(function(){return n.id+" unused varying buffer "+e})(),this):(this.buffers[i]=t,this.bindOnUse||this._bindBuffer(i,a,s,o),this)},a.begin=function(e){return void 0===e&&(e=r.a.POINTS),this.gl.bindTransformFeedback(r.a.TRANSFORM_FEEDBACK,this.handle),this._bindBuffers(),this.gl.beginTransformFeedback(e),this},a.end=function(){return this.gl.endTransformFeedback(),this._unbindBuffers(),this.gl.bindTransformFeedback(r.a.TRANSFORM_FEEDBACK,null),this},a._getBufferParams=function(e){var t,n,i;return e instanceof o.a==!1?(i=e.buffer,n=e.byteSize,t=e.byteOffset):i=e,void 0===t&&void 0===n||(t=t||0,n=n||i.byteLength-t),{buffer:i,byteOffset:t,byteSize:n}},a._getVaryingInfo=function(e){return this.configuration&&this.configuration.getVaryingInfo(e)},a._getVaryingIndex=function(e){if(this.configuration)return this.configuration.getVaryingInfo(e).location;var t=Number(e);return Number.isFinite(t)?t:-1},a._bindBuffers=function(){if(this.bindOnUse)for(var e in this.buffers){var t=this._getBufferParams(this.buffers[e]),n=t.buffer,i=t.byteSize,r=t.byteOffset;this._bindBuffer(e,n,r,i)}},a._unbindBuffers=function(){if(this.bindOnUse)for(var e in this.buffers)this._bindBuffer(e,null)},a._bindBuffer=function(e,t,n,i){void 0===n&&(n=0);var a=t&&t.handle;return a&&void 0!==i?this.gl.bindBufferRange(r.a.TRANSFORM_FEEDBACK_BUFFER,e,a,n,i):this.gl.bindBufferBase(r.a.TRANSFORM_FEEDBACK_BUFFER,e,a),this},a._createHandle=function(){return this.gl.createTransformFeedback()},a._deleteHandle=function(){this.gl.deleteTransformFeedback(this.handle)},a._bindHandle=function(e){this.gl.bindTransformFeedback(r.a.TRANSFORM_FEEDBACK,this.handle)},i}(a.a)},440:function(e,t,n){"use strict";n.d(t,"a",function(){return a});n(10),n(8),n(373),n(135),n(5),n(6),n(4),n(56),n(101);var i=1,r=1,a=function(){function e(){this.time=0,this.channels=new Map,this.animations=new Map,this.playing=!1,this.lastEngineTime=-1}var t=e.prototype;return t.addChannel=function(e){var t=e.delay,n=void 0===t?0:t,r=e.duration,a=void 0===r?Number.POSITIVE_INFINITY:r,o=e.rate,s=void 0===o?1:o,u=e.repeat,l=i++,f={time:0,delay:n,duration:a,rate:s,repeat:void 0===u?1:u};return this._setChannelTime(f,this.time),this.channels.set(l,f),l},t.removeChannel=function(e){this.channels.delete(e);var t=this.animations,n=Array.isArray(t),i=0;for(t=n?t:t[Symbol.iterator]();;){var r;if(n){if(i>=t.length)break;r=t[i++]}else{if((i=t.next()).done)break;r=i.value}var a=r,o=a[0];a[1].channel===e&&this.detachAnimation(o)}},t.isFinished=function(e){var t=this.channels.get(e);return void 0!==t&&this.time>=t.delay+t.duration*t.repeat},t.getTime=function(e){if(void 0===e)return this.time;var t=this.channels.get(e);return void 0===t?-1:t.time},t.setTime=function(e){this.time=Math.max(0,e);var t=this.channels.values(),n=Array.isArray(t),i=0;for(t=n?t:t[Symbol.iterator]();;){var r;if(n){if(i>=t.length)break;r=t[i++]}else{if((i=t.next()).done)break;r=i.value}var a=r;this._setChannelTime(a,this.time)}var o=this.animations.values(),s=Array.isArray(o),u=0;for(o=s?o:o[Symbol.iterator]();;){var l;if(s){if(u>=o.length)break;l=o[u++]}else{if((u=o.next()).done)break;l=u.value}var f=l,c=f.animation,d=f.channel;c.setTime(this.getTime(d))}},t.play=function(){this.playing=!0},t.pause=function(){this.playing=!1,this.lastEngineTime=-1},t.reset=function(){this.setTime(0)},t.attachAnimation=function(e,t){var n=r++;return this.animations.set(n,{animation:e,channel:t}),e.setTime(this.getTime(t)),n},t.detachAnimation=function(e){this.animations.delete(e)},t.update=function(e){this.playing&&(-1===this.lastEngineTime&&(this.lastEngineTime=e),this.setTime(this.time+(e-this.lastEngineTime)),this.lastEngineTime=e)},t._setChannelTime=function(e,t){var n=t-e.delay;n>=e.duration*e.repeat?e.time=e.duration*e.rate:(e.time=Math.max(0,n)%e.duration,e.time*=e.rate)},e}()},475:function(e,t){},544:function(e,t){},545:function(e,t){},546:function(e,t){},552:function(e,t){},553:function(e,t){},556:function(e,t){},557:function(e,t){}}]);
//# sourceMappingURL=component---templates-core-example-gltf-jsx-f98ee2f8e85c15a11b7c.js.map