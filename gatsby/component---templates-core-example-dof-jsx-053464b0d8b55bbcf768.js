(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{282:function(e,t,n){"use strict";n.r(t);var r=n(0),i=n.n(r),o=n(318),a=(n(4),n(307),n(308)),s=n.n(a),u=n(324),f=n(337),d=n(330),c=n(433),l=n(398),p=(n(319),n(317),n(333)),h=n(386),m=5126,v=5124,E=5125,g=function(){function e(e){var t;for(var n in this.layout={},this.size=0,e)this._addUniform(n,e[n]);this.size+=(4-this.size%4)%4;var r=new Float32Array(this.size);this.typedArray=((t={})[m]=r,t[v]=new Int32Array(r.buffer),t[E]=new Uint32Array(r.buffer),t)}var t=e.prototype;return t.getBytes=function(){return 4*this.size},t.getData=function(){return this.typedArray[m]},t.getSubData=function(e){var t,n;if(void 0===e)t=this.data,n=0;else{var r=this.offsets[e],i=r+this.sizes[e];t=this.data.subarray(r,i),n=4*r}return{data:t,offset:n}},t.setUniforms=function(e){for(var t in e)this._setValue(t,e[t]);return this},t._setValue=function(e,t){var n=this.layout[e];Object(h.a)(n,"UniformLayoutStd140 illegal argument");var r=this.typedArray[n.type];1===n.size?r[n.offset]=t:r.set(t,n.offset)},t._addUniform=function(e,t){var n=Object(p.a)(t);Object(h.a)(n,"UniformBufferLayout illegal argument");var r=n.type,i=n.components;this.size=this._alignTo(this.size,i);var o=this.size;this.size+=i,this.layout[e]={type:r,size:i,offset:o}},t._alignTo=function(e,t){switch(t){case 1:return e;case 2:return e+e%2;default:return e+(4-e%4)%4}},e}(),y=n(447),_=n(342),w=n(368),T=n(451),b=n(394),A=n(446),R=n(457),M=n(366);function D(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e.__proto__=t}var I=[1,1,0,-1,1,0,1,-1,0,-1,-1,0],O=2,C=3,L=2.8,x=new Float32Array(2),S=function(e){function t(t,n){var r,i=n.count,o=new Array(i),a=new Float32Array(16*i),s=new u.a(t,a.byteLength);return(r=e.call(this,t,Object.assign({geometry:new f.a},n,{vs:"#version 300 es\n#define SHADER_NAME scene.vs\n\nin vec3 positions;\nin vec3 normals;\nin vec2 texCoords;\nin vec4 modelMatCol1;\nin vec4 modelMatCol2;\nin vec4 modelMatCol3;\nin vec4 modelMatCol4;\n\nuniform mat4 uView;\nuniform mat4 uProjection;\nout vec3 vNormal;\nout vec2 vUV;\n\nvoid main(void) {\n  mat4 modelMat = mat4(\n    modelMatCol1,\n    modelMatCol2,\n    modelMatCol3,\n    modelMatCol4\n  );\n  gl_Position = uProjection * uView * modelMat * vec4(positions, 1.0);\n  vNormal = vec3(modelMat * vec4(normals, 0.0));\n  vUV = texCoords;\n}\n",fs:"#version 300 es\nprecision highp float;\n#define SHADER_NAME scene.fs\n\nin vec3 vNormal;\nin vec2 vUV;\nuniform sampler2D uTexture;\n\nout vec4 fragColor;\nvoid main(void) {\n  float d = clamp(dot(normalize(vNormal), normalize(vec3(1.0, 1.0, 0.2))), 0.0, 1.0);\n  fragColor.rgb = texture(uTexture, vUV).rgb * (d + 0.1);\n  fragColor.a = 1.0;\n}\n",isInstanced:1,instanceCount:i,uniforms:{uTexture:n.uniforms.uTexture},attributes:{modelMatCol1:{buffer:s,size:4,stride:64,offset:0,divisor:1},modelMatCol2:{buffer:s,size:4,stride:64,offset:16,divisor:1},modelMatCol3:{buffer:s,size:4,stride:64,offset:32,divisor:1},modelMatCol4:{buffer:s,size:4,stride:64,offset:48,divisor:1}}}))||this).count=i,r.xforms=o,r.matrices=a,r.matrixBuffer=s,r}return D(t,e),t.prototype.updateMatrixBuffer=function(){this.matrixBuffer.setData(this.matrices)},t}(d.a),F=function(e){function t(t){var n;return void 0===t&&(t={}),(n=e.call(this,t)||this).isDemoSupported=!0,n}D(t,e),t.getInfo=function(){return'\n<p>\n  <b>Depth of Field</b>.\n<p>\nSeveral instanced luma.gl <code>Cubes</code> rendered with a Depth of Field\npost-processing effect.\n\n<div>\n  Focal Length: <input type="range" id="focal-length" min="0.1" max="10.0" step="0.1">\n</div>\n<div>\n  Focus Distance: <input type="range" id="focus-distance" min="0.1" max="10.0" step="0.1">\n</div>\n<div>\n  F-Stop: <input type="range" id="f-stop" min="0.1" max="10.0" step="0.1">\n</div>\n\n'};var n=t.prototype;return n.onInitialize=function(e){var t,n,r,i,o=e.gl;e._animationLoop;if(this.isDemoSupported=Object(c.d)(o),!this.isDemoSupported)return{};Object(l.a)(o,{depthTest:!0,depthFunc:s.a.LEQUAL});var a=new R.a,f=(new R.a).lookAt({eye:[0,0,8]}),d=new g({uDepthRange:o.FLOAT_VEC2,uFocusDistance:o.FLOAT,uBlurCoefficient:o.FLOAT,uPPM:o.FLOAT}).setUniforms({uDepthRange:[.1,30]}),p=new u.a(o,{target:s.a.UNIFORM_BUFFER,data:d.getData(),accessor:{index:0}}),h=new y.a(o,{id:"DOF_PROGRAM",vs:"#version 300 es\n#define SHADER_NAME quad.vs\n\nlayout(location=0) in vec3 aPosition;\n\nvoid main() {\n    gl_Position = vec4(aPosition, 1.0);\n}\n",fs:"#version 300 es\nprecision highp float;\n#define SHADER_NAME dof.fs\n\n#define MAX_BLUR 20.0\n\nuniform DOFUniforms {\n  vec2  uDepthRange;\n  float uFocusDistance;\n  float uBlurCoefficient;\n  float uPPM;\n};\n\nuniform vec2 uTexelOffset;\n\nuniform sampler2D uColor;\nuniform sampler2D uDepth;\n\nout vec4 fragColor;\n\nvoid main() {\n    ivec2 fragCoord = ivec2(gl_FragCoord.xy);\n    ivec2 resolution = textureSize(uColor, 0) - 1;\n\n    // Convert to linear depth\n    float ndc = 2.0 * texelFetch(uDepth, fragCoord, 0).r - 1.0;\n    float depth = -(2.0 * uDepthRange.y * uDepthRange.x) / (ndc * (uDepthRange.y - uDepthRange.x) - uDepthRange.y - uDepthRange.x);\n    float deltaDepth = abs(uFocusDistance - depth);\n\n    // Blur more quickly in the foreground.\n    float xdd = depth < uFocusDistance ? abs(uFocusDistance - deltaDepth) : abs(uFocusDistance + deltaDepth);\n    float blurRadius = min(floor(uBlurCoefficient * (deltaDepth / xdd) * uPPM), MAX_BLUR);\n\n    vec4 color = vec4(0.0);\n    if (blurRadius > 1.0) {\n        float halfBlur = blurRadius * 0.5;\n\n        float count = 0.0;\n\n        for (float i = 0.0; i <= MAX_BLUR; ++i) {\n            if (i > blurRadius) {\n                break;\n            }\n\n            // texelFetch outside texture gives vec4(0.0) (undefined in ES 3)\n            ivec2 sampleCoord = clamp(fragCoord + ivec2(((i - halfBlur) * uTexelOffset)), ivec2(0), resolution);\n            color += texelFetch(uColor, sampleCoord, 0);\n\n            ++count;\n        }\n\n        color /= count;\n    } else {\n        color = texelFetch(uColor, fragCoord, 0);\n    }\n\n    fragColor = color;\n}\n"});h.uniformBlockBinding(h.getUniformBlockIndex("DOFUniforms"),0);var m=new _.a(o,{width:o.drawingBufferWidth,height:o.drawingBufferHeight,attachments:(r={},r[s.a.COLOR_ATTACHMENT0]=new w.a(o,{format:s.a.RGBA,type:s.a.UNSIGNED_BYTE,width:o.drawingBufferWidth,height:o.drawingBufferHeight,mipmaps:!1,parameters:(t={},t[s.a.TEXTURE_MIN_FILTER]=s.a.LINEAR,t[s.a.TEXTURE_MAG_FILTER]=s.a.LINEAR,t[s.a.TEXTURE_WRAP_S]=s.a.CLAMP_TO_EDGE,t[s.a.TEXTURE_WRAP_T]=s.a.CLAMP_TO_EDGE,t)}),r[s.a.DEPTH_ATTACHMENT]=new w.a(o,{format:s.a.DEPTH_COMPONENT16,type:s.a.UNSIGNED_SHORT,dataFormat:s.a.DEPTH_COMPONENT,width:o.drawingBufferWidth,height:o.drawingBufferHeight,mipmaps:!1,parameters:(n={},n[s.a.TEXTURE_MIN_FILTER]=s.a.NEAREST,n[s.a.TEXTURE_MAG_FILTER]=s.a.NEAREST,n[s.a.TEXTURE_WRAP_S]=s.a.CLAMP_TO_EDGE,n[s.a.TEXTURE_WRAP_T]=s.a.CLAMP_TO_EDGE,n)}),r)}),v=new _.a(o,{width:o.drawingBufferWidth,height:o.drawingBufferHeight,depth:!1}),E=document.getElementById("focal-length"),b=document.getElementById("focus-distance"),A=document.getElementById("f-stop");E&&(E.value=O,E.addEventListener("input",function(){O=parseFloat(E.value)}),b.value=C,b.addEventListener("input",function(){C=parseFloat(b.value)}),A.value=L,A.addEventListener("input",function(){L=parseFloat(A.value)}));for(var M=new w.a(o,{data:"webgl-logo.png",mipmaps:!0,parameters:(i={},i[o.TEXTURE_MAG_FILTER]=o.LINEAR,i[o.TEXTURE_MIN_FILTER]=o.LINEAR_MIPMAP_NEAREST,i)}),D=new S(o,{count:100,uniforms:{uTexture:M}}),x=0,F=0;F<5;++F)for(var N=F-Math.floor(2.5),P=0;P<20;++P){var U=[.4,.4,.4],B=[-Math.random()*Math.PI,0,Math.random()*Math.PI],j=[2-P-N,0,2-P+N];D.xforms[x]={scale:U,translate:j,rotate:B,matrix:(new R.a).translate(j).rotateXYZ(B).scale(U)},D.matrices.set(D.xforms[x].matrix,16*x),++x}return D.updateMatrixBuffer(),{projMat:a,viewMat:f,instancedCubes:D,sceneFramebuffer:m,dofFramebuffer:v,quadVertexArray:new T.a(o,{program:h,attributes:{aPosition:new u.a(o,new Float32Array(I))}}),dofProgram:h,dofUniforms:p,dofUniformsLayout:d}},n.onRender=function(e){var t=e.gl,n=(e.tick,e.width,e.height,e.aspect),r=e.projMat,i=e.viewMat,o=e.instancedCubes,a=e.sceneFramebuffer,s=e.dofFramebuffer,u=e.quadVertexArray,f=e.dofProgram,d=e.dofUniforms,c=e.dofUniformsLayout;if(this.isDemoSupported){a.resize(t.drawingBufferWidth,t.drawingBufferHeight),s.resize(t.drawingBufferWidth,t.drawingBufferHeight);var l=O/Math.max(.1,Math.abs(C-O)),p=O*l/L,h=Math.sqrt(t.drawingBufferWidth*t.drawingBufferWidth+t.drawingBufferHeight*t.drawingBufferHeight)/35;Object(b.a)(t,{color:[0,0,0,1],depth:!0,framebuffer:a}),r.perspective({fov:Object(M.e)(75),aspect:n,near:.1,far:30}),i.lookAt({eye:[3,1.5,3],center:[0,0,0],up:[0,1,0]});for(var m=0;m<100;++m){var v=o.xforms[m];v.rotate[0]+=.01,v.rotate[1]+=.02,v.matrix.identity().translate(v.translate).rotateXYZ(v.rotate).scale(v.scale),o.matrices.set(v.matrix,16*m)}o.updateMatrixBuffer(),o.draw({uniforms:{uProjection:r,uView:i},framebuffer:a}),Object(b.a)(t,{color:[0,0,0,1],framebuffer:s}),x[0]=1,x[1]=0,c.setUniforms({uFocusDistance:C,uBlurCoefficient:p,uPPM:h}),d.setData(c.getData()),d.bind(),f.setUniforms({uTexelOffset:x,uColor:a.color,uDepth:a.depth}),f.draw({vertexArray:u,drawMode:t.TRIANGLE_STRIP,vertexCount:4,framebuffer:s}),Object(b.a)(t,{color:[0,0,0,1]}),x[0]=0,x[1]=1,f.setUniforms({uTexelOffset:x,uColor:a.color,uDepth:a.depth}),f.draw({vertexArray:u,drawMode:t.TRIANGLE_STRIP,vertexCount:4}),d.unbind()}},n.isSupported=function(){return this.isDemoSupported},n.getAltText=function(){return"THIS DEMO REQUIRES WEBLG2, BUT YOUR BROWSER DOESN'T SUPPORT IT"},t}(A.a);"undefined"==typeof window||window.website||(new F).start();n.d(t,"default",function(){return N});var N=function(e){var t,n;function r(){return e.apply(this,arguments)||this}return n=e,(t=r).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n,r.prototype.render=function(){return i.a.createElement(o.a,{AnimationLoop:F,exampleConfig:this.props.pageContext.exampleConfig})},r}(i.a.Component)},314:function(e,t,n){"use strict";n.d(t,"a",function(){return u});n(130),n(306),n(4);var r=n(434),i=n(386);function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function a(e,t,n){return t&&o(e.prototype,t),n&&o(e,n),e}var s={POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6},u=function(){function e(e){void 0===e&&(e={});var t=e,n=t.id,i=void 0===n?Object(r.c)("geometry"):n,o=t.drawMode,a=void 0===o?s.TRIANGLES:o,u=t.attributes,f=void 0===u?{}:u,d=t.indices,c=void 0===d?null:d,l=t.vertexCount,p=void 0===l?null:l;this.id=i,this.drawMode=0|a,this.attributes={},this.userData={},this._setAttributes(f,c),this.vertexCount=p||this._calculateVertexCount(this.attributes,this.indices)}a(e,null,[{key:"DRAW_MODE",get:function(){return s}}]);var t=e.prototype;return t.getVertexCount=function(){return this.vertexCount},t.getAttributes=function(){return this.indices?Object.assign({indices:this.indices},this.attributes):this.attributes},t._print=function(e){return"Geometry "+this.id+" attribute "+e},t._setAttributes=function(e,t){for(var n in t&&(this.indices=ArrayBuffer.isView(t)?{value:t,size:1}:t),e){var r=e[n];r=ArrayBuffer.isView(r)?{value:r}:r,Object(i.a)(ArrayBuffer.isView(r.value),this._print(n)+": must be typed array or object with value as typed array"),"POSITION"!==n&&"positions"!==n||r.size||(r.size=3),"indices"===n?(Object(i.a)(!this.indices),this.indices=r):this.attributes[n]=r}return this.indices&&void 0!==this.indices.isIndexed&&(this.indices=Object.assign({},this.indices),delete this.indices.isIndexed),this},t._calculateVertexCount=function(e,t){if(t)return t.value.length;var n=1/0;for(var r in e){var o=e[r],a=o.value,s=o.size;!o.constant&&a&&s>=1&&(n=Math.min(n,a.length/s))}return Object(i.a)(Number.isFinite(n)),n},a(e,[{key:"mode",get:function(){return this.drawMode}}]),e}()},320:function(e,t,n){"use strict";n(27),n(17),n(98),n(39),n(55),n(131),n(132),n(74),n(3),n(5),n(2),n(73),n(96),n(10),n(7),n(1),Object.defineProperty(t,"__esModule",{value:!0});var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i="undefined"!=typeof window&&window.addEventListener,o=new Map,a=function(){return i&&window.__SEER_INITIALIZED__},s=function(e,t){var n=o.get(e),r=Date.now();return!!(n&&r-n<t)||(o.set(e,r),!1)},u=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(i&&a()){var n=new Set,o=JSON.stringify(t,function(e){return function(t,n){if(!n||"object"!==(void 0===n?"undefined":r(n))||!e.has(n))return e.add(n),Object.prototype.toString.call(n).slice(8,-1).includes("Array")?Array.prototype.slice.call(n,0,20):n}}(n));try{window.postMessage({type:e,payload:o,source:"seer-agent"},"*")}catch(u){if(s("seer-log",2e3))return;console.log(u)}}},f=new Map,d=function(e){if(e&&e.data&&"seer-core"===e.data.source){var t=e.data,n=t.type,r=t.payload,i=f.get(n);i&&i.forEach(function(e){return e(r)})}},c=function(){i&&!window.__SEER_LISTENER__&&(window.addEventListener("message",d),window.__SEER_LISTENER__=!0)};t.default={send:u,throttle:s,isReady:a,list:function(e,t){return u("LIST",{key:e,data:t})},listItem:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return u("LIST_ITEM",{key:e,itemKey:t,data:n})},updateItem:function(e,t,n,r){return u("UPDATE_ITEM",{key:e,itemKey:t,path:n,data:r})},multiUpdate:function(e,t,n){return u("MULTI_UPDATE_ITEM",{key:e,itemKey:t,array:n})},deleteItem:function(e,t){return u("DELETE_ITEM",{key:e,itemKey:t})},addLog:function(e,t,n){return u("ADD_LOG",{key:e,itemKey:t,msg:n})},listeners:f,listenFor:function(e,t){if(i){if(!e||!t)throw new Error("Please provide a type and callback");f.has(e)||f.set(e,[]),window.__SEER_LISTENER__||c(),f.get(e).push(t)}},removeListener:function(e){f.forEach(function(t,n){f.set(n,t.filter(function(t){return t!==e}))})},init:c,clean:function(){i&&window.__SEER_LISTENER__&&(window.removeEventListener("message",d),delete window.__SEER_LISTENER__)}}},337:function(e,t,n){"use strict";n.d(t,"a",function(){return d});n(4),n(307),n(312);var r=n(314),i=n(434);var o=new Uint16Array([0,1,2,0,2,3,4,5,6,4,6,7,8,9,10,8,10,11,12,13,14,12,14,15,16,17,18,16,18,19,20,21,22,20,22,23]),a=new Float32Array([-1,-1,1,1,-1,1,1,1,1,-1,1,1,-1,-1,-1,-1,1,-1,1,1,-1,1,-1,-1,-1,1,-1,-1,1,1,1,1,1,1,1,-1,-1,-1,-1,1,-1,-1,1,-1,1,-1,-1,1,1,-1,-1,1,1,-1,1,1,1,1,-1,1,-1,-1,-1,-1,-1,1,-1,1,1,-1,1,-1]),s=new Float32Array([0,0,1,0,0,1,0,0,1,0,0,1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,1,0,0,1,0,0,1,0,0,1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,1,0,0,1,0,0,1,0,0,1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0]),u=new Float32Array([0,0,1,0,1,1,0,1,1,0,1,1,0,1,0,0,0,1,0,0,1,0,1,1,1,1,0,1,0,0,1,0,1,0,1,1,0,1,0,0,0,0,1,0,1,1,0,1]),f={POSITION:{size:3,value:new Float32Array(a)},NORMAL:{size:3,value:new Float32Array(s)},TEXCOORD_0:{size:2,value:new Float32Array(u)}},d=function(e){var t,n;function r(t){void 0===t&&(t={});var n=t.id,r=void 0===n?Object(i.c)("cube-geometry"):n;return e.call(this,Object.assign({},t,{id:r,indices:{size:1,value:new Uint16Array(o)},attributes:Object.assign({},f,t.attributes)}))||this}return n=e,(t=r).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n,r}(r.a)}}]);
//# sourceMappingURL=component---templates-core-example-dof-jsx-053464b0d8b55bbcf768.js.map