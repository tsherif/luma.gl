(window.webpackJsonp=window.webpackJsonp||[]).push([[16],{291:function(e,t,n){"use strict";n.r(t);var o=n(0),r=n.n(o),i=n(318),a=n(308),u=n.n(a),s=n(398),c=n(342),d=n(330),f=n(337),l=n(394),p=n(446),w=n(457),v=n(366);var h=function(e){var t,n;function o(){return e.apply(this,arguments)||this}n=e,(t=o).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n,o.getInfo=function(){return"\n<p>\n  Simple <b>shadow mapping</b>.\n<p>\nA luma.gl <code>Cube</code>, rendering into a shadowmap framebuffer\nand then rendering onto the screen.\n"};var r=o.prototype;return r.onInitialize=function(e){var t=e.gl;return Object(s.a)(t,{depthTest:!0,depthFunc:u.a.LEQUAL}),{fbShadow:new c.a(t,{id:"shadowmap",width:1024,height:1024}),cube:new d.a(t,{geometry:new f.a,vs:"#define SHADER_NAME scene.vs\n\nattribute vec3 positions;\nattribute vec3 normals;\n\nuniform mat4 uModel;\nuniform mat4 uView;\nuniform mat4 uProjection;\nuniform mat4 uShadowView;\nuniform mat4 uShadowProj;\n\nvarying vec4 shadowCoord;\nvarying vec3 normal;\n\nvoid main(void) {\n  gl_Position = uProjection * uView * uModel * vec4(positions, 1.0);\n  normal = vec3(uModel * vec4(normals, 0.0));\n  mat4 bias = mat4(\n    0.5, 0.0, 0.0, 0.0,\n    0.0, 0.5, 0.0, 0.0,\n    0.0, 0.0, 0.5, 0.0,\n    0.5, 0.5, 0.5, 1.0\n  );\n  shadowCoord = bias * uShadowProj * uShadowView * uModel * vec4(positions, 1.0);\n}\n",fs:"precision highp float;\n\nuniform sampler2D uShadowMap;\nuniform float uShadow;\n\nvarying vec4 shadowCoord;\nvarying vec3 normal;\n\nvoid main(void) {\n  float d = clamp(dot(normalize(normal), vec3(0,1,0)), 0.25, 1.0);\n  float s = 1.0;\n  if (texture2D(uShadowMap, shadowCoord.xy).z < shadowCoord.z - 0.005) {\n    s -= 0.5 * uShadow;\n  }\n  float c = d * s;\n  gl_FragColor = vec4(c,c,c,1);\n}\n"}),shadow:new d.a(t,{geometry:new f.a,vs:"#define SHADER_NAME shadowmap.vs\n\nattribute vec3 positions;\n\nuniform mat4 uModel;\nuniform mat4 uView;\nuniform mat4 uProjection;\n\nvoid main(void) {\n  gl_Position = uProjection * uView * uModel * vec4(positions, 1.0);\n}\n",fs:"precision highp float;\n\nvoid main(void) {\n  gl_FragColor = vec4(0,0,gl_FragCoord.z,1);\n}\n"})}},r.onRender=function(e){var t=e.gl,n=e.tick,o=e.width,r=e.height,i=e.aspect,a=e.cube,u=e.shadow,s=e.fbShadow,c=(new w.a).translate([0,6,0]).rotateXYZ([.01*n,0,0]).rotateXYZ([0,.013*n,0]),d=(new w.a).scale([2,-2,2]).translate([0,0,0]).rotateXYZ([0,0,.007*n]);t.viewport(0,0,1024,1024),Object(l.a)(t,{framebuffer:s,color:[1,1,1,1],depth:!0});var f=[0,8,0],p=(new w.a).lookAt({eye:f,center:[0,0,0],up:[0,0,-1]}),h=(new w.a).ortho({left:-4,right:4,bottom:-4,top:4,near:0,far:64});u.draw({framebuffer:s,uniforms:{uModel:c,uView:p,uProjection:h,uLightPosition:f}}),t.viewport(0,0,o,r),Object(l.a)(t,{color:[0,.2,0,1],depth:!0});var m=(new w.a).lookAt({eye:[0,8,8],center:[0,3,0],up:[0,1,0]}),y=(new w.a).perspective({fov:Object(v.e)(75),aspect:i,near:.1,far:100});a.setUniforms({uView:m,uProjection:y,uShadowView:p,uShadowProj:h,uShadowMap:s}),a.draw({framebuffer:null,uniforms:{uModel:c,uShadow:0}}),a.draw({framebuffer:null,uniforms:{uModel:d,uShadow:1}})},o}(p.a);"undefined"==typeof window||window.website||(new h).start();n.d(t,"default",function(){return m});var m=function(e){var t,n;function o(){return e.apply(this,arguments)||this}return n=e,(t=o).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n,o.prototype.render=function(){return r.a.createElement(i.a,{AnimationLoop:h,exampleConfig:this.props.pageContext.exampleConfig})},o}(r.a.Component)},314:function(e,t,n){"use strict";n.d(t,"a",function(){return s});n(130),n(306),n(4);var o=n(434),r=n(386);function i(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function a(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e}var u={POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6},s=function(){function e(e){void 0===e&&(e={});var t=e,n=t.id,r=void 0===n?Object(o.c)("geometry"):n,i=t.drawMode,a=void 0===i?u.TRIANGLES:i,s=t.attributes,c=void 0===s?{}:s,d=t.indices,f=void 0===d?null:d,l=t.vertexCount,p=void 0===l?null:l;this.id=r,this.drawMode=0|a,this.attributes={},this.userData={},this._setAttributes(c,f),this.vertexCount=p||this._calculateVertexCount(this.attributes,this.indices)}a(e,null,[{key:"DRAW_MODE",get:function(){return u}}]);var t=e.prototype;return t.getVertexCount=function(){return this.vertexCount},t.getAttributes=function(){return this.indices?Object.assign({indices:this.indices},this.attributes):this.attributes},t._print=function(e){return"Geometry "+this.id+" attribute "+e},t._setAttributes=function(e,t){for(var n in t&&(this.indices=ArrayBuffer.isView(t)?{value:t,size:1}:t),e){var o=e[n];o=ArrayBuffer.isView(o)?{value:o}:o,Object(r.a)(ArrayBuffer.isView(o.value),this._print(n)+": must be typed array or object with value as typed array"),"POSITION"!==n&&"positions"!==n||o.size||(o.size=3),"indices"===n?(Object(r.a)(!this.indices),this.indices=o):this.attributes[n]=o}return this.indices&&void 0!==this.indices.isIndexed&&(this.indices=Object.assign({},this.indices),delete this.indices.isIndexed),this},t._calculateVertexCount=function(e,t){if(t)return t.value.length;var n=1/0;for(var o in e){var i=e[o],a=i.value,u=i.size;!i.constant&&a&&u>=1&&(n=Math.min(n,a.length/u))}return Object(r.a)(Number.isFinite(n)),n},a(e,[{key:"mode",get:function(){return this.drawMode}}]),e}()},320:function(e,t,n){"use strict";n(27),n(17),n(98),n(39),n(55),n(131),n(132),n(74),n(3),n(5),n(2),n(73),n(96),n(10),n(7),n(1),Object.defineProperty(t,"__esModule",{value:!0});var o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r="undefined"!=typeof window&&window.addEventListener,i=new Map,a=function(){return r&&window.__SEER_INITIALIZED__},u=function(e,t){var n=i.get(e),o=Date.now();return!!(n&&o-n<t)||(i.set(e,o),!1)},s=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(r&&a()){var n=new Set,i=JSON.stringify(t,function(e){return function(t,n){if(!n||"object"!==(void 0===n?"undefined":o(n))||!e.has(n))return e.add(n),Object.prototype.toString.call(n).slice(8,-1).includes("Array")?Array.prototype.slice.call(n,0,20):n}}(n));try{window.postMessage({type:e,payload:i,source:"seer-agent"},"*")}catch(s){if(u("seer-log",2e3))return;console.log(s)}}},c=new Map,d=function(e){if(e&&e.data&&"seer-core"===e.data.source){var t=e.data,n=t.type,o=t.payload,r=c.get(n);r&&r.forEach(function(e){return e(o)})}},f=function(){r&&!window.__SEER_LISTENER__&&(window.addEventListener("message",d),window.__SEER_LISTENER__=!0)};t.default={send:s,throttle:u,isReady:a,list:function(e,t){return s("LIST",{key:e,data:t})},listItem:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return s("LIST_ITEM",{key:e,itemKey:t,data:n})},updateItem:function(e,t,n,o){return s("UPDATE_ITEM",{key:e,itemKey:t,path:n,data:o})},multiUpdate:function(e,t,n){return s("MULTI_UPDATE_ITEM",{key:e,itemKey:t,array:n})},deleteItem:function(e,t){return s("DELETE_ITEM",{key:e,itemKey:t})},addLog:function(e,t,n){return s("ADD_LOG",{key:e,itemKey:t,msg:n})},listeners:c,listenFor:function(e,t){if(r){if(!e||!t)throw new Error("Please provide a type and callback");c.has(e)||c.set(e,[]),window.__SEER_LISTENER__||f(),c.get(e).push(t)}},removeListener:function(e){c.forEach(function(t,n){c.set(n,t.filter(function(t){return t!==e}))})},init:f,clean:function(){r&&window.__SEER_LISTENER__&&(window.removeEventListener("message",d),delete window.__SEER_LISTENER__)}}},337:function(e,t,n){"use strict";n.d(t,"a",function(){return d});n(4),n(307),n(312);var o=n(314),r=n(434);var i=new Uint16Array([0,1,2,0,2,3,4,5,6,4,6,7,8,9,10,8,10,11,12,13,14,12,14,15,16,17,18,16,18,19,20,21,22,20,22,23]),a=new Float32Array([-1,-1,1,1,-1,1,1,1,1,-1,1,1,-1,-1,-1,-1,1,-1,1,1,-1,1,-1,-1,-1,1,-1,-1,1,1,1,1,1,1,1,-1,-1,-1,-1,1,-1,-1,1,-1,1,-1,-1,1,1,-1,-1,1,1,-1,1,1,1,1,-1,1,-1,-1,-1,-1,-1,1,-1,1,1,-1,1,-1]),u=new Float32Array([0,0,1,0,0,1,0,0,1,0,0,1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,1,0,0,1,0,0,1,0,0,1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,1,0,0,1,0,0,1,0,0,1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0]),s=new Float32Array([0,0,1,0,1,1,0,1,1,0,1,1,0,1,0,0,0,1,0,0,1,0,1,1,1,1,0,1,0,0,1,0,1,0,1,1,0,1,0,0,0,0,1,0,1,1,0,1]),c={POSITION:{size:3,value:new Float32Array(a)},NORMAL:{size:3,value:new Float32Array(u)},TEXCOORD_0:{size:2,value:new Float32Array(s)}},d=function(e){var t,n;function o(t){void 0===t&&(t={});var n=t.id,o=void 0===n?Object(r.c)("cube-geometry"):n;return e.call(this,Object.assign({},t,{id:o,indices:{size:1,value:new Uint16Array(i)},attributes:Object.assign({},c,t.attributes)}))||this}return n=e,(t=o).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n,o}(o.a)}}]);
//# sourceMappingURL=component---templates-core-example-shadowmap-jsx-1ecd4ad53483790eccac.js.map