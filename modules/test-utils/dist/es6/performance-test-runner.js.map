{"version":3,"sources":["../../src/performance-test-runner.js"],"names":["Stats","TestRunner","PerformanceTestRunner","constructor","props","Object","assign","testOptions","maxFramesToRender","targetFPS","initTestCase","testCase","_stats","id","name","_fps","get","shouldRender","animationProps","timeEnd","timeStart","count","done","assert","fps","getHz","_pass","framesRendered","_fail","_next"],"mappings":"AAAA,SAAQA,KAAR,QAAoB,UAApB;AACA,OAAOC,UAAP,MAAuB,eAAvB;AAEA,eAAe,MAAMC,qBAAN,SAAoCD,UAApC,CAA+C;AAC5DE,EAAAA,WAAW,CAACC,KAAD,EAAQ;AACjB,UAAMA,KAAN;AAEAC,IAAAA,MAAM,CAACC,MAAP,CAAc,KAAKC,WAAnB,EAAgC;AAC9BC,MAAAA,iBAAiB,EAAE,EADW;AAE9BC,MAAAA,SAAS,EAAE;AAFmB,KAAhC;AAID;;AAEDC,EAAAA,YAAY,CAACC,QAAD,EAAW;AACrB,UAAMD,YAAN,CAAmBC,QAAnB;AACA,SAAKC,MAAL,GAAc,IAAIZ,KAAJ,CAAU;AAACa,MAAAA,EAAE,EAAEF,QAAQ,CAACG;AAAd,KAAV,CAAd;AACA,SAAKC,IAAL,GAAY,KAAKH,MAAL,CAAYI,GAAZ,CAAgB,KAAhB,CAAZ;AACD;;AAEDC,EAAAA,YAAY,CAACC,cAAD,EAAiB;AAC3B,SAAKH,IAAL,CAAUI,OAAV;;AACA,SAAKJ,IAAL,CAAUK,SAAV;;AAEA,QAAI,KAAKL,IAAL,CAAUM,KAAV,GAAkB,KAAKd,WAAL,CAAiBC,iBAAvC,EAA0D;AACxDU,MAAAA,cAAc,CAACI,IAAf;AACD;;AAED,WAAO,IAAP;AACD;;AAEDC,EAAAA,MAAM,CAACZ,QAAD,EAAW;AACf,UAAMF,SAAS,GAAGE,QAAQ,CAACF,SAAT,IAAsB,KAAKF,WAAL,CAAiBE,SAAzD;AACA,UAAMY,KAAK,GAAG,KAAKN,IAAL,CAAUM,KAAxB;;AACA,UAAMG,GAAG,GAAG,KAAKT,IAAL,CAAUU,KAAV,EAAZ;;AAEA,QAAID,GAAG,IAAIf,SAAX,EAAsB;AACpB,WAAKiB,KAAL,CAAW;AAACF,QAAAA,GAAD;AAAMG,QAAAA,cAAc,EAAEN;AAAtB,OAAX;AACD,KAFD,MAEO;AACL,WAAKO,KAAL,CAAW;AAACJ,QAAAA,GAAD;AAAMG,QAAAA,cAAc,EAAEN;AAAtB,OAAX;AACD;;AACD,SAAKQ,KAAL;AACD;;AAtC2D","sourcesContent":["import {Stats} from 'probe.gl';\nimport TestRunner from './test-runner';\n\nexport default class PerformanceTestRunner extends TestRunner {\n  constructor(props) {\n    super(props);\n\n    Object.assign(this.testOptions, {\n      maxFramesToRender: 60,\n      targetFPS: 50\n    });\n  }\n\n  initTestCase(testCase) {\n    super.initTestCase(testCase);\n    this._stats = new Stats({id: testCase.name});\n    this._fps = this._stats.get('fps');\n  }\n\n  shouldRender(animationProps) {\n    this._fps.timeEnd();\n    this._fps.timeStart();\n\n    if (this._fps.count > this.testOptions.maxFramesToRender) {\n      animationProps.done();\n    }\n\n    return true;\n  }\n\n  assert(testCase) {\n    const targetFPS = testCase.targetFPS || this.testOptions.targetFPS;\n    const count = this._fps.count;\n    const fps = this._fps.getHz();\n\n    if (fps >= targetFPS) {\n      this._pass({fps, framesRendered: count});\n    } else {\n      this._fail({fps, framesRendered: count});\n    }\n    this._next();\n  }\n}\n"],"file":"performance-test-runner.js"}