{"version":3,"sources":["../../src/performance-test-runner.js"],"names":["Stats","TestRunner","PerformanceTestRunner","props","Object","assign","testOptions","maxFramesToRender","targetFPS","testCase","_stats","id","name","_fps","get","animationProps","timeEnd","timeStart","count","done","fps","getHz","_pass","framesRendered","_fail","_next"],"mappings":";;;;;;AAAA,SAAQA,KAAR,QAAoB,UAApB;AACA,OAAOC,UAAP,MAAuB,eAAvB;;IAEqBC,qB;;;AACnB,iCAAYC,KAAZ,EAAmB;AAAA;;AAAA;;AACjB,+FAAMA,KAAN;AAEAC,IAAAA,MAAM,CAACC,MAAP,CAAc,MAAKC,WAAnB,EAAgC;AAC9BC,MAAAA,iBAAiB,EAAE,EADW;AAE9BC,MAAAA,SAAS,EAAE;AAFmB,KAAhC;AAHiB;AAOlB;;;;iCAEYC,Q,EAAU;AACrB,8FAAmBA,QAAnB;;AACA,WAAKC,MAAL,GAAc,IAAIV,KAAJ,CAAU;AAACW,QAAAA,EAAE,EAAEF,QAAQ,CAACG;AAAd,OAAV,CAAd;AACA,WAAKC,IAAL,GAAY,KAAKH,MAAL,CAAYI,GAAZ,CAAgB,KAAhB,CAAZ;AACD;;;iCAEYC,c,EAAgB;AAC3B,WAAKF,IAAL,CAAUG,OAAV;;AACA,WAAKH,IAAL,CAAUI,SAAV;;AAEA,UAAI,KAAKJ,IAAL,CAAUK,KAAV,GAAkB,KAAKZ,WAAL,CAAiBC,iBAAvC,EAA0D;AACxDQ,QAAAA,cAAc,CAACI,IAAf;AACD;;AAED,aAAO,IAAP;AACD;;;2BAEMV,Q,EAAU;AACf,UAAMD,SAAS,GAAGC,QAAQ,CAACD,SAAT,IAAsB,KAAKF,WAAL,CAAiBE,SAAzD;AACA,UAAMU,KAAK,GAAG,KAAKL,IAAL,CAAUK,KAAxB;;AACA,UAAME,GAAG,GAAG,KAAKP,IAAL,CAAUQ,KAAV,EAAZ;;AAEA,UAAID,GAAG,IAAIZ,SAAX,EAAsB;AACpB,aAAKc,KAAL,CAAW;AAACF,UAAAA,GAAG,EAAHA,GAAD;AAAMG,UAAAA,cAAc,EAAEL;AAAtB,SAAX;AACD,OAFD,MAEO;AACL,aAAKM,KAAL,CAAW;AAACJ,UAAAA,GAAG,EAAHA,GAAD;AAAMG,UAAAA,cAAc,EAAEL;AAAtB,SAAX;AACD;;AACD,WAAKO,KAAL;AACD;;;;EAtCgDxB,U;;SAA9BC,qB","sourcesContent":["import {Stats} from 'probe.gl';\nimport TestRunner from './test-runner';\n\nexport default class PerformanceTestRunner extends TestRunner {\n  constructor(props) {\n    super(props);\n\n    Object.assign(this.testOptions, {\n      maxFramesToRender: 60,\n      targetFPS: 50\n    });\n  }\n\n  initTestCase(testCase) {\n    super.initTestCase(testCase);\n    this._stats = new Stats({id: testCase.name});\n    this._fps = this._stats.get('fps');\n  }\n\n  shouldRender(animationProps) {\n    this._fps.timeEnd();\n    this._fps.timeStart();\n\n    if (this._fps.count > this.testOptions.maxFramesToRender) {\n      animationProps.done();\n    }\n\n    return true;\n  }\n\n  assert(testCase) {\n    const targetFPS = testCase.targetFPS || this.testOptions.targetFPS;\n    const count = this._fps.count;\n    const fps = this._fps.getHz();\n\n    if (fps >= targetFPS) {\n      this._pass({fps, framesRendered: count});\n    } else {\n      this._fail({fps, framesRendered: count});\n    }\n    this._next();\n  }\n}\n"],"file":"performance-test-runner.js"}