{"expireTime":9007200809748944000,"key":"transformer-remark-markdown-html-ast-ed8fc7a1b6d2261bc0f44eaa2a099ed7-gatsby-remark-imagesgatsby-remark-responsive-iframegatsby-remark-prismjsgatsby-remark-copy-linked-filesgatsby-remark-autolink-headers-","val":{"type":"root","children":[{"type":"element","tagName":"h1","properties":{"id":"snapshottestrunner"},"children":[{"type":"element","tagName":"a","properties":{"href":"#snapshottestrunner","aria-hidden":true,"class":"anchor"},"children":[{"type":"raw","value":"<svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg>"}]},{"type":"text","value":"SnapshotTestRunner","position":{"start":{"line":1,"column":3,"offset":2},"end":{"line":1,"column":21,"offset":20}}}],"position":{"start":{"line":1,"column":1,"offset":0},"end":{"line":1,"column":21,"offset":20}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Client-side utility for browser-based WebGL render tests.","position":{"start":{"line":3,"column":1,"offset":22},"end":{"line":3,"column":58,"offset":79}}}],"position":{"start":{"line":3,"column":1,"offset":22},"end":{"line":3,"column":58,"offset":79}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"This class is intended to be used with ","position":{"start":{"line":5,"column":1,"offset":81},"end":{"line":5,"column":40,"offset":120}}},{"type":"raw","value":"<code class=\"language-text\">BrowserTestDriver</code>","position":{"start":{"line":5,"column":40,"offset":120},"end":{"line":5,"column":59,"offset":139}}},{"type":"text","value":" from ","position":{"start":{"line":5,"column":59,"offset":139},"end":{"line":5,"column":65,"offset":145}}},{"type":"raw","value":"<code class=\"language-text\">@probe.gl/test-utils</code>","position":{"start":{"line":5,"column":65,"offset":145},"end":{"line":5,"column":87,"offset":167}}},{"type":"text","value":". Together they support the following workflow:","position":{"start":{"line":5,"column":87,"offset":167},"end":{"line":5,"column":134,"offset":214}}}],"position":{"start":{"line":5,"column":1,"offset":81},"end":{"line":5,"column":134,"offset":214}}},{"type":"text","value":"\n"},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"Launch a Puppeteer instance (headless or non-headless) to run a test application","position":{"start":{"line":7,"column":3,"offset":218},"end":{"line":7,"column":83,"offset":298}}}],"position":{"start":{"line":7,"column":1,"offset":216},"end":{"line":7,"column":83,"offset":298}}},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"In the test application, create a canvas and ","position":{"start":{"line":8,"column":3,"offset":301},"end":{"line":8,"column":48,"offset":346}}},{"type":"raw","value":"<code class=\"language-text\">WebGLContext</code>","position":{"start":{"line":8,"column":48,"offset":346},"end":{"line":8,"column":62,"offset":360}}},{"type":"text","value":".","position":{"start":{"line":8,"column":62,"offset":360},"end":{"line":8,"column":63,"offset":361}}}],"position":{"start":{"line":8,"column":1,"offset":299},"end":{"line":8,"column":63,"offset":361}}},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"For each test case, render something to the ","position":{"start":{"line":9,"column":3,"offset":364},"end":{"line":9,"column":47,"offset":408}}},{"type":"raw","value":"<code class=\"language-text\">WebGLContext</code>","position":{"start":{"line":9,"column":47,"offset":408},"end":{"line":9,"column":61,"offset":422}}},{"type":"text","value":", take a screenshot, and perform pixel-diffing with a pre-defined \"golden image\". Report the matching result.","position":{"start":{"line":9,"column":61,"offset":422},"end":{"line":9,"column":170,"offset":531}}}],"position":{"start":{"line":9,"column":1,"offset":362},"end":{"line":9,"column":170,"offset":531}}},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"Proceed to the next test case until done.","position":{"start":{"line":10,"column":3,"offset":534},"end":{"line":10,"column":44,"offset":575}}}],"position":{"start":{"line":10,"column":1,"offset":532},"end":{"line":10,"column":44,"offset":575}}},{"type":"text","value":"\n"}],"position":{"start":{"line":7,"column":1,"offset":216},"end":{"line":10,"column":44,"offset":575}}},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{"id":"example"},"children":[{"type":"element","tagName":"a","properties":{"href":"#example","aria-hidden":true,"class":"anchor"},"children":[{"type":"raw","value":"<svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg>"}]},{"type":"text","value":"Example","position":{"start":{"line":12,"column":4,"offset":580},"end":{"line":12,"column":11,"offset":587}}}],"position":{"start":{"line":12,"column":1,"offset":577},"end":{"line":12,"column":11,"offset":587}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"In your node.js start script:","position":{"start":{"line":14,"column":1,"offset":589},"end":{"line":14,"column":30,"offset":618}}}],"position":{"start":{"line":14,"column":1,"offset":589},"end":{"line":14,"column":30,"offset":618}}},{"type":"text","value":"\n"},{"type":"raw","value":"<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token comment\">// This is the script that runs in Node.js and starts the browser</span>\n<span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span>BrowserTestDriver<span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'@probe.gl/test-utils'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">new</span> <span class=\"token class-name\">BrowserTestDriver</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">run</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n  server<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// Bundles and serves the browser script</span>\n    command<span class=\"token punctuation\">:</span> <span class=\"token string\">'webpack-dev-server'</span><span class=\"token punctuation\">,</span>\n    arguments<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'--env.render-test'</span><span class=\"token punctuation\">]</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  headless<span class=\"token punctuation\">:</span> <span class=\"token boolean\">true</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>","position":{"start":{"line":16,"column":1,"offset":620},"end":{"line":27,"column":4,"offset":941}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"In your script that is run on the browser:","position":{"start":{"line":29,"column":1,"offset":943},"end":{"line":29,"column":43,"offset":985}}}],"position":{"start":{"line":29,"column":1,"offset":943},"end":{"line":29,"column":43,"offset":985}}},{"type":"text","value":"\n"},{"type":"raw","value":"<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span>SnapshotTestRunner<span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'@luma.gl/test-utils'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span>Cube<span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'@luma.gl/core'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> <span class=\"token constant\">TEST_CASES</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span>\n  <span class=\"token punctuation\">{</span>\n    name<span class=\"token punctuation\">:</span> <span class=\"token string\">'Render A Cube'</span><span class=\"token punctuation\">,</span>\n    <span class=\"token comment\">// `onRender` receives animation props from the AnimationLoop</span>\n    <span class=\"token function-variable function\">onRender</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token punctuation\">{</span>gl<span class=\"token punctuation\">,</span> done<span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">const</span> model <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Cube</span><span class=\"token punctuation\">(</span>gl<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      model<span class=\"token punctuation\">.</span><span class=\"token function\">draw</span><span class=\"token punctuation\">(</span><span class=\"token operator\">...</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token comment\">// ready for capture and diffing</span>\n      <span class=\"token function\">done</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    goldenImage<span class=\"token punctuation\">:</span> <span class=\"token string\">'./test/render/golden-images/cube.png'</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">new</span> <span class=\"token class-name\">TestRender</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>width<span class=\"token punctuation\">:</span> <span class=\"token number\">800</span><span class=\"token punctuation\">,</span> height<span class=\"token punctuation\">:</span> <span class=\"token number\">600</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">.</span><span class=\"token function\">add</span><span class=\"token punctuation\">(</span><span class=\"token constant\">TEST_CASES</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">.</span><span class=\"token function\">run</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n    onTestFail<span class=\"token punctuation\">:</span> window<span class=\"token punctuation\">.</span>browserTestDriver_fail\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">.</span><span class=\"token function\">then</span><span class=\"token punctuation\">(</span>window<span class=\"token punctuation\">.</span>browserTestDriver_finish<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>","position":{"start":{"line":31,"column":1,"offset":987},"end":{"line":55,"column":4,"offset":1593}}},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{"id":"methods"},"children":[{"type":"element","tagName":"a","properties":{"href":"#methods","aria-hidden":true,"class":"anchor"},"children":[{"type":"raw","value":"<svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg>"}]},{"type":"text","value":"Methods","position":{"start":{"line":57,"column":4,"offset":1598},"end":{"line":57,"column":11,"offset":1605}}}],"position":{"start":{"line":57,"column":1,"offset":1595},"end":{"line":57,"column":11,"offset":1605}}},{"type":"text","value":"\n"},{"type":"element","tagName":"h3","properties":{"id":"constructorprops-object"},"children":[{"type":"element","tagName":"a","properties":{"href":"#constructorprops-object","aria-hidden":true,"class":"anchor"},"children":[{"type":"raw","value":"<svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg>"}]},{"type":"text","value":"constructor(props: Object)","position":{"start":{"line":59,"column":5,"offset":1611},"end":{"line":59,"column":31,"offset":1637}}}],"position":{"start":{"line":59,"column":1,"offset":1607},"end":{"line":59,"column":31,"offset":1637}}},{"type":"text","value":"\n"},{"type":"raw","value":"<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">new SnapshotTestRunner(props)</code></pre></div>","position":{"start":{"line":61,"column":1,"offset":1639},"end":{"line":63,"column":4,"offset":1676}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Create a SnapshotTestRunner instance. The ","position":{"start":{"line":65,"column":1,"offset":1678},"end":{"line":65,"column":43,"offset":1720}}},{"type":"raw","value":"<code class=\"language-text\">props</code>","position":{"start":{"line":65,"column":43,"offset":1720},"end":{"line":65,"column":50,"offset":1727}}},{"type":"text","value":" argument is forwarded to the ","position":{"start":{"line":65,"column":50,"offset":1727},"end":{"line":65,"column":80,"offset":1757}}},{"type":"element","tagName":"a","properties":{"href":"/docs/api-reference/core/animation-loop.md"},"children":[{"type":"text","value":"AnimationLoop","position":{"start":{"line":65,"column":81,"offset":1758},"end":{"line":65,"column":94,"offset":1771}}}],"position":{"start":{"line":65,"column":80,"offset":1757},"end":{"line":65,"column":139,"offset":1816}}},{"type":"text","value":" constructor.","position":{"start":{"line":65,"column":139,"offset":1816},"end":{"line":65,"column":152,"offset":1829}}}],"position":{"start":{"line":65,"column":1,"offset":1678},"end":{"line":65,"column":152,"offset":1829}}},{"type":"text","value":"\n"},{"type":"element","tagName":"h3","properties":{"id":"addtestcase-arrayobject"},"children":[{"type":"element","tagName":"a","properties":{"href":"#addtestcase-arrayobject","aria-hidden":true,"class":"anchor"},"children":[{"type":"raw","value":"<svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg>"}]},{"type":"text","value":"add(testCase: Array|Object)","position":{"start":{"line":67,"column":5,"offset":1835},"end":{"line":67,"column":32,"offset":1862}}}],"position":{"start":{"line":67,"column":1,"offset":1831},"end":{"line":67,"column":32,"offset":1862}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Add one or a list of test cases. Each test case may contain the following fields:","position":{"start":{"line":69,"column":1,"offset":1864},"end":{"line":69,"column":82,"offset":1945}}}],"position":{"start":{"line":69,"column":1,"offset":1864},"end":{"line":69,"column":82,"offset":1945}}},{"type":"text","value":"\n"},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"raw","value":"<code class=\"language-text\">name</code>","position":{"start":{"line":71,"column":3,"offset":1950},"end":{"line":71,"column":9,"offset":1956}}},{"type":"text","value":" (String) - name of the test case.","position":{"start":{"line":71,"column":9,"offset":1956},"end":{"line":71,"column":43,"offset":1990}}}],"position":{"start":{"line":71,"column":1,"offset":1948},"end":{"line":71,"column":43,"offset":1990}}},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"raw","value":"<code class=\"language-text\">goldenImage</code>","position":{"start":{"line":72,"column":3,"offset":1993},"end":{"line":72,"column":16,"offset":2006}}},{"type":"text","value":" (String) - path to the golden image, relative to the root where the node script is executed.","position":{"start":{"line":72,"column":16,"offset":2006},"end":{"line":72,"column":109,"offset":2099}}}],"position":{"start":{"line":72,"column":1,"offset":1991},"end":{"line":72,"column":109,"offset":2099}}},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"raw","value":"<code class=\"language-text\">timeout</code>","position":{"start":{"line":73,"column":3,"offset":2102},"end":{"line":73,"column":12,"offset":2111}}},{"type":"text","value":" (Number) - time to wait for this test case to resolve (by calling the ","position":{"start":{"line":73,"column":12,"offset":2111},"end":{"line":73,"column":83,"offset":2182}}},{"type":"raw","value":"<code class=\"language-text\">done</code>","position":{"start":{"line":73,"column":83,"offset":2182},"end":{"line":73,"column":89,"offset":2188}}},{"type":"text","value":" callback) before aborting, in milliseconds. If not provided, fallback to the shared option that is passed to ","position":{"start":{"line":73,"column":89,"offset":2188},"end":{"line":73,"column":199,"offset":2298}}},{"type":"raw","value":"<code class=\"language-text\">SnapshotTestRunner.run</code>","position":{"start":{"line":73,"column":199,"offset":2298},"end":{"line":73,"column":223,"offset":2322}}},{"type":"text","value":".","position":{"start":{"line":73,"column":223,"offset":2322},"end":{"line":73,"column":224,"offset":2323}}}],"position":{"start":{"line":73,"column":1,"offset":2100},"end":{"line":73,"column":224,"offset":2323}}},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"raw","value":"<code class=\"language-text\">imageDiffOptions</code>","position":{"start":{"line":74,"column":3,"offset":2326},"end":{"line":74,"column":21,"offset":2344}}},{"type":"text","value":" (Object) - image diffing options for this test case. See \"Image Diff Options\" section below.","position":{"start":{"line":74,"column":21,"offset":2344},"end":{"line":74,"column":114,"offset":2437}}}],"position":{"start":{"line":74,"column":1,"offset":2324},"end":{"line":74,"column":114,"offset":2437}}},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"raw","value":"<code class=\"language-text\">onInitialize</code>","position":{"start":{"line":75,"column":3,"offset":2440},"end":{"line":75,"column":17,"offset":2454}}},{"type":"text","value":" (Function) - called once when the test case starts. Receives a single object that is the ","position":{"start":{"line":75,"column":17,"offset":2454},"end":{"line":75,"column":107,"offset":2544}}},{"type":"element","tagName":"a","properties":{"href":"/docs/api-reference/core/animation-loop.md#callback-parameters"},"children":[{"type":"text","value":"AnimationLoop callback parameters","position":{"start":{"line":75,"column":108,"offset":2545},"end":{"line":75,"column":141,"offset":2578}}}],"position":{"start":{"line":75,"column":107,"offset":2544},"end":{"line":75,"column":206,"offset":2643}}},{"type":"text","value":". If this callback returns an object or a promise, the content that it resolves to will be passed to ","position":{"start":{"line":75,"column":206,"offset":2643},"end":{"line":75,"column":307,"offset":2744}}},{"type":"raw","value":"<code class=\"language-text\">onRender</code>","position":{"start":{"line":75,"column":307,"offset":2744},"end":{"line":75,"column":317,"offset":2754}}},{"type":"text","value":" and ","position":{"start":{"line":75,"column":317,"offset":2754},"end":{"line":75,"column":322,"offset":2759}}},{"type":"raw","value":"<code class=\"language-text\">onFinalize</code>","position":{"start":{"line":75,"column":322,"offset":2759},"end":{"line":75,"column":334,"offset":2771}}},{"type":"text","value":" later.","position":{"start":{"line":75,"column":334,"offset":2771},"end":{"line":75,"column":341,"offset":2778}}}],"position":{"start":{"line":75,"column":1,"offset":2438},"end":{"line":75,"column":341,"offset":2778}}},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"raw","value":"<code class=\"language-text\">onRender</code>","position":{"start":{"line":76,"column":3,"offset":2781},"end":{"line":76,"column":13,"offset":2791}}},{"type":"text","value":" (Function) - called every animation frame when the test case is running. Receives a single object that is the ","position":{"start":{"line":76,"column":13,"offset":2791},"end":{"line":76,"column":124,"offset":2902}}},{"type":"element","tagName":"a","properties":{"href":"/docs/api-reference/core/animation-loop.md#callback-parameters"},"children":[{"type":"text","value":"AnimationLoop callback parameters","position":{"start":{"line":76,"column":125,"offset":2903},"end":{"line":76,"column":158,"offset":2936}}}],"position":{"start":{"line":76,"column":124,"offset":2902},"end":{"line":76,"column":223,"offset":3001}}},{"type":"text","value":", plus the following:","position":{"start":{"line":76,"column":223,"offset":3001},"end":{"line":76,"column":244,"offset":3022}}}],"position":{"start":{"line":76,"column":3,"offset":2781},"end":{"line":76,"column":244,"offset":3022}}},{"type":"text","value":"\n"},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"raw","value":"<code class=\"language-text\">done</code>","position":{"start":{"line":77,"column":5,"offset":3027},"end":{"line":77,"column":11,"offset":3033}}},{"type":"text","value":" (Function) - must be called when the test case is done rendering and ready for screen capture and comparison.","position":{"start":{"line":77,"column":11,"offset":3033},"end":{"line":77,"column":121,"offset":3143}}}],"position":{"start":{"line":77,"column":3,"offset":3025},"end":{"line":77,"column":121,"offset":3143}}},{"type":"text","value":"\n"}],"position":{"start":{"line":77,"column":3,"offset":3025},"end":{"line":77,"column":121,"offset":3143}}},{"type":"text","value":"\n"}],"position":{"start":{"line":76,"column":1,"offset":2779},"end":{"line":77,"column":121,"offset":3143}}},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"raw","value":"<code class=\"language-text\">onFinalize</code>","position":{"start":{"line":78,"column":3,"offset":3146},"end":{"line":78,"column":15,"offset":3158}}},{"type":"text","value":" (Function) - called once when the test case is done to finalize all resources. Receives a single object that is the ","position":{"start":{"line":78,"column":15,"offset":3158},"end":{"line":78,"column":132,"offset":3275}}},{"type":"element","tagName":"a","properties":{"href":"/docs/api-reference/core/animation-loop.md#callback-parameters"},"children":[{"type":"text","value":"AnimationLoop callback parameters","position":{"start":{"line":78,"column":133,"offset":3276},"end":{"line":78,"column":166,"offset":3309}}}],"position":{"start":{"line":78,"column":132,"offset":3275},"end":{"line":78,"column":231,"offset":3374}}},{"type":"text","value":".","position":{"start":{"line":78,"column":231,"offset":3374},"end":{"line":78,"column":232,"offset":3375}}}],"position":{"start":{"line":78,"column":1,"offset":3144},"end":{"line":78,"column":232,"offset":3375}}},{"type":"text","value":"\n"}],"position":{"start":{"line":71,"column":1,"offset":1948},"end":{"line":78,"column":232,"offset":3375}}},{"type":"text","value":"\n"},{"type":"element","tagName":"h3","properties":{"id":"runoptions-object"},"children":[{"type":"element","tagName":"a","properties":{"href":"#runoptions-object","aria-hidden":true,"class":"anchor"},"children":[{"type":"raw","value":"<svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg>"}]},{"type":"text","value":"run(options: Object)","position":{"start":{"line":80,"column":5,"offset":3381},"end":{"line":80,"column":25,"offset":3401}}}],"position":{"start":{"line":80,"column":1,"offset":3377},"end":{"line":80,"column":25,"offset":3401}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Run all test cases.","position":{"start":{"line":82,"column":1,"offset":3403},"end":{"line":82,"column":20,"offset":3422}}}],"position":{"start":{"line":82,"column":1,"offset":3403},"end":{"line":82,"column":20,"offset":3422}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Options:","position":{"start":{"line":84,"column":1,"offset":3424},"end":{"line":84,"column":9,"offset":3432}}}],"position":{"start":{"line":84,"column":1,"offset":3424},"end":{"line":84,"column":9,"offset":3432}}},{"type":"text","value":"\n"},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"raw","value":"<code class=\"language-text\">timeout</code>","position":{"start":{"line":86,"column":3,"offset":3436},"end":{"line":86,"column":12,"offset":3445}}},{"type":"text","value":" (Number) - time to wait for each test case to resolve (by calling the ","position":{"start":{"line":86,"column":12,"offset":3445},"end":{"line":86,"column":83,"offset":3516}}},{"type":"raw","value":"<code class=\"language-text\">done</code>","position":{"start":{"line":86,"column":83,"offset":3516},"end":{"line":86,"column":89,"offset":3522}}},{"type":"text","value":" callback) before aborting, in milliseconds. Default ","position":{"start":{"line":86,"column":89,"offset":3522},"end":{"line":86,"column":142,"offset":3575}}},{"type":"raw","value":"<code class=\"language-text\">2000</code>","position":{"start":{"line":86,"column":142,"offset":3575},"end":{"line":86,"column":148,"offset":3581}}},{"type":"text","value":".","position":{"start":{"line":86,"column":148,"offset":3581},"end":{"line":86,"column":149,"offset":3582}}}],"position":{"start":{"line":86,"column":1,"offset":3434},"end":{"line":86,"column":149,"offset":3582}}},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"raw","value":"<code class=\"language-text\">imageDiffOptions</code>","position":{"start":{"line":87,"column":3,"offset":3585},"end":{"line":87,"column":21,"offset":3603}}},{"type":"text","value":" (Object) - image diffing options for all test cases. This will be overridden if a test case defines its own ","position":{"start":{"line":87,"column":21,"offset":3603},"end":{"line":87,"column":130,"offset":3712}}},{"type":"raw","value":"<code class=\"language-text\">imageDiffOptions</code>","position":{"start":{"line":87,"column":130,"offset":3712},"end":{"line":87,"column":148,"offset":3730}}},{"type":"text","value":". See \"Image Diff Options\" section below.","position":{"start":{"line":87,"column":148,"offset":3730},"end":{"line":87,"column":189,"offset":3771}}}],"position":{"start":{"line":87,"column":1,"offset":3583},"end":{"line":87,"column":189,"offset":3771}}},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"raw","value":"<code class=\"language-text\">onTestStart</code>","position":{"start":{"line":88,"column":3,"offset":3774},"end":{"line":88,"column":16,"offset":3787}}},{"type":"text","value":" (Function) - callback when a test starts. Receives the current test case. Default logs the test name to console.","position":{"start":{"line":88,"column":16,"offset":3787},"end":{"line":88,"column":129,"offset":3900}}}],"position":{"start":{"line":88,"column":1,"offset":3772},"end":{"line":88,"column":129,"offset":3900}}},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"raw","value":"<code class=\"language-text\">onTestPass</code>","position":{"start":{"line":89,"column":3,"offset":3903},"end":{"line":89,"column":15,"offset":3915}}},{"type":"text","value":" (Function) - callback when a test passes. Receives the current test case and the diffing result. Default logs the pixel matching percentage to console.","position":{"start":{"line":89,"column":15,"offset":3915},"end":{"line":89,"column":167,"offset":4067}}}],"position":{"start":{"line":89,"column":1,"offset":3901},"end":{"line":89,"column":167,"offset":4067}}},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"raw","value":"<code class=\"language-text\">onTestFail</code>","position":{"start":{"line":90,"column":3,"offset":4070},"end":{"line":90,"column":15,"offset":4082}}},{"type":"text","value":" (Function) - callback when a test fails, either because the matching rate is below threshold or a critical error. Receives the current test case. Default logs the error message or the pixel matching percentage to console.","position":{"start":{"line":90,"column":15,"offset":4082},"end":{"line":90,"column":237,"offset":4304}}}],"position":{"start":{"line":90,"column":1,"offset":4068},"end":{"line":90,"column":237,"offset":4304}}},{"type":"text","value":"\n"}],"position":{"start":{"line":86,"column":1,"offset":3434},"end":{"line":90,"column":237,"offset":4304}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Returns: a ","position":{"start":{"line":92,"column":1,"offset":4306},"end":{"line":92,"column":12,"offset":4317}}},{"type":"raw","value":"<code class=\"language-text\">Promise</code>","position":{"start":{"line":92,"column":12,"offset":4317},"end":{"line":92,"column":21,"offset":4326}}},{"type":"text","value":" that resolves when all test cases are done.","position":{"start":{"line":92,"column":21,"offset":4326},"end":{"line":92,"column":65,"offset":4370}}}],"position":{"start":{"line":92,"column":1,"offset":4306},"end":{"line":92,"column":65,"offset":4370}}},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{"id":"members"},"children":[{"type":"element","tagName":"a","properties":{"href":"#members","aria-hidden":true,"class":"anchor"},"children":[{"type":"raw","value":"<svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg>"}]},{"type":"text","value":"Members","position":{"start":{"line":95,"column":4,"offset":4376},"end":{"line":95,"column":11,"offset":4383}}}],"position":{"start":{"line":95,"column":1,"offset":4373},"end":{"line":95,"column":11,"offset":4383}}},{"type":"text","value":"\n"},{"type":"element","tagName":"h3","properties":{"id":"isheadless"},"children":[{"type":"element","tagName":"a","properties":{"href":"#isheadless","aria-hidden":true,"class":"anchor"},"children":[{"type":"raw","value":"<svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg>"}]},{"type":"text","value":"isHeadless","position":{"start":{"line":97,"column":5,"offset":4389},"end":{"line":97,"column":15,"offset":4399}}}],"position":{"start":{"line":97,"column":1,"offset":4385},"end":{"line":97,"column":15,"offset":4399}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Whether the test is being run in headless mode. In headless mode, Chromium uses software render which behaves slightly differently from non-headless. Image diffing tolerance may need to be adjusted accordingly.","position":{"start":{"line":99,"column":1,"offset":4401},"end":{"line":99,"column":211,"offset":4611}}}],"position":{"start":{"line":99,"column":1,"offset":4401},"end":{"line":99,"column":211,"offset":4611}}},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{"id":"image-diff-options"},"children":[{"type":"element","tagName":"a","properties":{"href":"#image-diff-options","aria-hidden":true,"class":"anchor"},"children":[{"type":"raw","value":"<svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg>"}]},{"type":"text","value":"Image Diff Options","position":{"start":{"line":102,"column":4,"offset":4617},"end":{"line":102,"column":22,"offset":4635}}}],"position":{"start":{"line":102,"column":1,"offset":4614},"end":{"line":102,"column":22,"offset":4635}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"The test renderer and each test case may choose to override the default image diffing options. The following options from ","position":{"start":{"line":104,"column":1,"offset":4637},"end":{"line":104,"column":123,"offset":4759}}},{"type":"element","tagName":"a","properties":{"href":"https://github.com/uber-web/probe.gl/blob/master/docs/api-reference/test-utils/browser-test-driver.md#browsertestdriver_captureanddiffscreenoptions--object"},"children":[{"type":"text","value":"captureAndDiffScreen","position":{"start":{"line":104,"column":124,"offset":4760},"end":{"line":104,"column":144,"offset":4780}}}],"position":{"start":{"line":104,"column":123,"offset":4759},"end":{"line":104,"column":302,"offset":4938}}},{"type":"text","value":" are supported:","position":{"start":{"line":104,"column":302,"offset":4938},"end":{"line":104,"column":317,"offset":4953}}}],"position":{"start":{"line":104,"column":1,"offset":4637},"end":{"line":104,"column":317,"offset":4953}}},{"type":"text","value":"\n"},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"raw","value":"<code class=\"language-text\">tolerance</code>","position":{"start":{"line":106,"column":3,"offset":4957},"end":{"line":106,"column":14,"offset":4968}}}],"position":{"start":{"line":106,"column":1,"offset":4955},"end":{"line":106,"column":14,"offset":4968}}},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"raw","value":"<code class=\"language-text\">threshold</code>","position":{"start":{"line":107,"column":3,"offset":4971},"end":{"line":107,"column":14,"offset":4982}}}],"position":{"start":{"line":107,"column":1,"offset":4969},"end":{"line":107,"column":14,"offset":4982}}},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"raw","value":"<code class=\"language-text\">includeAA</code>","position":{"start":{"line":108,"column":3,"offset":4985},"end":{"line":108,"column":14,"offset":4996}}}],"position":{"start":{"line":108,"column":1,"offset":4983},"end":{"line":108,"column":14,"offset":4996}}},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"raw","value":"<code class=\"language-text\">createDiffImage</code>","position":{"start":{"line":109,"column":3,"offset":4999},"end":{"line":109,"column":20,"offset":5016}}}],"position":{"start":{"line":109,"column":1,"offset":4997},"end":{"line":109,"column":20,"offset":5016}}},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"raw","value":"<code class=\"language-text\">saveOnFail</code>","position":{"start":{"line":110,"column":3,"offset":5019},"end":{"line":110,"column":15,"offset":5031}}}],"position":{"start":{"line":110,"column":1,"offset":5017},"end":{"line":110,"column":15,"offset":5031}}},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"raw","value":"<code class=\"language-text\">saveAs</code>","position":{"start":{"line":111,"column":3,"offset":5034},"end":{"line":111,"column":11,"offset":5042}}}],"position":{"start":{"line":111,"column":1,"offset":5032},"end":{"line":111,"column":11,"offset":5042}}},{"type":"text","value":"\n"}],"position":{"start":{"line":106,"column":1,"offset":4955},"end":{"line":111,"column":11,"offset":5042}}}],"position":{"start":{"line":1,"column":1,"offset":0},"end":{"line":113,"column":1,"offset":5044}}}}