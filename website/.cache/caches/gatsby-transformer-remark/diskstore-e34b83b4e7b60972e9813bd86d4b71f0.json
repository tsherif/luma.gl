{"expireTime":9007200809748943000,"key":"transformer-remark-markdown-html-bf4a17b7d815bba6492a054cebcd8e70-gatsby-remark-imagesgatsby-remark-responsive-iframegatsby-remark-prismjsgatsby-remark-copy-linked-filesgatsby-remark-autolink-headers-","val":"<h1 id=\"stencil-buffer\"><a href=\"#stencil-buffer\" aria-hidden class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Stencil Buffer</h1>\n<h2 id=\"using-stencil-buffers\"><a href=\"#using-stencil-buffers\" aria-hidden class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Using Stencil Buffers</h2>\n<p>The stencil buffer API supports a number of features which makes it look somewhat complex at first glance, but the basic operations are turning on and off stencil testing.</p>\n<h3 id=\"typical-usage\"><a href=\"#typical-usage\" aria-hidden class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Typical usage</h3>\n<p>Enable stencil testing and set the actions to take whenever any of the tests succeed or fail:</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token function\">setParameters</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n  stencilTest<span class=\"token punctuation\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span> <span class=\"token comment\">// turn on stencil buffers</span>\n  stencilOp<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token constant\">GL</span><span class=\"token punctuation\">.</span><span class=\"token constant\">KEEP</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">GL</span><span class=\"token punctuation\">.</span><span class=\"token constant\">KEEP</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">GL</span><span class=\"token punctuation\">.</span><span class=\"token constant\">REPLACE</span><span class=\"token punctuation\">]</span> <span class=\"token comment\">// update the stencil buffer if both stencil and depth tests pass</span>\n  stencilFunc<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token constant\">GL</span><span class=\"token punctuation\">.</span><span class=\"token constant\">ALWAYS</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xFF</span><span class=\"token punctuation\">]</span> <span class=\"token comment\">// turn off stencil test: update the stencil buffer, regardless of current stencil value</span>\n  stencilMask<span class=\"token punctuation\">:</span> <span class=\"token number\">0xFF</span> <span class=\"token comment\">// mask that enables writing of all bits</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token function\">clear</span><span class=\"token punctuation\">(</span><span class=\"token constant\">GL_STENCIL_BUFFER_BIT</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\">// draw</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token function\">setParameters</span><span class=\"token punctuation\">(</span>gl<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">glStencilFunc</span><span class=\"token punctuation\">(</span><span class=\"token constant\">GL_NOTEQUAL</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xFF</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token function\">glStencilMask</span><span class=\"token punctuation\">(</span><span class=\"token number\">0x00</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// disable writing to the stencil buffer</span>\n  <span class=\"token function\">glDisable</span><span class=\"token punctuation\">(</span><span class=\"token constant\">GL_DEPTH_TEST</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span></code></pre></div>\n<h3 id=\"more-advanced-usage\"><a href=\"#more-advanced-usage\" aria-hidden class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>More advanced usage</h3>\n<ul>\n<li>Multiple Stencil Buffers: By using the bit-planes in the stencil buffer one can manage 8 different stencil buffers, and clip to any combination of these buffers.</li>\n<li>Counting occlusions per fragment</li>\n</ul>\n<h3 id=\"creating-stencil-buffers\"><a href=\"#creating-stencil-buffers\" aria-hidden class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Creating stencil buffers</h3>\n<p>Stencil buffers are not created by default.</p>\n<h3 id=\"stencil-testing\"><a href=\"#stencil-testing\" aria-hidden class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Stencil Testing</h3>\n<p>The stencil test flag turns on both reading and writing to buffers.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token function\">setParameters</span><span class=\"token punctuation\">(</span>gl<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span>stencilTest<span class=\"token punctuation\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>The stencil test by default is set to always pass. Typically an application wants the stencil buffer value to be compared against some other value.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token function\">setParameters</span><span class=\"token punctuation\">(</span>gl<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span>stencilFunc<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token constant\">GL</span><span class=\"token punctuation\">.</span><span class=\"token constant\">GEQUAL</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xFF</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xFF</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span></code></pre></div>\n<h3 id=\"stencil-writing\"><a href=\"#stencil-writing\" aria-hidden class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Stencil Writing</h3>\n<p>To write to the stencil buffer:</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token function\">setParameters</span><span class=\"token punctuation\">(</span>gl<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span>\n  stencilOp<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span>stencilTestFails<span class=\"token punctuation\">,</span> depthTestFails<span class=\"token punctuation\">,</span> stencilAndDepthTestPass<span class=\"token punctuation\">]</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>Initial values are <code class=\"language-text\">GL.KEEP</code> so nothing will be written to the stencil buffer unless the <code class=\"language-text\">stencilOp</code> is changed.</p>\n<table>\n<thead>\n<tr>\n<th>Enum</th>\n<th>Operation</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><code class=\"language-text\">GL.KEEP</code></td>\n<td>Don't modify the current value (default)</td>\n</tr>\n<tr>\n<td><code class=\"language-text\">GL.INVERT</code></td>\n<td>Invert the current value</td>\n</tr>\n<tr>\n<td><code class=\"language-text\">GL.ZERO</code></td>\n<td>Set it to zero</td>\n</tr>\n<tr>\n<td><code class=\"language-text\">GL.REPLACE</code></td>\n<td>Replace with the masked fragment value</td>\n</tr>\n<tr>\n<td><code class=\"language-text\">GL.INCR</code></td>\n<td>Increment the current value, saturating if it would overflow (max is typically 255)</td>\n</tr>\n<tr>\n<td><code class=\"language-text\">GL.INCR_WRAP</code></td>\n<td>Increment the current value, wrapping if it would overflow (256 => 0)</td>\n</tr>\n<tr>\n<td><code class=\"language-text\">GL.DECR</code></td>\n<td>Decrement the current value, setting to zero if it would underflow</td>\n</tr>\n<tr>\n<td><code class=\"language-text\">GL.DECR_WRAP</code></td>\n<td>Decrement the current value, wrapping if it would underflow (0 => 256)</td>\n</tr>\n</tbody>\n</table>\n<p>1: Meaning that it stops at the maximum representable integer at the stencil buffer's bitdepth. For an 8-bit stencil buffer, that would be 255.</p>\n<h2 id=\"stencil-mask\"><a href=\"#stencil-mask\" aria-hidden class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Stencil mask</h2>\n<p>Where a 0 appears, the corresponding bit is write-protected. Initially, all bits are enabled for writing.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token function\">setParameters</span><span class=\"token punctuation\">(</span>gl<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span>stencilMask<span class=\"token punctuation\">:</span> <span class=\"token number\">0xFF</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span></code></pre></div>"}